!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e){},function(t,e,n){},function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t))return t}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.r(e);var o=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"string"==typeof e?(this.el=document.createElement(e),this.el.className=n):this.el=e,this.data={}}var e,n,o;return e=t,(n=[{key:"data",value:function(t,e){return void 0!==e?(this.data[t]=e,this):this.data[t]}},{key:"on",value:function(t,e){var n=r(t.split(".")),i=n[0],o=n.slice(1),a=i;return"mousewheel"===a&&/Firefox/i.test(window.navigator.userAgent)&&(a="DOMMouseScroll"),this.el.addEventListener(a,function(t){e(t);for(var n=0;n<o.length;n+=1){var r=o[n];if("left"===r&&0!==t.button)return;if("right"===r&&2!==t.button)return;"stop"===r&&t.stopPropagation()}}),this}},{key:"offset",value:function(t){var e=this;if(void 0!==t)return Object.keys(t).forEach(function(n){e.css(n,"".concat(t[n],"px"))}),this;var n=this.el;return{top:n.offsetTop,left:n.offsetLeft,height:n.offsetHeight,width:n.offsetWidth}}},{key:"scroll",value:function(t){var e=this.el;return void 0!==t&&(void 0!==t.left&&(e.scrollLeft=t.left),void 0!==t.top&&(e.scrollTop=t.top)),{left:e.scrollLeft,top:e.scrollTop}}},{key:"box",value:function(){return this.el.getBoundingClientRect()}},{key:"parent",value:function(){return new t(this.el.parentNode)}},{key:"children",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return 0===arguments.length?this.el.childNodes:(n.forEach(function(e){return t.child(e)}),this)}},{key:"removeChild",value:function(t){this.el.removeChild(t)}},{key:"child",value:function(e){var n=e;return"string"==typeof e?n=document.createTextNode(e):e instanceof t&&(n=e.el),this.el.appendChild(n),this}},{key:"contains",value:function(t){return this.el.contains(t)}},{key:"className",value:function(t){return void 0!==t?(this.el.className=t,this):this.el.className}},{key:"addClass",value:function(t){return this.el.classList.add(t),this}},{key:"hasClass",value:function(t){return this.el.classList.contains(t)}},{key:"removeClass",value:function(t){return this.el&&this.el.classList.remove(t),this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"active";return this.toggleClass(t)}},{key:"toggleClass",value:function(t){return this.el.classList.toggle(t)}},{key:"active",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"active";return t?this.addClass(e):this.removeClass(e),this}},{key:"checked",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.active(t,"checked"),this}},{key:"disabled",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t?this.addClass("disabled"):this.removeClass("disabled"),this}},{key:"attr",value:function(t,e){var n=this;if(void 0!==e)this.el.setAttribute(t,e);else{if("string"==typeof t)return this.el.getAttribute(t);Object.keys(t).forEach(function(e){n.el.setAttribute(e,t[e])})}return this}},{key:"removeAttr",value:function(t){return this.el.removeAttribute(t),this}},{key:"html",value:function(t){return void 0!==t?(this.el.innerHTML=t,this):this.el.innerHTML}},{key:"val",value:function(t){return void 0!==t?(this.el.value=t,this):this.el.value}},{key:"focus",value:function(){this.el.focus()}},{key:"cssRemoveKeys",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return n.forEach(function(e){return t.el.style.removeProperty(e)}),this}},{key:"css",value:function(t,e){var n=this;return void 0===e&&"string"!=typeof t?(Object.keys(t).forEach(function(e){n.el.style[e]=t[e]}),this):void 0!==e?(this.el.style[t]=e,this):this.el.style[t]}},{key:"computedStyle",value:function(){return window.getComputedStyle(this.el,null)}},{key:"show",value:function(){return this.css("display","block"),this}},{key:"hide",value:function(){return this.css("display","none"),this}}])&&i(e.prototype,n),o&&i(e,o),t}(),a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new o(t,e)};n(0);function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function c(t){for(var e="",n=t;n>=s.length;)n/=s.length,n-=1,e+=s[parseInt(n,10)%s.length];var r=t%s.length;return e+=s[r]}function u(t){for(var e=0,n=0;n<t.length-1;n+=1){var r=t.charCodeAt(n)-65,i=t.length-1-n;e+=Math.pow(s.length,i)+s.length*r}return e+=t.charCodeAt(t.length-1)-65}function f(t){for(var e="",n="",r=0;r<t.length;r+=1)t.charAt(r)>="0"&&t.charAt(r)<="9"?n+=t.charAt(r):e+=t.charAt(r);return[u(e),parseInt(n,10)-1]}function h(t,e){return"".concat(c(t)).concat(e+1)}function d(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return!0};if(0===e&&0===n)return t;var i=l(f(t),2),o=i[0],a=i[1];return r(o,a)?h(o+e,a+n):t}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var y=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sri=e,this.sci=n,this.eri=r,this.eci=i,this.w=o,this.h=a}var e,n,r;return e=t,r=[{key:"valueOf",value:function(e){var n=e.split(":"),r=p(f(n[0]),2),i=r[0],o=r[1],a=o,l=i;if(n.length>1){var s=p(f(n[1]),2);l=s[0],a=s[1]}return new t(o,i,a,l)}}],(n=[{key:"set",value:function(t,e,n,r){this.sri=t,this.sci=e,this.eri=n,this.eci=r}},{key:"setToOther",value:function(t){this.sri=t.sri,this.sci=t.sci,this.eri=t.eri,this.eci=t.eci}},{key:"multiple",value:function(){return this.eri-this.sri>0||this.eci-this.sci>0}},{key:"includes",value:function(){for(var t=0,e=0,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(1===r.length){var o=f(r[0]),a=p(o,2);e=a[0],t=a[1]}else 2===r.length&&(t=r[0],e=r[1]);var l=this.sri,s=this.sci,c=this.eri,u=this.eci;return l<=t&&t<=c&&s<=e&&e<=u}},{key:"each",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=this.sri,r=this.sci,i=this.eri,o=this.eci,a=n;a<=i;a+=1)if(e(a))for(var l=r;l<=o;l+=1)t(a,l)}},{key:"emptyFirst",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0},r=this.sri,i=this.sci,o=this.eri,a=this.eci,l=r;l<=o;l+=1)if(e(l)){for(var s=[],c=[],u=i;u<=a;u+=1)n(l,u)?s.push(u):c.push(u);for(var f=0;f<s.length;f++)t(l,s[f]);for(var h=0;h<c.length;h++)t(l,c[h])}}},{key:"contains",value:function(t){return this.sri<=t.sri&&this.sci<=t.sci&&this.eri>=t.eri&&this.eci>=t.eci}},{key:"within",value:function(t){return this.sri>=t.sri&&this.sci>=t.sci&&this.eri<=t.eri&&this.eci<=t.eci}},{key:"disjoint",value:function(t){return this.sri>t.eri||this.sci>t.eci||t.sri>this.eri||t.sci>this.eci}},{key:"intersects",value:function(t){return this.sri<=t.eri&&this.sci<=t.eci&&t.sri<=this.eri&&t.sci<=this.eci}},{key:"union",value:function(e){var n=this.sri,r=this.sci,i=this.eri,o=this.eci;return new t(e.sri<n?e.sri:n,e.sci<r?e.sci:r,e.eri>i?e.eri:i,e.eci>o?e.eci:o)}},{key:"extendRange",value:function(e){var n=this.sri,r=this.sci,i=this.eri,o=this.eci,a=e.eri-e.sri+1,l=e.eci-e.sci+1,s=i-n+1,c=o-r+1;return new t(n,r,n+(s<a?a:s-s%a)-1,r+(c<l?l:c-c%l)-1)}},{key:"difference",value:function(e){var n=[],r=function(e,r,i,o){n.push(new t(e,r,i,o))},i=this.sri,o=this.sci,a=this.eri,l=this.eci,s=e.sri-i,c=e.sci-o,u=a-e.eri,f=l-e.eci;return s>0?(r(i,o,e.sri-1,l),u>0?(r(e.eri+1,o,a,l),c>0&&r(e.sri,o,e.eri,e.sci-1),f>0&&r(e.sri,e.eci+1,e.eri,l)):(c>0&&r(e.sri,o,a,e.sci-1),f>0&&r(e.sri,e.eci+1,a,l))):u>0&&(r(e.eri+1,o,a,l),c>0&&r(i,o,e.eri,e.sci-1),f>0&&r(i,e.eci+1,e.eri,l)),c>0?(r(i,o,a,e.sci-1),f>0?(r(i,e.eri+1,a,l),s>0&&r(i,e.sci,e.sri-1,e.eci),u>0&&r(e.sri+1,e.sci,a,e.eci)):(s>0&&r(i,e.sci,e.sri-1,l),u>0&&r(e.sri+1,e.sci,a,l))):f>0&&(r(a,e.eci+1,a,l),s>0&&r(i,o,e.sri-1,e.eci),u>0&&r(e.eri+1,o,a,e.eci)),n}},{key:"size",value:function(){return[this.eri-this.sri+1,this.eci-this.sci+1]}},{key:"toString",value:function(){var t=this.sri,e=this.sci,n=this.eri,r=this.eci,i=h(e,t);return this.multiple()&&(i="".concat(i,":").concat(h(r,n))),i}},{key:"clone",value:function(){return new t(this.sri,this.sci,this.eri,this.eci,this.w,this.h)}},{key:"equals",value:function(t){return this.eri===t.eri&&this.eci===t.eci&&this.sri===t.sri&&this.sci===t.sci}}])&&v(e.prototype,n),r&&v(e,r),t}();function b(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var g=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=new y(0,0,0,0),this.ri=0,this.ci=0}var e,n,r;return e=t,(n=[{key:"multiple",value:function(){return this.range.multiple()}},{key:"setIndexes",value:function(t,e){this.ri=t,this.ci=e}},{key:"size",value:function(){return this.range.size()}}])&&b(e.prototype,n),r&&b(e,r),t}();var m=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=0,this.y=0,this.ri=0,this.ci=0,this.riact=0};function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var k=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.undoItems=[],this.redoItems=[]}var e,n,r;return e=t,(n=[{key:"add",value:function(t){this.undoItems.push(JSON.stringify(t)),this.redoItems=[]}},{key:"canUndo",value:function(){return this.undoItems.length>0}},{key:"canRedo",value:function(){return this.redoItems.length>0}},{key:"undo",value:function(t,e){var n=this.undoItems,r=this.redoItems;if(this.canUndo()){var i=JSON.parse(n.pop());r.push(JSON.stringify(t(i))),e(i)}}},{key:"redo",value:function(t,e){var n=this.undoItems,r=this.redoItems;if(this.canRedo()){var i=JSON.parse(r.pop());n.push(JSON.stringify(t(i))),e(i)}}}])&&w(e.prototype,n),r&&w(e,r),t}();function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var S=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.range=null,this.state="clear",this.textdata=null}var e,n,r;return e=t,(n=[{key:"copy",value:function(t,e){this.range=t,this.state="copy";for(var n=t.sri,r=t.sci,i=t.eri,o=t.eci,a="",l=n;l<=i;l+=1){if(e._[l])for(var s=r;s<=o;s+=1){if(e._[l].cells&&e._[l].cells[s]){var c=e._[l].cells[s].text;c&&(c.indexOf("\n")>=0&&(c='"'+c+'"'),a+=c)}a+="\t"}a+="\n"}return this.setData(a),this}},{key:"cut",value:function(t){return this.range=t,this.state="cut",this}},{key:"isCopy",value:function(){return"copy"===this.state}},{key:"isCut",value:function(){return"cut"===this.state}},{key:"isClear",value:function(){return"clear"===this.state}},{key:"clear",value:function(){this.range=null,this.state="clear"}},{key:"setData",value:function(t){this.textdata=t,this.copyTextToClipboard(t)}},{key:"fallbackCopyTextToClipboard",value:function(t){var e=document.createElement("textarea");e.value=t,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")}catch(t){}document.body.removeChild(e)}},{key:"copyTextToClipboard",value:function(t){navigator.clipboard?navigator.clipboard.writeText(t).then(function(){},function(t){}):this.fallbackCopyTextToClipboard(t)}}])&&O(e.prototype,n),r&&O(e,r),t}();function x(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function C(t,e,n){return e&&E(t.prototype,e),n&&E(t,n),t}var _=function(){function t(e,n,r){x(this,t),this.ci=e,this.operator=n,this.value=r}return C(t,[{key:"set",value:function(t,e){this.operator=t,this.value=e}},{key:"includes",value:function(t){var e=this.operator,n=this.value;return"all"===e||"in"===e&&n.includes(t)}},{key:"vlength",value:function(){var t=this.operator,e=this.value;return"in"===t?e.length:0}},{key:"getData",value:function(){return{ci:this.ci,operator:this.operator,value:this.value}}}]),t}(),j=function(){function t(e,n){x(this,t),this.ci=e,this.order=n}return C(t,[{key:"asc",value:function(){return"asc"===this.order}},{key:"desc",value:function(){return"desc"===this.order}}]),t}(),T=function(){function t(){x(this,t),this.ref=null,this.filters=[],this.sort=null}return C(t,[{key:"setData",value:function(t){var e=t.ref,n=t.filters,r=t.sort;null!=e&&(this.ref=e,this.filters=n.map(function(t){return new _(t.ci,t.operator,t.value)}),r&&(this.sort=new j(r.ci,r.order)))}},{key:"getData",value:function(){if(this.active()){var t=this.ref,e=this.filters,n=this.sort;return{ref:t,filters:e.map(function(t){return t.getData()}),sort:n}}return{}}},{key:"addFilter",value:function(t,e,n){var r=this.getFilter(t);null==r?this.filters.push(new _(t,e,n)):r.set(e,n)}},{key:"setSort",value:function(t,e){this.sort=e?new j(t,e):null}},{key:"includes",value:function(t,e){return!!this.active()&&this.hrange().includes(t,e)}},{key:"getSort",value:function(t){var e=this.sort;return e&&e.ci===t?e:null}},{key:"getFilter",value:function(t){for(var e=this.filters,n=0;n<e.length;n+=1)if(e[n].ci===t)return e[n];return null}},{key:"filteredRows",value:function(t){var e=new Set,n=new Set;if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=this.filters,l=i+1;l<=o;l+=1)for(var s=0;s<a.length;s+=1){var c=a[s],u=t(l,c.ci),f=u&&0!=u.text.trim().length?u.text:"";if(!c.includes(f)){e.add(l);break}n.add(l)}return{rset:e,fset:n}}},{key:"items",value:function(t,e){var n={};if(this.active())for(var r=this.range(),i=r.sri,o=r.eri,a=i+1;a<=o;a+=1){var l=e(a,t);if(null===l||/^\s*$/.test(l.text))n[""]=(n[""]||0)+1;else{var s=l.text,c=(n[s]||0)+1;n[s]=c}}return n}},{key:"range",value:function(){return y.valueOf(this.ref)}},{key:"hrange",value:function(){var t=this.range();return t.eri=t.sri,t}},{key:"clear",value:function(){this.ref=null,this.filters=[],this.sort=null}},{key:"active",value:function(){return null!==this.ref}}]),t}();function P(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var A=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._=e}var e,n,r;return e=t,(n=[{key:"forEach",value:function(t){this._.forEach(t)}},{key:"deleteWithin",value:function(t){this._=this._.filter(function(e){return!e.within(t)})}},{key:"getFirstIncludes",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"filterIntersects",value:function(e){return new t(this._.filter(function(t){return t.intersects(e)}))}},{key:"intersects",value:function(t){for(var e=0;e<this._.length;e+=1){if(this._[e].intersects(t))return!0}return!1}},{key:"union",value:function(t){var e=t;return this._.forEach(function(t){t.intersects(e)&&(e=t.union(e))}),e}},{key:"add",value:function(t){this.deleteWithin(t),this._.push(t)}},{key:"shift",value:function(t,e,n,r){this._.forEach(function(i){var o=i.sri,a=i.sci,l=i.eri,s=i.eci,c=i;"row"===t?o>=e?(c.sri+=n,c.eri+=n):o<e&&e<=l&&(c.eri+=n,r(o,a,n,0)):"column"===t&&(a>=e?(c.sci+=n,c.eci+=n):a<e&&e<=s&&(c.eci+=n,r(o,a,0,n)))})}},{key:"move",value:function(t,e,n){this._.forEach(function(r){var i=r;i.within(t)&&(i.eri+=e,i.sri+=e,i.sci+=n,i.eci+=n)})}},{key:"setData",value:function(t){return this._=t.map(function(t){return y.valueOf(t)}),this}},{key:"getData",value:function(){return this._.map(function(t){return t.toString()})}},{key:"getDataForSave",value:function(){return this._.filter(function(t){return t.multiple()})}}])&&P(e.prototype,n),r&&P(e,r),t}();var R=function t(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach(function(n){Object.keys(n).forEach(function(r){var i=n[r];"string"==typeof i||"number"==typeof i||"boolean"==typeof i?e[r]=i:"function"!=typeof i&&!Array.isArray(i)&&i instanceof Object?(e[r]=e[r]||{},t(e[r],i)):e[r]=i})}),e};function D(t){for(var e="".concat(t),n=0,r=!1,i=0;i<e.length;i+=1)!0===r&&(n+=1),"."===e.charAt(i)&&(r=!0);return n}function I(t,e,n){if(Number.isNaN(e)||Number.isNaN(n))return e+t+n;var r=D(e),i=D(n),o=Number(e),a=Number(n),l=0;return"-"===t?l=o-a:"+"===t?l=o+a:"*"===t?l=o*a:"/"===t&&(l=o/a),l.toFixed(Math.max(r,i))}var z={cloneDeep:function(t){return JSON.parse(JSON.stringify(t))},merge:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return R.apply(void 0,[{}].concat(e))},equals:function t(e,n){var r=Object.keys(e);if(r.length!==Object.keys(n).length)return!1;for(var i=0;i<r.length;i+=1){var o=r[i],a=e[o],l=n[o];if(void 0===l)return!1;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a){if(a!==l)return!1}else if(Array.isArray(a)){if(a.length!==l.length)return!1;for(var s=0;s<a.length;s+=1)if(!t(a[s],l[s]))return!1}else if("function"!=typeof a&&!Array.isArray(a)&&a instanceof Object&&!t(a,l))return!1}return!0},arrayEquals:function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(t[n]!==e[n])return!1;return!0},sum:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=0,r=0;return Object.keys(t).forEach(function(i){n+=e(t[i],i),r+=1}),[n,r]},rangeEach:function(t,e,n){for(var r=t;r<e;r+=1)n(r)},rangeSum:function(t,e,n){for(var r=0,i=t;i<e;i+=1)r+=n(i);return r},rangeReduceIf:function(t,e,n,r,i,o){for(var a=n,l=r,s=t;s<e&&!(a>i);s+=1)a+=l=o(s);return[s,a-l,l]},deleteProperty:function(t,e){var n=t["".concat(e)];return delete t["".concat(e)],n},numberCalc:I};function N(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var F=function(){function t(e){var n=e.len,r=e.height;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.height=r}var e,n,r;return e=t,(n=[{key:"getHeight",value:function(t,e){if(this.isHide(t))return 0;if(e&&e.has(t))return 0;var n=this.get(t);return n&&n.height?n.height:this.height}},{key:"setHeight",value:function(t,e){this.getOrNew(t).height=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this.get(t);return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumHeight",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set;return z.rangeSum(t,e,function(t){return r&&r.has(t)?0:n.getHeight(t)})}},{key:"totalHeight",value:function(){return this.sumHeight(0,this.len)}},{key:"get",value:function(t){return this._[t]}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{cells:{}},this._[t]}},{key:"getCell",value:function(t,e){var n=this.get(t);return void 0!==n&&void 0!==n.cells&&void 0!==n.cells[e]?n.cells[e]:null}},{key:"getCellMerge",value:function(t,e){var n=this.getCell(t,e);return n&&n.merge?n.merge:[0,0]}},{key:"getCellOrNew",value:function(t,e){var n=this.getOrNew(t);return n.cells[e]=n.cells[e]||{},n.cells[e]}},{key:"setCell",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"all",i=this.getOrNew(t);"all"===r?i.cells[e]=n:"text"===r?(i.cells[e]=i.cells[e]||{},i.cells[e].text=n.text):"format"===r&&(i.cells[e]=i.cells[e]||{},i.cells[e].style=n.style,n.merge&&(i.cells[e].merge=n.merge))}},{key:"setCellText",value:function(t,e,n,r,i){var o=this.getCellOrNew(t,e);o.text=n,i?o.f=i:delete o.f,r?o.ufv=r:delete o.ufv}},{key:"updateOneCell",value:function(t){this.setCellText(t.ri,t.ci,t.text,t.ufv,t.f)}},{key:"copyPaste",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},o=t.sri,a=t.sci,l=t.eri,s=t.eci,c=new Array,u=new Array,f=e.sri>=0?e.sri:0,h=e.sci>=0?e.sci:0,p=e.eri,v=e.eci,y=t.size(),b=N(y,2),g=b[0],m=b[1],w=e.size(),k=N(w,2),O=k[0],S=k[1],x=!0,E=0;(p<o||v<a)&&(x=!1,E=p<o?O:S);for(var C=o;C<=l;C+=1)for(var _=a;_<=s;_+=1)for(var j=f;j<=p;j+=g)for(var T=h;T<=v;T+=m){var P=j+(C-o),A=T+(_-a);if(P!==C||A!==_){var R=this._[C]&&this._[C].cells&&this._[C].cells[_],D=R?z.cloneDeep(this._[C].cells[_]):{};if(P!==C||A!==_){r&&D&&D.text&&D.text.length>0&&function(){var t=D.text,e=T-h+(j-f)+2;if(x||(e-=E+1),"="===t[0])D.text=t.replace(/\w{1,3}\d/g,function(t){var n=0,r=0;return o===f?n=e-1:r=e-1,/^\d+$/.test(t)?t:d(t,n,r)});else if(g<=1&&m>1&&(f>l||p<o)||m<=1&&g>1&&(h>s||v<a)||g<=1&&m<=1){var n=/[\\.\d]+$/.exec(t);if(null!==n){var r=Number(n[0])+e-1;D.text=t.substring(0,n.index)+r}}}();var I={ri:P,ci:A,text:D.f?D.f:D.text},W={ri:P,ci:A,ncell:D};c.push(I),u.push(W)}}}for(var F=0;F<u.length;F++)this.setCell(u[F].ri,u[F].ci,u[F].ncell,n),i(u[F].ri,u[F].ci,u[F].ncell);return c}},{key:"cutPaste",value:function(t,e){var n=this,r={};this.each(function(i){n.eachCells(i,function(o){var a=parseInt(i,10),l=parseInt(o,10);t.includes(i,o)&&(a=e.sri+(a-t.sri),l=e.sci+(l-t.sci)),r[a]=r[a]||{cells:{}},r[a].cells[l]=n._[i].cells[o],r[a].height=n._[i].height})}),this._=r}},{key:"paste",value:function(t,e){var n=this,r=new Array;if(!(t.length<=0)){var i=e.sri,o=e.sci;return t.forEach(function(t,e){var a=i+e;t.forEach(function(t,e){var i=o+e;if(i<=1e3){n.setCellText(a,i,t);var l={ri:a,ci:i,text:t};r.push(l)}})}),r}}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r={};this.each(function(i,o){var a=parseInt(i,10);a>=t&&(a+=n,e.eachCells(i,function(e,r){r.text&&"="===r.text[0]&&(r.text=r.text.replace(/\w{1,3}\d/g,function(e){return d(e,0,n,function(e,n){return n>=t})}))})),r[a]=o}),this._=r,this.len+=n}},{key:"delete",value:function(t,e){var n=this,r=e-t+1,i={};this.each(function(o,a){var l=parseInt(o,10);l<t?i[l]=a:o>e&&(i[l-r]=a,n.eachCells(o,function(t,n){n.text&&"="===n.text[0]&&(n.text=n.text.replace(/\w{1,3}\d/g,function(t){return d(t,0,-r,function(t,n){return n>e})}))}))}),this._=i,this.len-=r}},{key:"insertColumn",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.each(function(r,i){var o={};e.eachCells(r,function(e,r){var i=parseInt(e,10);i>=t&&(i+=n,r.text&&"="===r.text[0]&&(r.text=r.text.replace(/\w{1,3}\d/g,function(e){return d(e,n,0,function(e){return e>=t})}))),o[i]=r}),i.cells=o})}},{key:"deleteColumn",value:function(t,e){var n=this,r=e-t+1;this.each(function(i,o){var a={};n.eachCells(i,function(n,i){var o=parseInt(n,10);o<t?a[o]=i:o>e&&(a[o-r]=i,i.text&&"="===i.text[0]&&(i.text=i.text.replace(/\w{1,3}\d/g,function(t){return d(t,-r,0,function(t){return t>e})})))}),o.cells=a})}},{key:"deleteCells",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";t.each(function(t,r){e.deleteCell(t,r,n)})}},{key:"deleteCell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",r=this.get(t);if(null!==r){var i=this.getCell(t,e);null!==i&&("all"===n?delete r.cells[e]:"text"===n?(i.text&&delete i.text,i.value&&delete i.value):"format"===n?(void 0!==i.style&&delete i.style,i.merge&&delete i.merge):"merge"===n&&i.merge&&delete i.merge)}}},{key:"maxCell",value:function(){var t=Object.keys(this._),e=t[t.length-1],n=this._[e];if(n){var r=n.cells,i=Object.keys(r),o=i[i.length-1];return[parseInt(e,10),parseInt(o,10)]}return[0,0]}},{key:"each",value:function(t){Object.entries(this._).forEach(function(e){var n=N(e,2),r=n[0],i=n[1];t(r,i)})}},{key:"eachCells",value:function(t,e){this._[t]&&this._[t].cells&&Object.entries(this._[t].cells).forEach(function(t){var n=N(t,2),r=n[0],i=n[1];e(r,i)})}},{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),void 0!==t.height&&(this.height=t.height,delete t.height),this._=t}},{key:"setRangeData",value:function(t,e){for(var n=e.sri;n<=e.eri;n++)void 0!==t[n]&&(this._[n]=t[n]),null===t[n]&&delete this._[n]}},{key:"getData",value:function(){var t=this.len,e=this.height;return Object.assign({len:t,height:e},this._)}},{key:"getRangeData",value:function(t){for(var e={},n=t.sri;n<=t.eri;n++)void 0!==this._[n]?e[n]=this._[n]:e[n]=null;return e}},{key:"getDataForRowsSet",value:function(t){var e=this,n=this.len,r=this.height,i={};return i.height=r,i.len=n,t.forEach(function(t){void 0!==e._[t]&&(i[t]=e._[t])}),i}}])&&W(e.prototype,n),r&&W(e,r),t}();function M(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var H=function(){function t(e){var n=e.len,r=e.width,i=e.indexWidth,o=e.minWidth;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._={},this.len=n,this.width=r,this.indexWidth=i,this.minWidth=o}var e,n,r;return e=t,(n=[{key:"setData",value:function(t){t.len&&(this.len=t.len,delete t.len),this._=t}},{key:"getData",value:function(){var t=this.len;return Object.assign({len:t},this._)}},{key:"getDataForSave",value:function(){return Object.assign(this._)}},{key:"getWidth",value:function(t){if(this.isHide(t))return 0;var e=this._[t];return e&&e.width?e.width:this.width}},{key:"getOrNew",value:function(t){return this._[t]=this._[t]||{},this._[t]}},{key:"setWidth",value:function(t,e){this.getOrNew(t).width=e}},{key:"unhide",value:function(t){for(var e=t;e>0&&(e-=1,this.isHide(e));)this.setHide(e,!1)}},{key:"isHide",value:function(t){var e=this._[t];return e&&e.hide}},{key:"setHide",value:function(t,e){var n=this.getOrNew(t);!0===e?n.hide=!0:delete n.hide}},{key:"setStyle",value:function(t,e){this.getOrNew(t).style=e}},{key:"sumWidth",value:function(t,e){var n=this;return z.rangeSum(t,e,function(t){return n.getWidth(t)})}},{key:"totalWidth",value:function(){return this.sumWidth(0,this.len)}}])&&M(e.prototype,n),r&&M(e,r),t}(),L=["en"],V={en:{toolbar:{undo:"Undo",redo:"Redo",print:"Print",paintformat:"Paint format",clearformat:"Clear format",format:"Format",fontName:"Font",fontSize:"Font size",fontBold:"Font bold",fontItalic:"Font italic",underline:"Underline",strike:"Strike",color:"Text color",bgcolor:"Fill color",border:"Borders",merge:"Merge cells",unmerge:"Unmerge cells",align:"Horizontal align",valign:"Vertical align",textwrap:"Text wrapping",freeze:"Freeze cell",autofilter:"Filter",formula:"Functions",more:"More",sort:"Sort",pagination:"Pagination",search:"Search",commentDefault:"Please enter text",commentEdit:"Edit comment",commentRemove:"Remove comment",commentPrevious:"Previous comment",commentNext:"Next comment"},contextmenu:{copy:"Copy",cut:"Cut",paste:"Paste",pasteValue:"Paste values only",pasteFormat:"Paste format only",hide:"Hide",insertRow:"Insert row",insertColumn:"Insert column",deleteSheet:"Delete",deleteRow:"Delete row",deleteColumn:"Delete column",deleteCell:"Delete cell",deleteCellText:"Delete cell text",validation:"Data validations",sort:"Sort",cellprintable:"Enable export",cellnonprintable:"Disable export",celleditable:"Enable editing",cellnoneditable:"Disable editing"},print:{size:"Paper size",orientation:"Page orientation",orientations:["Landscape","Portrait"]},format:{normal:"Normal",text:"Plain Text",number:"Number",percent:"Percent",rmb:"RMB",usd:"USD",eur:"EUR",date:"Date",time:"Time",datetime:"Date time",duration:"Duration"},formula:{sum:"Sum",average:"Average",max:"Max",min:"Min",_if:"IF",and:"AND",or:"OR",concat:"Concat"},validation:{required:"it must be required",notMatch:"it not match its validation rule",between:"it is between {} and {}",notBetween:"it is not between {} and {}",notIn:"it is not in list",equal:"it equal to {}",notEqual:"it not equal to {}",lessThan:"it less than {}",lessThanEqual:"it less than or equal to {}",greaterThan:"it greater than {}",greaterThanEqual:"it greater than or equal to {}"},error:{pasteForMergedCell:"Unable to do this for merged cells"},calendar:{weeks:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"]},button:{next:"Next",cancel:"Cancel",remove:"Remove",save:"Save",ok:"OK",previous:"Previous",close:"Close"},sort:{desc:"Sort Z -> A",asc:"Sort A -> Z"},filter:{empty:"empty"},dataValidation:{mode:"Mode",range:"Cell Range",criteria:"Criteria",modeType:{cell:"Cell",column:"Column",row:"Row"},type:{list:"List",number:"Number",date:"Date",phone:"Phone",email:"Email"},operator:{be:"between",nbe:"not between",lt:"less than",lte:"less than or equal to",gt:"greater than",gte:"greater than or equal to",eq:"equal to",neq:"not equal to"}},dataSort:{ci:"Range",criteria:"Criteria",order:{asc:"ASC",desc:"DESC"}},dataSearch:{label:"Keywords"},dataComment:{label:"Comment"}}};function q(t,e){if(e)for(var n=0,r=L;n<r.length;n++){var i=r[n];if(!e[i])break;for(var o=e[i],a=t.match(/(?:\\.|[^.])+/g),l=0;l<a.length;l+=1){var s=o[a[l]];if(!s)break;if(l===a.length-1)return s;o=s}}}function B(t){var e=q(t,V);return!e&&window&&window.x_spreadsheet&&window.x_spreadsheet.$messages&&(e=q(t,window.x_spreadsheet.$messages)),e||""}function U(t){return function(){return B(t)}}function X(t,e){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?L=[t]:L.unshift(t),e&&(V[t]=e)}function Y(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var G={phone:/^[1-9]\d{10}$/,email:/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/};function J(t,e){var n="";if(!t){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];n=B.apply(void 0,["validation.".concat(e)].concat(i))}return[t,n]}var K=function(){function t(e,n,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.required=n,this.value=r,this.type=e,this.operator=i,this.message=""}var e,n,r;return e=t,(n=[{key:"parseValue",value:function(t){var e=this.type;return"date"===e?new Date(t):"number"===e?Number(t):t}},{key:"equals",value:function(t){var e=this.type===t.type&&this.required===t.required&&this.operator===t.operator;return e&&(e=Array.isArray(this.value)?z.arrayEquals(this.value,t.value):this.value===t.value),e}},{key:"values",value:function(){return this.value.split(",")}},{key:"validate",value:function(t){var e=this.required,n=this.operator,r=this.value,i=this.type;if(e&&/^\s*$/.test(t))return J(!1,"required");if(/^\s*$/.test(t))return[!0];if(G[i]&&!G[i].test(t))return J(!1,"notMatch");if("list"===i)return J(this.values().includes(t),"notIn");if(n){var o=this.parseValue(t);if("be"===n){var a=Y(r,2),l=a[0],s=a[1];return J(o>=this.parseValue(l)&&o<=this.parseValue(s),"between",l,s)}if("nbe"===n){var c=Y(r,2),u=c[0],f=c[1];return J(o<this.parseValue(u)||o>this.parseValue(f),"notBetween",u,f)}if("eq"===n)return J(o===this.parseValue(r),"equal",r);if("neq"===n)return J(o!==this.parseValue(r),"notEqual",r);if("lt"===n)return J(o<this.parseValue(r),"lessThan",r);if("lte"===n)return J(o<=this.parseValue(r),"lessThanEqual",r);if("gt"===n)return J(o>this.parseValue(r),"greaterThan",r);if("gte"===n)return J(o>=this.parseValue(r),"greaterThanEqual",r)}return[!0]}}])&&Z(e.prototype,n),r&&Z(e,r),t}();function Q(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function tt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nt(t,e,n){return e&&et(t.prototype,e),n&&et(t,n),t}var rt=function(){function t(e,n,r){tt(this,t),this.refs=n,this.mode=e,this.validator=r}return nt(t,[{key:"includes",value:function(t,e){for(var n=this.refs,r=0;r<n.length;r+=1){if(y.valueOf(n[r]).includes(t,e))return!0}return!1}},{key:"addRef",value:function(t){this.remove(y.valueOf(t)),this.refs.push(t)}},{key:"remove",value:function(t){var e=[];this.refs.forEach(function(n){var r=y.valueOf(n);r.intersects(t)?r.difference(t).forEach(function(t){return e.push(t.toString())}):e.push(n)}),this.refs=e}},{key:"getData",value:function(){var t=this.refs,e=this.mode,n=this.validator;return{refs:t,mode:e,type:n.type,required:n.required,operator:n.operator,value:n.value}}}],[{key:"valueOf",value:function(e){var n=e.refs,r=e.mode,i=e.type,o=e.required,a=e.operator,l=e.value;return new t(r,n,new K(i,o,l,a))}}]),t}(),it=function(){function t(){tt(this,t),this._=[],this.errors=new Map}return nt(t,[{key:"getError",value:function(t,e){return this.errors.get("".concat(t,"_").concat(e))}},{key:"validate",value:function(t,e,n){var r=this.get(t,e),i="".concat(t,"_").concat(e),o=this.errors;if(null!==r){var a=Q(r.validator.validate(n),2),l=a[0],s=a[1];l?o.delete(i):o.set(i,s)}else o.delete(i);return!0}},{key:"add",value:function(t,e,n){var r=n.type,i=n.required,o=n.value,a=n.operator,l=new K(r,i,o,a),s=this.getByValidator(l);null!==s?s.addRef(e):this._.push(new rt(t,[e],l))}},{key:"getByValidator",value:function(t){for(var e=0;e<this._.length;e+=1){var n=this._[e];if(n.validator.equals(t))return n}return null}},{key:"get",value:function(t,e){for(var n=0;n<this._.length;n+=1){var r=this._[n];if(r.includes(t,e))return r}return null}},{key:"remove",value:function(t){var e="".concat(t.sri,"_").concat(t.sci);this.errors.has(e)&&this.errors.delete(e),this.each(function(e){e.remove(t)})}},{key:"each",value:function(t){this._.forEach(function(e){return t(e)})}},{key:"getData",value:function(){return this._.filter(function(t){return t.refs.length>0}).map(function(t){return t.getData()})}},{key:"setData",value:function(t){this._=t.map(function(t){return rt.valueOf(t)})}}]),t}();var ot=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.keywords="",this.current=1,this.result=[]},at="x-spreadsheet";window.devicePixelRatio;function lt(t){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function st(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ct(t,e){return!e||"object"!==lt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ut(t){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ft(t,e){return(ft=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ht=function(t){function e(t){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=ct(this,ut(e).call(this,"div","".concat(at,"-icon")))).iconNameEl=a("div","".concat(at,"-icon-img ").concat(t)),n.child(n.iconNameEl),n}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ft(t,e)}(e,o),n=e,(r=[{key:"setName",value:function(t){this.iconNameEl.className("".concat(at,"-icon-img ").concat(t))}}])&&st(n.prototype,r),i&&st(n,i),e}();function dt(t,e,n){var r=a("div","".concat(at,"-toast")),i=a("div","".concat(at,"-dimmer active"));r.children(a("div","".concat(at,"-toast-header")).children(new ht("close").on("click.stop",function(){return document.body.removeChild(r.el),document.body.removeChild(i.el),void(n&&n())}),t),a("div","".concat(at,"-toast-content")).html(e)),document.body.appendChild(r.el),document.body.appendChild(i.el);var o=r.box(),l=o.width,s=o.height,c=document.documentElement,u=c.clientHeight,f=c.clientWidth;r.offset({left:(f-l)/2,top:(u-s)/3})}function pt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var bt={mode:"edit",updateMode:"client",updateUrl:"",folderName:"",fileName:"",view:{height:function(){return document.documentElement.clientHeight},width:function(){return document.documentElement.clientWidth}},showToolbar:!0,showPartToolbar:!1,showContextmenu:!0,row:{len:100,height:25},col:{len:26,width:100,indexWidth:60,minWidth:60},style:{align:"left",valign:"middle",textwrap:!1,strike:!1,underline:!1,color:"#0a0a0a",font:{name:"Arial",size:10,bold:!1,italic:!1},format:"normal"}};function gt(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=this.merges,i=e.clone(),o=yt(t.size(),2),a=o[0],l=o[1],s=yt(e.size(),2),c=s[0],u=s[1];return a>c&&(i.eri=e.sri+a-1),l>u&&(i.eci=e.sci+l-1),this.getRangeLocked(i)?(n("Protected worksheet,the target area contains locked cells"),!1):r.intersects(i)?(n(B("error.pasteForMergedCell")),!1):t.equals(i)?(n("The selection area is same "),!1):!t.intersects(i)||!(c>a&&Math.abs(e.sri-t.sri)%a!=0||u>l&&Math.abs(e.sci-t.sci)%l!=0)||(n("Invalid selection area"),!1)}function mt(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.rows,o=this.merges,a=this.name,l=i.copyPaste(t,e,n,r,function(t,e,n){if(n&&n.merge){var r=yt(n.merge,2),i=r[0],a=r[1];if(i<=0&&a<=0)return;o.add(new y(t,e,t+i,e+a))}});r?this.updateBatchCellsOpr(a,l):this.copyPasteRangeOpr(a,t,e,n)}function wt(t,e){var n=this.clipboard,r=this.rows,i=this.merges,o=this.name;r.cutPaste(t,e),i.move(t,e.sri-t.sri,e.sci-t.sci),n.clear(),this.cutPasteRangeOpr(o,t,e)}function kt(t,e,n){var r=this.styles,i=this.rows.getCellOrNew(t,e),o={};void 0!==i.style&&(o=z.cloneDeep(r[i.style])),o=z.merge(o,{border:n}),i.style=this.addStyle(o)}var Ot=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.settings=z.merge(bt,n||{}),this.name=e||"sheet",this.freeze=[0,0],this.styles=[],this.merges=new A,this.rows=new F(this.settings.row),this.cols=new H(this.settings.col),this.validations=new it,this.hyperlinks={},this.comments=[],this.viewRangeCache={},this.selector=new g,this.scroll=new m,this.history=new k,this.updateRows=new Set,this.clipboard=new S,this.autoFilter=new T,this.TableAutoFilters=[],this.change=function(){},this.updateCellsData=function(){},this.updateCellServer=function(){},this.updateServerError=function(){},this.updateCellError=function(){},this.loadImages=function(){},this.loadShapes=function(){},this.fillImageSrc=function(){},this.fillImageOnebyOne=function(){},this.loadConditionImage=function(){},this.reloadImagesShapes=function(){},this.scrollImagesShapes=function(){},this.exceptRowSet=new Set,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,this.isupdating=!1,this.search=new ot,this.showGrid=!0}var e,n,r;return e=t,(n=[{key:"addValidation",value:function(t,e,n){var r=this;this.changeData(function(){r.validations.add(t,e,n)})}},{key:"removeValidation",value:function(){var t=this,e=this.selector.range;this.changeData(function(){t.validations.remove(e)})}},{key:"getSelectedValidator",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=this.validations.get(e,n);return r?r.validator:null}},{key:"getSelectedValidation",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=t.range,i=this.validations.get(e,n),o={ref:r.toString()};return null!==i&&(o.mode=i.mode,o.validator=i.validator),o}},{key:"getSelectedSort",value:function(){var t=this.selector,e=t.ci,n=t.range,r={ref:n.toString(),ci:e};r.sort=this.autoFilter.getSort(e);for(var i=[],o=n.sri,a=n.eri,l=o+1;l<=a;l+=1){var s=this.getCell(l,e);null===s||/^\s*$/.test(s.text)||i.push(s.text)}return r.m=i,r}},{key:"canUndo",value:function(){return this.history.canUndo()}},{key:"canRedo",value:function(){return this.history.canRedo()}},{key:"undo",value:function(){var t=this;this.history.undo(function(e){return t.getRangeData(e.range)},function(e){t.setRangeData(e)})}},{key:"redo",value:function(){var t=this;this.history.redo(function(e){return t.getRangeData(e.range)},function(e){t.setRangeData(e)})}},{key:"copy",value:function(){this.clipboard.copy(this.selector.range,this.rows)}},{key:"cut",value:function(){this.clipboard.cut(this.selector.range)}},{key:"paste",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=this.clipboard,i=this.selector;return!r.isClear()&&(!!gt.call(this,r.range,i.range,n)&&(this.changeData(function(){var n=i.range.extendRange(r.range);i.range.setToOther(n),r.isCopy()?mt.call(t,r.range,n,e):r.isCut()&&wt.call(t,r.range,n)}),!0))}},{key:"pasteFromText",value:function(t){var e=this,n=this.name,r=t.split("\r\n").map(function(t){return t.replace(/"/g,"").split("\t")});if(r.length>0&&""==r[r.length-1]&&(r.length-=1),r.length>=1){var i=this.rows,o=this.selector;this.changeData(function(){var t=i.paste(r,o.range);e.updateBatchCellsOpr(n,t)})}}},{key:"autofill",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=this.selector.range;return!!gt.call(this,i,t,r)&&(this.changeData(function(){mt.call(n,i,t,e,!0)}),!0)}},{key:"clearClipboard",value:function(){this.clipboard.clear()}},{key:"calSelectedRangeByEnd",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges,a=n.range,l=a.sri,s=a.sci,c=a.eri,u=a.eci,f=n.ri,h=n.ci,d=t,p=e;return t<0&&(d=r.len-1),e<0&&(p=i.len-1),d>f?(l=f,c=d):(l=d,c=f),p>h?(s=h,u=p):(s=p,u=h),n.range=o.union(new y(l,s,c,u)),n.range=o.union(n.range),n.range}},{key:"calSelectedRangeByStart",value:function(t,e){var n=this.selector,r=this.rows,i=this.cols,o=this.merges.getFirstIncludes(t,e);return null===o&&(o=new y(t,e,t,e),-1===t&&(o.sri=0,o.eri=r.len-1),-1===e&&(o.sci=0,o.eci=i.len-1)),n.range=o,o}},{key:"setSelectedCellAttr",value:function(t,e){var n=this;this.changeData(function(){var r=n.selector,i=n.styles,o=n.rows,a=n.name;if("merge"===t)e?n.merge():n.unmerge();else if("border"===t)(function(t){var e=this,n=t.mode,r=t.style,i=t.color,o=this.styles,a=this.selector,l=this.rows,s=a.range,c=s.sri,u=s.sci,f=s.eri,h=s.eci,d=!this.isSignleSelected();if(d||"inside"!==n&&"horizontal"!==n&&"vertical"!==n)if("outside"!==n||d){if("none"===n)a.range.each(function(t,n){var r=l.getCell(t,n);if(r&&void 0!==r.style){var i=z.cloneDeep(o[r.style]);delete i.border,r.style=e.addStyle(i)}});else if("all"===n||"inside"===n||"outside"===n||"horizontal"===n||"vertical"===n)!function(){for(var t=[],o=c;o<=f;o+=1)for(var a=u;a<=h;a+=1){for(var s=[],p=0;p<t.length;p+=1){var v=yt(t[p],4),y=v[0],b=v[1],g=v[2],m=v[3];if(o===y+g+1&&s.push(p),y<=o&&o<=y+g&&a===b){a+=m+1;break}}if(s.forEach(function(e){return t.splice(e,1)}),a>h)break;var w=l.getCell(o,a),k=0,O=0;if(w&&w.merge){var S=yt(w.merge,2);k=S[0],O=S[1],t.push([o,a,k,O])}var x=k>0&&o+k===f,E=O>0&&a+O===h,C={};"all"===n?C={bottom:[r,i],top:[r,i],left:[r,i],right:[r,i]}:"inside"===n?(!E&&a<h&&(C.right=[r,i]),!x&&o<f&&(C.bottom=[r,i])):"horizontal"===n?!x&&o<f&&(C.bottom=[r,i]):"vertical"===n?!E&&a<h&&(C.right=[r,i]):"outside"===n&&d&&(c===o&&(C.top=[r,i]),(x||f===o)&&(C.bottom=[r,i]),u===a&&(C.left=[r,i]),(E||h===a)&&(C.right=[r,i])),Object.keys(C).length>0&&kt.call(e,o,a,C),a+=O}}();else if("top"===n||"bottom"===n)for(var p=u;p<=h;p+=1)"top"===n&&(kt.call(this,c,p,{top:[r,i]}),p+=l.getCellMerge(c,p)[1]),"bottom"===n&&(kt.call(this,f,p,{bottom:[r,i]}),p+=l.getCellMerge(f,p)[1]);else if("left"===n||"right"===n)for(var v=c;v<=f;v+=1)"left"===n&&(kt.call(this,v,u,{left:[r,i]}),v+=l.getCellMerge(v,u)[0]),"right"===n&&(kt.call(this,v,h,{right:[r,i]}),v+=l.getCellMerge(v,h)[0])}else kt.call(this,c,u,{top:[r,i],bottom:[r,i],left:[r,i],right:[r,i]})}).call(n,e);else if("formula"===t){var l=r.ri,s=r.ci,c=r.range;if(r.multiple()){var u=yt(r.size(),2),f=u[0],d=u[1],p=c.sri,v=c.sci,y=c.eri,b=c.eci;if(f>1)for(var g=v;g<=b;g+=1){o.getCellOrNew(y+1,g).text="=".concat(e,"(").concat(h(g,p),":").concat(h(g,y),")")}else if(d>1){o.getCellOrNew(l,b+1).text="=".concat(e,"(").concat(h(v,l),":").concat(h(b,l),")")}}else{o.getCellOrNew(l,s).text="=".concat(e,"()")}}else r.range.each(function(r,l){var s=o.getCellOrNew(r,l),c={};if(void 0!==s.style&&(c=z.cloneDeep(i[s.style])),"format"===t)c.format=e,"normal"===e?(delete c.number,delete c.custom):"text"===e?(c.number=49,delete c.custom):"number"===e?(c.custom="#,##0.00_",delete c.number):"percent"===e?(c.number=10,delete c.custom):"rmb"===e?(c.custom="[$¥-804]#,##0.00",delete c.number):"usd"===e?(c.custom="$#,##0.00",delete c.number):"eur"===e?(c.custom="[$€-408]#,##0.00",delete c.number):"date"===e?(c.custom="mm/dd/yyyy",delete c.number):"time"===e?(c.number=21,delete c.custom):"datetime"===e?(c.custom="mm/dd/yyyy hh:mm:ss",delete c.number):"duration"===e&&(c.custom="[h]:mm:ss",delete c.number),s.style=n.addStyle(c),n.updateCellStyleOpr(a,r,l,c);else if("font-bold"===t||"font-italic"===t||"font-name"===t||"font-size"===t){var u={};u[t.split("-")[1]]=e,c.font=Object.assign(c.font||{},u),s.style=n.addStyle(c)}else"strike"===t||"textwrap"===t||"underline"===t||"align"===t||"valign"===t||"color"===t||"bgcolor"===t||"pbgcolor"===t||"pattern"===t?(c[t]=e,s.style=n.addStyle(c),"align"===t&&delete s.isautoalign):s[t]=e})})}},{key:"setSelectedCellText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"input",n=this.autoFilter,r=this.selector,i=this.rows,o=r.ri,a=r.ci,l=o;this.unsortedRowMap.has(o)&&(l=this.unsortedRowMap.get(o));var s=i.getCell(l,a),c=s?s.text:"";if(this.setCellText(l,a,t,e),n.active()){var u=n.getFilter(a);if(u){var f=u.value.findIndex(function(t){return t===c});f>=0&&u.value.splice(f,1,t)}}}},{key:"getSelectedCell",value:function(){var t=this.selector,e=t.ri,n=t.ci,r=e;return this.unsortedRowMap.has(e)&&(r=this.unsortedRowMap.get(e)),this.rows.getCell(r,n)}},{key:"canSelected",value:function(t,e){if(!this.sprotected)return!0;var n=t;this.unsortedRowMap.has(t)&&(n=this.unsortedRowMap.get(t));var r=this.getCellStyle(n,e);return null==r?this.canselectlocked:!(!r.unlocked||!this.canselectunlocked)||!(r.unlocked||!this.canselectlocked)}},{key:"getLocked",value:function(){var t=this.selector,e=t.ri,n=t.ci;return this.getCellLocked(e,n)}},{key:"getCellLocked",value:function(t,e){if(!this.sprotected)return!1;var n=t;this.unsortedRowMap.has(t)&&(n=this.unsortedRowMap.get(t));var r=this.getCellStyle(n,e);return!(null!=r&&r.unlocked)}},{key:"getRangeLocked",value:function(t){for(var e=t.sri;e<=t.eri;e+=1)for(var n=t.sci;n<=t.eci;n+=1)if(this.getCellLocked(e,n))return!0;return!1}},{key:"xyInSelectedRect",value:function(t,e){var n=this.getSelectedRect(),r=n.left,i=n.top,o=n.width,a=n.height,l=this.settings.row.height,s=t-this.cols.indexWidth,c=e-l;return s>r&&s<r+o&&c>i&&c<i+a}},{key:"getSelectedRectBySearch",value:function(){return this.getRect(this.selector.range)}},{key:"getSelectedRect",value:function(){var t=this.selector.range.clone();if(this.freezeIsActive()){if(t.sri>=this.freeze[0]&&t.eri<this.scroll.riact)return{left:-100,top:-100};t.sri>=this.freeze[0]&&t.sri<this.scroll.riact&&(t.sri=this.scroll.riact)}else{if(t.eri<this.scroll.riact)return{left:-100,top:-100};t.sri<this.scroll.riact&&(t.sri=this.scroll.riact)}return this.getRect(t)}},{key:"getClipboardRect",value:function(){var t=this.clipboard;return t.isClear()?{left:-100,top:-100}:this.getRect(t.range)}},{key:"getRect",value:function(t){var e=this.scroll,n=this.rows,r=this.cols,i=this.exceptRowSet,o=this.displayRight2Left,a=this.freeze,l=t.sri,s=t.sci,c=t.eri,u=t.eci;if(l<0&&s<0)return{left:0,l:0,top:0,t:0,scroll:e};var f=yt(a,2)[1],h=o?this.viewWidth()-r.indexWidth-r.sumWidth(0,u+1):r.sumWidth(0,s),d=n.sumHeight(0,l,i),p=n.sumHeight(l,c+1,i),v=r.sumWidth(s,u+1),y=o?f>0&&u>=f||0===f?h+e.x:h:h-e.x,b=this.freezeTotalHeight(),g=this.freezeTotalWidth(),m=n.sumHeight(e.riact,l,i)+b;return g>0&&g>h&&!o&&(y=h),b>0&&b>d&&(m=d),{l:h,t:d,left:y,top:m,height:p,width:v,scroll:e}}},{key:"getCellRectByXY",value:function(t,e){var n=this.scroll,r=this.merges,i=this.rows,o=this.cols,a=function(t,e){var n=this.rows,r=this.scroll,i=this.freezeTotalHeight(),o=this.settings.row.height,a=this.exceptRowSet;0===r.riact&&this.freeze[0]>0&&(r.riact=this.freeze[0]);var l=o+i,s=t>l?r.riact:0;0===s&&(l=o);for(var c=0;s<n.len&&!(l>t);s+=1)a.has(s)||(l+=c=n.getHeight(s));return{ri:s-1,top:l-=c,height:c}}.call(this,e,n.y),l=a.ri,s=a.top,c=a.height,u=function(t,e){var n=this.cols,r=this.displayRight2Left,i=this.freezeTotalWidth(),o=n.indexWidth;if(r){var a=this.viewWidth();i+n.indexWidth<a-t&&(o-=e);var l=yt(z.rangeReduceIf(0,n.len,o,n.indexWidth,a-t,function(t){return n.getWidth(t)}),3),s=l[0],c=l[1],u=l[2];return c<=0?{ci:-1,left:a,width:n.indexWidth}:{ci:s-1,left:a-c,width:u}}i+n.indexWidth<t&&(o-=e);var f=yt(z.rangeReduceIf(0,n.len,o,n.indexWidth,t,function(t){return n.getWidth(t)}),3),h=f[0],d=f[1],p=f[2];return d<=0?{ci:-1,left:0,width:n.indexWidth}:{ci:h-1,left:d,width:p}}.call(this,t,n.x),f=u.ci,h=u.left,d=u.width;if(-1===f&&(d=o.totalWidth()),-1===l&&(c=i.totalHeight()),l>=0||f>=0){var p=r.getFirstIncludes(l,f);if(p){l=p.sri,f=p.sci;var v=this.cellRectWithOutTransfer(l,f);h=v.left,s=v.top,d=v.width,c=v.height}}return{ri:l,ci:f,left:h,top:s,width:d,height:c}}},{key:"isSignleSelected",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=yt(o.merge,2),l=a[0],s=a[1];if(e+l===r&&n+s===i)return!0}return!this.selector.multiple()}},{key:"canUnmerge",value:function(){var t=this.selector.range,e=t.sri,n=t.sci,r=t.eri,i=t.eci,o=this.getCell(e,n);if(o&&o.merge){var a=yt(o.merge,2),l=a[0],s=a[1];if(e+l===r&&n+s===i)return!0}return!1}},{key:"merge",value:function(){var t=this.selector,e=this.rows;if(!this.isSignleSelected()){var n=yt(t.size(),2),r=n[0],i=n[1];if(r>1||i>1){var o=t.range,a=o.sri,l=o.sci,s=e.getCellOrNew(a,l);s.merge=[r-1,i-1],this.merges.add(t.range),this.rows.deleteCells(t.range),this.rows.setCell(a,l,s)}}}},{key:"unmerge",value:function(){var t=this.selector;if(this.isSignleSelected()){var e=t.range,n=e.sri,r=e.sci;this.rows.deleteCell(n,r,"merge"),this.merges.deleteWithin(t.range)}}},{key:"canAutofilter",value:function(){return!this.autoFilter.active()}},{key:"autofilter",value:function(){var t=this,e=this.autoFilter,n=this.selector,r=this.TableAutoFilters;if(!e.active())for(var i=0,o=r.length;i<o;i++){var a=r[i],l=y.valueOf(a.ref);if(!(l.eci<n.range.sci||n.range.eci<l.sci))return void dt("Warning","there is already table autofilter in the selected range")}this.changeData(function(){e.active()?(e.clear(),t.exceptRowSet=new Set,t.sortedRowMap=new Map,t.unsortedRowMap=new Map):e.ref=n.range.toString()})}},{key:"autoSort",value:function(){var t=this.autoFilter,e=this.selector;this.changeData(function(){t.filters=[],t.ref=e.range.toString()})}},{key:"setAutoFilter",value:function(t,e,n,r){var i=this.currentAutoFilter;i.addFilter(t,n,r),i.setSort(t,e),this.resetAutoFilter()}},{key:"resetAutoFilter",value:function(){var t=this,e=this.currentAutoFilter,n=this.rows,r=e;if(void 0===r&&(r=this.autoFilter),r.active()){var i=r.sort,o=r.filteredRows(function(t,e){return n.getCell(t,e)}),a=o.rset,l=o.fset,s=Array.from(l),c=Array.from(l);i&&s.sort(function(t,e){if("desc"===i.order){var r=t;t=e,e=r}var o=n.getCell(t,i.ci),a=n.getCell(e,i.ci);if(null!=o&&""===o.text&&(o=null),null!=a&&""===a.text&&(a=null),null==o&&null==a)return t-e;if(null==o)return"asc"===i.order?1:-1;if(null==a)return"asc"===i.order?-1:1;o=o.text,a=a.text;var l=isNaN(Number(o)),s=isNaN(Number(a));return l&&s?o.localeCompare(a):l&&!s?1:!l&&s?-1:Number(o)-Number(a)}),this.exceptRowSet=a,this.sortedRowMap=new Map,this.unsortedRowMap=new Map,s.forEach(function(e,n){t.sortedRowMap.set(c[n],e),t.unsortedRowMap.set(e,c[n])})}}},{key:"deleteExceptRowHideForAutoFilter",value:function(){var t=this.exceptRowSet,e=this.rows;t.forEach(function(t){e.get(t)&&(e.get(t).hide=void 0)})}},{key:"createConditionImage",value:function(t,e){var n=new Image;n.src="data:image/png;base64,"+t.data;var r=this.cols.sumWidth(0,t.col),i=this.rows.sumHeight(0,t.row);if(0===t.type){n.style.zIndex=e+1;var o=this.getCellStyle(t.row,t.col);null!=o&&"bottom"===o.valign&&(i+=this.rows.getHeight(t.row)-16)}else n.style.zIndex=e;return(this.rows.isHide(t.row)||this.cols.isHide(t.col)||this.exceptRowSet.has(t.row))&&(n.style.display="none"),n.style.left=r+"px",n.style.top=i+"px",n.style.position="absolute",n}},{key:"updateConditionImageVisible",value:function(){var t=this.exceptRowSet,e=this.rows,n=this.cols;this.conditionimg&&this.conditionimg.forEach(function(r){e.isHide(r.row)||n.isHide(r.col)||t.has(r.row)?r.image.style.display="none":r.image.style.display="block"})}},{key:"deleteCell",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all",n=this.selector,r=this.name;this.changeData(function(){t.rows.deleteCells(n.range,e),"all"!==e&&"format"!==e||t.merges.deleteWithin(n.range),t.delCellOpr(r,n.range,e)})}},{key:"insert",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.changeData(function(){var r=e.selector.range,i=r.sri,o=r.sci,a=e.rows,l=e.merges,s=e.cols,c=e.name,u=i;"row"===t?(a.insert(i,n),e.insertRowOpr(c,i,n)):"column"===t&&(a.insertColumn(o,n),u=o,s.len+=1,e.insertColumnOpr(c,o,n)),l.shift(t,u,n,function(t,e,n,r){var i=a.getCell(t,e);i.merge[0]+=n,i.merge[1]+=r})},!1)}},{key:"delete",value:function(t){var e=this;this.changeData(function(){var n=e.rows,r=e.merges,i=e.selector,o=e.cols,a=e.name,l=i.range,s=i.range,c=s.sri,u=s.sci,f=s.eri,h=s.eci,d=yt(i.range.size(),2),p=d[0],v=d[1],y=c,b=p;"row"===t?confirm("sure to delete rows from   "+(c+1)+" to "+(f+1))&&(n.delete(c,f),e.deleteRowOpr(a,c,f)):"column"===t&&confirm("sure to delete columns from   "+(u+1)+" to "+(h+1))&&(n.deleteColumn(u,h),y=l.sci,b=v,o.len-=1,e.deleteColumnOpr(a,u,h)),r.shift(t,y,-b,function(t,e,r,i){var o=n.getCell(t,e);o.merge[0]+=r,o.merge[1]+=i,0===o.merge[0]&&0===o.merge[1]&&delete o.merge})},!1)}},{key:"scrollx",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.cols;this.displayRight2Left&&(t=-t);var o=yt(r,2)[1],a=yt(z.rangeReduceIf(o,i.len,0,0,t,function(t){return i.getWidth(t)}),3),l=a[0],s=a[1],c=a[2],u=s;t>0&&(u+=c),n.x!==u&&(n.ci=t>0?l:0,n.x=u,e())}},{key:"scrolly",value:function(t,e){var n=this.scroll,r=this.freeze,i=this.rows,o=this.exceptRowSet,a=yt(r,1)[0],l=yt(z.rangeReduceIf(a,i.len,0,0,t,function(t){return i.getHeight(t,o)}),3),s=l[0],c=l[1],u=l[2],f=c;if(t>0&&(f+=u),n.y!==f){for(n.ri=t>0?s:0,n.y=f,0===n.ri&&this.freeze[0]>0&&(n.ri=this.freeze[0],n.y=0),n.yact=n.y,n.riact=n.ri;this.isInvisibleRow(n.riact);)n.yact+=i.getHeight(n.riact,o),n.riact++;e()}}},{key:"isInvisibleRow",value:function(t){var e=this.exceptRowSet;return this.rows.isHide(t)||e.has(t)}},{key:"cellRect",value:function(t,e){var n=this.rows,r=this.cols,i=this.exceptRowSet,o=this.displayRight2Left,a=this.scroll,l=n.sumHeight(0,t,i),s=n.getCell(t,e),c=r.getWidth(e),u=n.getHeight(t);if(null!==s&&s.merge){var f=yt(s.merge,2),h=f[0],d=f[1];if(h>0)for(var p=1;p<=h;p+=1)u+=n.getHeight(t+p);if(d>0)for(var v=1;v<=d;v+=1)c+=r.getWidth(e+v)}var y=o?this.viewWidth()-r.sumWidth(0,e)-c+2*a.x:r.sumWidth(0,e);if(o){var b=yt(this.freeze,2),g=(b[0],b[1]);g>0&&e<g&&(y-=2*a.x)}return{left:y,top:l,width:c,height:u,cell:s}}},{key:"cellRectWithOutTransfer",value:function(t,e){var n=this.cellRect(t,e),r=this.cols.indexWidth,i=this.settings.row.height;return n.left+=r,n.top+=i,n}},{key:"getCell",value:function(t,e){return this.rows.getCell(t,e)}},{key:"getCellTextOrDefault",value:function(t,e){var n=this.getCell(t,e);return n&&n.text?n.text:""}},{key:"isEmpty",value:function(t,e){var n=this.getCell(t,e);return!n||!n.text||0===n.text.trim().length}},{key:"getCellStyle",value:function(t,e){var n=this.getCell(t,e);return n&&void 0!==n.style?this.styles[n.style]:null}},{key:"getCellStyleOrDefault",value:function(t,e){var n=this.styles,r=this.rows,i=this.displayRight2Left,o=r.getCell(t,e),a=o&&void 0!==o.style?n[o.style]:{},l=z.merge(this.defaultStyle(),a);if(void 0!==a.bgcolor&&(l.hasbgcolor=!0),o&&void 0!==o.merge){if(0!=o.merge[1]){var s=r.getCell(t,e+o.merge[1]),c=s&&void 0!==s.style?n[s.style]:{};c.border&&void 0!==c.border.right&&(void 0===a.border&&(a.border={}),a.border.right=c.border.right)}if(0!=o.merge[0]){var u=r.getCell(t+o.merge[0],e),f=u&&void 0!==u.style?n[u.style]:{};f.border&&void 0!==f.border.bottom&&(void 0===a.border&&(a.border={}),a.border.bottom=f.border.bottom)}}if(void 0!==l.border&&i){var h=l.border.right;l.border.right=l.border.left,l.border.left=h}return l}},{key:"getSelectedCellStyle",value:function(){var t=this.selector,e=t.ri,n=t.ci;return this.getCellStyleOrDefault(e,n)}},{key:"setCellText",value:function(t,e,n,r){var i=this.rows,o=this.history,a=this.validations,l=this.settings,s=this.name;"finished"===r?("server"!==l.updateMode&&(i.setCellText(t,e,""),o.add(this.getData()),i.setCellText(t,e,n)),"server"===l.updateMode&&this.updateCellTextOpr(s,t,e,n)):i.setCellText(t,e,n),a.validate(t,e,n)}},{key:"isNumber",value:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},{key:"isDate",value:function(t){return isNaN(t)&&!isNaN(Date.parse(t))}},{key:"setCellAutoAlignment",value:function(t,e,n){var r=this.styles,i=this.rows.getCellOrNew(t,e),o={};void 0!==i.style&&(o=z.cloneDeep(r[i.style])),(i.isautoalign||void 0===o.align)&&(o.align=n,i.style=this.addStyle(o),i.isautoalign=!0)}},{key:"cutPasteRangeOpr",value:function(t,e,n){var r={name:t,src:e,dest:n,op:"cutpaste"};this.updateCellServer(r)}},{key:"copyPasteRangeOpr",value:function(t,e,n,r){var i={name:t,src:e,dest:n,op:"copypaste",what:r};this.updateCellServer(i)}},{key:"updateBatchCellsOpr",value:function(t,e){var n={name:t,cells:e,op:"batchupdate"};this.updateCellServer(n)}},{key:"updateCellStyleOpr",value:function(t,e,n,r){var i={name:t,ri:e,ci:n,number:r.number,custom:r.custom,op:"updatestyle"};this.updateCellServer(i)}},{key:"updateCellTextOpr",value:function(t,e,n,r){var i={name:t,ri:e,ci:n,text:r,op:"update"};this.updateCellServer(i)}},{key:"delCellOpr",value:function(t,e,n){var r={name:t,range:e,what:n,op:"delcells"};this.updateCellServer(r)}},{key:"addSheetOpr",value:function(t){var e={name:t,op:"add"};this.updateCellServer(e)}},{key:"delSheetOpr",value:function(t){var e={name:t,op:"del"};this.updateCellServer(e)}},{key:"renameSheetOpr",value:function(t,e){var n={oldname:t,name:e,op:"rename"};this.updateCellServer(n)}},{key:"insertRowOpr",value:function(t,e,n){var r={name:t,ri:e,n:n,op:"insertrow"};this.updateCellServer(r)}},{key:"insertColumnOpr",value:function(t,e,n){var r={name:t,ci:e,n:n,op:"insertcol"};this.updateCellServer(r)}},{key:"deleteRowOpr",value:function(t,e,n){var r={name:t,sri:e,eri:n,op:"delrow"};this.updateCellServer(r)}},{key:"deleteColumnOpr",value:function(t,e,n){var r={name:t,sci:e,eci:n,op:"delcol"};this.updateCellServer(r)}},{key:"setAutoAlignForCell",value:function(t){t.ufv||this.isNumber(t.text)||this.isDate(t.text)?this.setCellAutoAlignment(t.ri,t.ci,"right"):this.setCellAutoAlignment(t.ri,t.ci,"left")}},{key:"updateMyCells",value:function(t){var e=this,n=this.rows;t.forEach(function(t,r,i){n.updateOneCell(t),e.setAutoAlignForCell(t)})}},{key:"updateShapes",value:function(t,e){var n=this.shapes;null!=n&&null!=t&&t.forEach(function(t,r,i){for(var o=0,a=n.length;o<a;o++)if(n[o].id===t.id){var l={};l.id="s_"+t.id+"_"+n[o].tick,l.name=t.id+"."+t.tick,l.it=n[o],e.push(l),$("#"+l.id).addClass("resize-image").removeAttr("src");break}})}},{key:"updateShapeSrcToRefresh",value:function(t,e,n,r){if(r.length>0){var i=this;$.get(e+"?uid="+t+"&id="+n,function(t){i.fillImageOnebyOne(t,r)})}}},{key:"validateFormula",value:function(t){for(var e=0,n=0;n<t.length;n++)"("===t[n]?e++:")"===t[n]&&e--;return 0===e}},{key:"freezeIsActive",value:function(){var t=yt(this.freeze,2),e=t[0],n=t[1];return e>0||n>0}},{key:"resetScroll",value:function(){var t=this.scroll;t.riact=0,t.ri=0,t.y=0,t.yact=0,t.x=0,t.ci=0}},{key:"setFreeze",value:function(t,e){var n=this;0===t&&this.resetScroll(),this.changeData(function(){n.freeze=[t,e]})}},{key:"freezeTotalWidth",value:function(){return this.cols.sumWidth(0,this.freeze[1])}},{key:"freezeTotalHeight",value:function(){return this.rows.sumHeight(0,this.freeze[0],this.exceptRowSet)}},{key:"setRowHeight",value:function(t,e){var n=this;this.changeData(function(){n.rows.setHeight(t,e)})}},{key:"setColWidth",value:function(t,e){var n=this;this.changeData(function(){n.cols.setWidth(t,e)})}},{key:"viewHeight",value:function(){var t=this.settings,e=t.view,n=t.showToolbar,r=e.height();return r-=26,r-=41,n&&(r-=41),r}},{key:"viewWidth",value:function(){return this.settings.view.width()}},{key:"freezeViewRange",value:function(){var t=yt(this.freeze,2),e=t[0],n=t[1];return new y(0,0,e-1,n-1,this.freezeTotalWidth(),this.freezeTotalHeight())}},{key:"contentRange",value:function(){var t=this.rows,e=this.cols,n=yt(t.maxCell(),2),r=n[0],i=n[1],o=t.sumHeight(0,r+1),a=e.sumWidth(0,i+1);return new y(0,0,r,i,a,o)}},{key:"exceptRowTotalHeight",value:function(t,e){var n=this.exceptRowSet,r=this.rows,i=Array.from(n),o=0;return i.forEach(function(n){if(n<t||n>e){var i=r.getHeight(n);o+=i}}),o}},{key:"viewRange",value:function(){var t=this.scroll,e=this.rows,n=this.cols,r=this.freeze,i=this.exceptRowSet,o=t.ri,a=t.ci;o<=0&&(o=yt(r,1)[0]);a<=0&&(a=yt(r,2)[1]);for(var l=0,s=0,c=[e.len,n.len],u=c[0],f=c[1],h=o;h<e.len&&(i.has(h)||(s+=e.getHeight(h),u=h),!(s>this.viewHeight()));h+=1);for(var d=a;d<n.len&&(f=d,!((l+=n.getWidth(d))>this.viewWidth()));d+=1);var p=new y(o,a,u,f,l,s);return this.viewRangeCache=p,p}},{key:"eachMergesInView",value:function(t,e){this.merges.filterIntersects(t).forEach(function(t){return e(t)})}},{key:"hideRowsOrCols",value:function(){var t=this.rows,e=this.cols,n=this.selector,r=yt(n.size(),2),i=r[0],o=r[1],a=n.range,l=a.sri,s=a.sci,c=a.eri,u=a.eci;if(i===t.len)for(var f=s;f<=u;f+=1)e.setHide(f,!0);else if(o===e.len)for(var h=l;h<=c;h+=1)t.setHide(h,!0)}},{key:"unhideRowsOrCols",value:function(t,e){this["".concat(t,"s")].unhide(e)}},{key:"rowEach",value:function(t,e,n){for(var r=0,i=this.rows,o=this.exceptRowSet,a=(pt(o),0),l=t+a;l<=e;l+=1)if(o.has(l))a+=1;else{var s=i.getHeight(l);if(s>0&&(n(l,r,s),(r+=s)>this.viewHeight()))break}}},{key:"colEach",value:function(t,e,n){for(var r=0,i=this.cols,o=t;o<=e;o+=1){var a=i.getWidth(o);if(a>0&&(n(o,r,a),(r+=a)>this.viewWidth()))break}}},{key:"defaultStyle",value:function(){return this.settings.style}},{key:"addStyle",value:function(t){for(var e=this.styles,n=0;n<e.length;n+=1){var r=e[n];if(z.equals(r,t))return n}return e.push(t),e.length-1}},{key:"changeData",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.history.add(this.getRangeData(this.selector.range)),t(),this.change(this.getData()),e)for(var n=this.selector.range,r=n.sri,i=(n.sci,n.eri),o=(n.eci,r);o<=i;o++)this.updateRows.add(o)}},{key:"setRangeData",value:function(t){this.rows.setRangeData(t.rows,t.range),this.merges.setData(t.merges)}},{key:"setData",value:function(t){var e=this;return Object.keys(t).forEach(function(n){if("merges"===n||"rows"===n||"cols"===n||"validations"===n)e[n].setData(t[n]);else if("freeze"===n){var r=yt(f(t[n]),2),i=r[0],o=r[1];e.freeze=[o,i]}else if("autofilter"===n)e.autoFilter.setData(t[n]);else if("lautofilters"===n){var a=t[n],l=e;a.forEach(function(t){var e=new T;e.setData(t),l.TableAutoFilters.push(e)})}else void 0!==t[n]&&(e[n]=t[n])}),this}},{key:"getData",value:function(){var t=this.name,e=this.freeze,n=this.styles,r=this.merges,i=this.rows,o=this.cols,a=this.validations,l=this.autoFilter,s=this.TableAutoFilters,c={name:t,freeze:h(e[1],e[0]),styles:n,merges:r.getData(),rows:i.getData(),cols:o.getData(),validations:a.getData(),autofilter:l.getData(),TableAutoFilters:[]};return s.forEach(function(t){c.TableAutoFilters.push(t.getData())}),c}},{key:"getRangeData",value:function(t){var e=this.merges,n=this.rows;this.styles;return{rows:n.getRangeData(t),merges:e.getData(),range:t}}},{key:"getDataForSave",value:function(){var t=this.name,e=this.freeze,n=this.styles,r=this.merges,i=this.rows,o=this.cols,a=this.validations,l=this.autoFilter,s=this.settings,c=this.updateRows,u=this.canselectlocked,f=this.sprotected,d=this.canselectunlocked,p=this.showGrid,v=this.comments;return{name:t,freeze:h(e[1],e[0]),styles:n,comments:v,canselectlocked:u,sprotected:f,canselectunlocked:d,showGrid:p,merges:r.getDataForSave(),settings:s,cols:o.getDataForSave(),rows:i.getDataForRowsSet(c),validations:a.getData(),autofilter:l.getData()}}}])&&vt(e.prototype,n),r&&vt(e,r),t}();function St(t,e,n){t.addEventListener(e,n)}function xt(t,e,n){t.removeEventListener(e,n)}function Et(t){t.xclickoutside&&(xt(window.document.body,"click",t.xclickoutside),delete t.xclickoutside)}function Ct(t,e){t.xclickoutside=function(n){2===n.detail||t.contains(n.target)||(e?e(t):(t.hide(),Et(t)))},St(window.document.body,"click",t.xclickoutside)}function _t(t,e,n){St(t,"mousemove",e),t.xEvtUp=function(r){xt(t,"mousemove",e),xt(t,"mouseup",t.xEvtUp),n(r)},St(t,"mouseup",t.xEvtUp)}function jt(t,e,n,r){Math.abs(t)>Math.abs(e)?r(t>0?"right":"left",t,n):r(e>0?"down":"up",e,n)}function Tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Pt=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1?arguments[1]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.moving=!1,this.vertical=n,this.el=a("div","".concat(at,"-resizer ").concat(n?"vertical":"horizontal")).children(this.unhideHoverEl=a("div","".concat(at,"-resizer-hover")).on("dblclick.stop",function(t){return e.mousedblclickHandler(t)}).css("position","absolute").hide(),this.hoverEl=a("div","".concat(at,"-resizer-hover")).on("mousedown.stop",function(t){return e.mousedownHandler(t)}),this.lineEl=a("div","".concat(at,"-resizer-line")).hide()).hide(),this.cRect=null,this.IsRight2Left=!1,this.finishedFn=null,this.minDistance=r,this.unhideFn=function(){}}var e,n,r;return e=t,(n=[{key:"showUnhide",value:function(t){this.unhideIndex=t,this.unhideHoverEl.show()}},{key:"hideUnhide",value:function(){this.unhideHoverEl.hide()}},{key:"show",value:function(t,e,n){var r=this.moving,i=this.vertical,o=this.hoverEl,a=this.lineEl,l=this.el,s=this.unhideHoverEl;if(!r){this.IsRight2Left=n,this.cRect=t;var c=t.left,u=t.top,f=t.width,h=t.height,d=n?c-f:c+f-5;l.offset({left:i?d:c,top:i?u:u+h-5}).show(),o.offset({width:i?5:f,height:i?h:5}),a.offset({width:i?0:e.width,height:i?e.height:0}),s.offset({left:i?5-f:c,top:i?u:5-h,width:i?5:f,height:i?h:5})}}},{key:"hide",value:function(){this.el.offset({left:0,top:0}).hide(),this.hideUnhide()}},{key:"mousedblclickHandler",value:function(){this.unhideIndex&&this.unhideFn(this.unhideIndex)}},{key:"mousedownHandler",value:function(t){var e=this,n=t,r=this.el,i=this.lineEl,o=this.cRect,a=this.vertical,l=this.minDistance,s=this.IsRight2Left,c=a?o.width:o.height;i.show(),_t(window,function(t){e.moving=!0,null!==n&&1===t.buttons&&(a?(s?c-=t.movementX:c+=t.movementX,c>l&&(s?r.css("left","".concat(o.left-c,"px")):r.css("left","".concat(o.left+c,"px")))):(c+=t.movementY)>l&&r.css("top","".concat(o.top+c,"px")),n=t)},function(){n=null,i.hide(),e.moving=!1,e.hide(),e.finishedFn&&(c<l&&(c=l),e.finishedFn(o,c))})}}])&&Tt(e.prototype,n),r&&Tt(e,r),t}();function At(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Rt=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vertical=e,this.moveFn=null,this.el=a("div","".concat(at,"-scrollbar ").concat(e?"vertical":"horizontal")).child(this.contentEl=a("div","")).on("mousemove.stop",function(){}).on("scroll.stop",function(t){var e=t.target,r=e.scrollTop,i=e.scrollLeft;n.moveFn&&n.moveFn(n.vertical?r:i,t)})}var e,n,r;return e=t,(n=[{key:"move",value:function(t){return this.el.scroll(t),this}},{key:"scroll",value:function(){return this.el.scroll()}},{key:"set",value:function(t,e){var n=t-1;if(e>n){var r=this.vertical?"height":"width";this.el.css(r,"".concat(n-15,"px")).show(),this.contentEl.css(this.vertical?"width":"height","1px").css(r,"".concat(e,"px"))}else this.el.hide();return this}}])&&At(e.prototype,n),r&&At(e,r),t}();function Dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function It(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zt(t,e,n){return e&&It(t.prototype,e),n&&It(t,n),t}var Nt=10,Wt=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Dt(this,t),this.useHideInput=n,this.inputChange=function(){},this.cornerEl=a("div","".concat(at,"-selector-corner")),this.areaEl=a("div","".concat(at,"-selector-area")).child(this.cornerEl).hide(),this.clipboardEl=a("div","".concat(at,"-selector-clipboard")).hide(),this.autofillEl=a("div","".concat(at,"-selector-autofill")).hide(),this.el=a("div","".concat(at,"-selector")).css("z-index","".concat(Nt)).children(this.areaEl,this.clipboardEl,this.autofillEl).hide(),n&&(this.hideInput=a("input","").on("compositionend",function(t){e.inputChange(t.target.value)}),this.el.child(this.hideInputDiv=a("div","hide-input").child(this.hideInput)),this.el.child(this.hideInputDiv=a("div","hide-input").child(this.hideInput))),Nt+=1}return zt(t,[{key:"setOffset",value:function(t){return this.el.offset(t).show(),this}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"setAreaOffset",value:function(t){var e=t.left,n=t.top,r={width:t.width+.8,height:t.height+.8,left:e-.8,top:n-.8};this.areaEl.offset(r).show(),this.useHideInput&&(this.hideInputDiv.offset(r),this.hideInput.val("").focus())}},{key:"setClipboardOffset",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.clipboardEl.offset({left:e,top:n,width:r-2.4,height:i-2.4})}},{key:"showAutofill",value:function(t){var e=t.left,n=t.top,r=t.width,i=t.height;this.autofillEl.offset({width:r-3,height:i-3,left:e,top:n}).show()}},{key:"hideAutofill",value:function(){this.autofillEl.hide()}},{key:"showClipboard",value:function(){this.clipboardEl.show()}},{key:"hideClipboard",value:function(){this.clipboardEl.hide()}}]),t}();function Ft(t){var e=this.data,n=t.left,r=t.top,i=t.width,o=t.height,a=t.scroll,l=t.l,s=t.t,c=e.freezeTotalWidth(),u=e.freezeTotalHeight(),f=e.displayRight2Left?n:n-c;c>l&&(e.displayRight2Left||(f-=a.x));var h=r-u;return u>s&&(h-=a.y),{left:f,top:h,width:i,height:o}}function Mt(t){var e=this.data,n=t.left,r=t.width,i=t.height,o=t.l,a=t.t,l=t.scroll,s=e.freezeTotalWidth(),c=e.displayRight2Left?n:n-s;return s>o&&(e.displayRight2Left||(c-=l.x)),{left:c,top:a,width:r,height:i}}function Ht(t){var e=this.data,n=t.top,r=t.width,i=t.height,o=t.l,a=t.t,l=t.scroll,s=e.freezeTotalHeight(),c=n-s;return s>a&&(c-=l.y),{left:o,top:c,width:r,height:i}}function Lt(t){this.br.setAreaOffset(Ft.call(this,t))}function Vt(t){this.t.setAreaOffset(Mt.call(this,t))}function qt(t){this.l.setAreaOffset(Ht.call(this,t))}function Bt(t){this.l.setClipboardOffset(Ht.call(this,t))}function Ut(t){this.br.setClipboardOffset(Ft.call(this,t))}function $t(t){this.t.setClipboardOffset(Mt.call(this,t))}function Xt(t){Lt.call(this,t),function(t){this.tl.setAreaOffset(t)}.call(this,t),Vt.call(this,t),qt.call(this,t)}function Yt(t){Ut.call(this,t),function(t){this.tl.setClipboardOffset(t)}.call(this,t),$t.call(this,t),Bt.call(this,t)}var Zt=function(){function t(e){var n=this;Dt(this,t),this.inputChange=function(){},this.data=e,this.br=new Wt(!0),this.t=new Wt,this.l=new Wt,this.tl=new Wt,this.br.inputChange=function(t){n.inputChange(t)},this.br.el.show(),this.offset=null,this.areaOffset=null,this.indexes=null,this.range=null,this.arange=null,this.el=a("div","".concat(at,"-selectors")).children(this.tl.el,this.t.el,this.l.el,this.br.el).hide(),this.lastri=-1,this.lastci=-1,Nt+=1}return zt(t,[{key:"resetData",value:function(t){this.data=t,this.range=t.selector.range,this.resetAreaOffset()}},{key:"hide",value:function(){this.el.hide()}},{key:"resetOffset",value:function(){var t=this.data,e=this.tl,n=this.t,r=this.l,i=this.br,o=t.freezeTotalHeight(),a=t.freezeTotalWidth();o>0||a>0?(e.setOffset({width:a,height:o}),n.setOffset({left:a,height:o}),r.setOffset({top:o,width:a}),i.setOffset({left:a,top:o})):(e.hide(),n.hide(),r.hide(),i.setOffset({left:0,top:0}))}},{key:"resetAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Xt.call(this,t),Yt.call(this,e),this.resetOffset()}},{key:"resetBRTAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Lt.call(this,t),Vt.call(this,t),Ut.call(this,e),$t.call(this,e),this.resetOffset()}},{key:"resetBRLAreaOffset",value:function(){var t=this.data.getSelectedRect(),e=this.data.getClipboardRect();Lt.call(this,t),qt.call(this,t),Ut.call(this,e),Bt.call(this,e),this.resetOffset()}},{key:"set",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=r.calSelectedRangeByStart(t,e),o=i.sri,a=i.sci;if(n){var l=t,s=e;t<0&&(l=0),e<0&&(s=0),r.selector.setIndexes(l,s),this.indexes=[l,s]}this.moveIndexes=[o,a],this.range=i,this.resetAreaOffset(),this.el.show()}},{key:"setEnd",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.data,i=this.lastri,o=this.lastci;if(n){if(t===i&&e===o)return;this.lastri=t,this.lastci=e}this.range=r.calSelectedRangeByEnd(t,e),Xt.call(this,this.data.getSelectedRect())}},{key:"reset",value:function(){var t=this.data.selector.range,e=t.eri,n=t.eci;this.setEnd(e,n)}},{key:"showAutofill",value:function(t,e){if(-1!==t||-1!==e){var n=this.range,r=n.sri,i=n.sci,o=n.eri,a=n.eci,l=t,s=e,c=r-t,u=o-t,f=a-e;if(i-e>0)this.arange=new y(r,s,o,i-1);else if(c>0)this.arange=new y(l,i,r-1,a);else if(f<0)this.arange=new y(r,a+1,o,s);else{if(!(u<0))return void(this.arange=null);this.arange=new y(o+1,i,l,a)}if(null!==this.arange){var h=this.data.getRect(this.arange);h.width+=2,h.height+=2;var d=this.br,p=this.l,v=this.t,b=this.tl;d.showAutofill(Ft.call(this,h)),p.showAutofill(Ht.call(this,h)),v.showAutofill(Mt.call(this,h)),b.showAutofill(h)}}}},{key:"hideAutofill",value:function(){var t=this;["br","l","t","tl"].forEach(function(e){t[e].hideAutofill()})}},{key:"showClipboard",value:function(){var t=this,e=this.data.getClipboardRect();Yt.call(this,e),["br","l","t","tl"].forEach(function(e){t[e].showClipboard()})}},{key:"hideClipboard",value:function(){var t=this;["br","l","t","tl"].forEach(function(e){t[e].hideClipboard()})}}]),t}();function Gt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Jt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Kt(t){t.preventDefault();var e=this.filterItems;e.length<=0||(t.stopPropagation(),this.itemIndex<0&&(this.itemIndex=0),e[this.itemIndex].el.click(),this.hide())}var Qt=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"200px";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterItems=[],this.items=e,this.el=a("div","".concat(at,"-suggest")).css("width",r).hide(),this.itemClick=n,this.itemIndex=-1}var e,n,r;return e=t,(n=[{key:"setOffset",value:function(t){this.el.cssRemoveKeys("top","bottom").offset(t)}},{key:"hide",value:function(){var t=this.el;this.filterItems=[],this.itemIndex=-1,t.hide(),Et(this.el.parent())}},{key:"setItems",value:function(t){this.items=t}},{key:"search",value:function(t){var e,n=this,r=this.items;if(/^\s*$/.test(t)||(r=r.filter(function(e){return(e.key||e).startsWith(t.toUpperCase())})),r=r.map(function(t){var e=t.title;e?"function"==typeof e&&(e=e()):e=t;var r=a("div","".concat(at,"-item")).child(e).on("click.stop",function(){n.itemClick(t),n.hide()});return t.label&&r.child(a("div","label").html(t.label)),r}),this.filterItems=r,!(r.length<=0)){var i=this.el;(e=i.html("")).children.apply(e,Gt(r)).show(),Ct(i.parent(),function(){n.hide()})}}},{key:"bindInputEvents",value:function(t,e){var n=this;t.on("keydown",function(t){return function(t,e){e.focusing=!0;var n=t.keyCode;switch(t.ctrlKey&&t.stopPropagation(),n){case 37:t.stopPropagation();break;case 38:(function(t){t.preventDefault(),t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex-=1,this.itemIndex<0&&(this.itemIndex=e.length-1),e[this.itemIndex].toggle())}).call(this,t);break;case 39:t.stopPropagation();break;case 40:(function(t){t.stopPropagation();var e=this.filterItems;e.length<=0||(this.itemIndex>=0&&e[this.itemIndex].toggle(),this.itemIndex+=1,this.itemIndex>e.length-1&&(this.itemIndex=0),e[this.itemIndex].toggle())}).call(this,t);break;case 13:case 9:Kt.call(this,t);break;default:t.stopPropagation()}}.call(n,t,e)})}}])&&Jt(e.prototype,n),r&&Jt(e,r),t}();function te(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ee(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ne(t,e){t.setMonth(t.getMonth()+e)}function re(t,e){var n=new Date(t);return n.setDate(e-t.getDay()+1),n}var ie=function(){function t(e){var n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,this.cvalue=new Date(e),this.headerLeftEl=a("div","calendar-header-left"),this.bodyEl=a("tbody",""),this.buildAll(),this.el=a("div","x-spreadsheet-calendar").children(a("div","calendar-header").children(this.headerLeftEl,a("div","calendar-header-right").children(a("a","calendar-prev").on("click.stop",function(){return r.prev()}).child(new ht("chevron-left")),a("a","calendar-next").on("click.stop",function(){return r.next()}).child(new ht("chevron-right")))),a("table","calendar-body").children(a("thead","").child((n=a("tr","")).children.apply(n,te(B("calendar.weeks").map(function(t){return a("th","cell").child(t)})))),this.bodyEl)),this.selectChange=function(){}}var e,n,r;return e=t,(n=[{key:"setValue",value:function(t){this.value=t,this.cvalue=new Date(t),this.buildAll()}},{key:"prev",value:function(){ne(this.value,-1),this.buildAll()}},{key:"next",value:function(){ne(this.value,1),this.buildAll()}},{key:"buildAll",value:function(){this.buildHeaderLeft(),this.buildBody()}},{key:"buildHeaderLeft",value:function(){var t=this.value;this.headerLeftEl.html("".concat(B("calendar.months")[t.getMonth()]," ").concat(t.getFullYear()))}},{key:"buildBody",value:function(){var t,e=this,n=this.value,r=this.cvalue,i=this.bodyEl,o=function(t,e,n){for(var r=new Date(t,e,1,23,59,59),i=[[],[],[],[],[],[]],o=0;o<6;o+=1)for(var a=0;a<7;a+=1){var l=re(r,7*o+a),s=l.getMonth()!==e,c=l.getMonth()===n.getMonth()&&l.getDate()===n.getDate();i[o][a]={d:l,disabled:s,active:c}}return i}(n.getFullYear(),n.getMonth(),r).map(function(t){var n,r=t.map(function(t){var n="cell";return t.disabled&&(n+=" disabled"),t.active&&(n+=" active"),a("td","").child(a("div",n).on("click.stop",function(){e.selectChange(t.d)}).child(t.d.getDate().toString()))});return(n=a("tr","")).children.apply(n,te(r))});(t=i.html("")).children.apply(t,te(o))}}])&&ee(e.prototype,n),r&&ee(e,r),t}();function oe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ae=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calendar=new ie(new Date),this.el=a("div","".concat(at,"-datepicker")).child(this.calendar.el).hide()}var e,n,r;return e=t,(n=[{key:"setValue",value:function(t){var e=this.calendar;return"string"==typeof t?/^\d{4}-\d{1,2}-\d{1,2}$/.test(t)&&e.setValue(new Date(t.replace(new RegExp("-","g"),"/"))):t instanceof Date&&e.setValue(t),this}},{key:"change",value:function(t){var e=this;this.calendar.selectChange=function(n){t(n),e.hide()}}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&oe(e.prototype,n),r&&oe(e,r),t}();function le(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function se(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ce(){var t=this.inputText;if(!/^\s*$/.test(t)){var e=this.textlineEl,n=this.textEl,r=this.areaOffset,i=t.split("\n"),o=Math.max.apply(Math,se(i.map(function(t){return t.length}))),a=e.offset().width/t.length,l=(o+1)*a+5,s=this.viewFn().width-r.left-a,c=i.length;if(l>r.width){var u=l;l>s&&(u=s,c+=parseInt(l/s,10),c+=l%s>0?1:0),n.css("width","".concat(u,"px"))}(c*=this.rowHeight)>r.height&&n.css("height","".concat(c,"px"))}}function ue(t){var e=t.keyCode,n=t.altKey;13!==e&&9!==e&&t.stopPropagation(),13===e&&n&&(function(t,e){var n=t.target,r=n.value,i=n.selectionEnd,o="".concat(r.slice(0,i)).concat(e).concat(r.slice(i));n.value=o,n.setSelectionRange(i+1,i+1),this.inputText=o,this.textlineEl.html(o),ce.call(this)}.call(this,t,"\n"),t.stopPropagation()),13!==e||n||t.preventDefault()}function fe(t,e,n){var r=this.textEl,i=this.textlineEl;r.el.blur(),r.val(t),i.html(t),function(t,e){var n=this.textEl.el;setTimeout(function(){e&&n.focus(),n.setSelectionRange(t,t)},0)}.call(this,e,n)}var he=function(){function t(e,n,r,i){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.viewFn=n,this.rowHeight=r,this.formulas=e,this.suggest=new Qt(e,function(t){(function(t,e){var n=this.inputText,r=this.validator,i=0;if(r&&"list"===r.type)this.inputText=t,i=this.inputText.length;else{var o=n.lastIndexOf("="),a=n.substring(0,o+1),l=n.substring(o+1);l=-1!==l.indexOf(")")?l.substring(l.indexOf(")")):"",this.inputText="".concat(a+t.key,"("),i=this.inputText.length,this.inputText+=")".concat(l)}fe.call(this,this.inputText,i,e)}).call(o,t,!0)}),this.datepicker=new ae,this.datepicker.change(function(t){o.setText(function(t){var e=t.getMonth()+1,n=t.getDate();return e<10&&(e="0".concat(e)),n<10&&(n="0".concat(n)),"".concat(t.getFullYear(),"-").concat(e,"-").concat(n)}(t)),o.clear()}),this.areaEl=a("div","".concat(at,"-editor-area")).children(this.textEl=a("textarea","").on("input",function(t){return function(t){var e=t.target.value,n=this.suggest,r=this.textlineEl,i=this.validator,o=this.cell;if(null!==o)if("editable"in o&&!0===o.editable||void 0===o.editable){if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var a=e.lastIndexOf("=");-1!==a?n.search(e.substring(a+1)):n.hide()}r.html(e),ce.call(this),this.change("input",e)}else t.target.value="";else{if(this.inputText=e,i)"list"===i.type?n.search(e):n.hide();else{var l=e.lastIndexOf("=");-1!==l?n.search(e.substring(l+1)):n.hide()}r.html(e),ce.call(this),this.change("input",e)}}.call(o,t)}).on("paste.stop",function(){}).on("keydown",function(t){return ue.call(o,t)}),this.textlineEl=a("div","textline"),this.suggest.el,this.datepicker.el).on("mousemove.stop",function(){}).on("mousedown.stop",function(){}),this.el=a("div","".concat(at,"-editor")).child(this.areaEl).hide(),this.suggest.bindInputEvents(this.textEl,i),this.areaOffset=null,this.freeze={w:0,h:0},this.cell=null,this.inputText="",this.change=function(){}}var e,n,r;return e=t,(n=[{key:"setFreezeLengths",value:function(t,e){this.freeze.w=t,this.freeze.h=e}},{key:"clear",value:function(){""!==this.inputText&&this.change("finished",this.inputText),this.cell=null,this.areaOffset=null,this.inputText="",this.el.hide(),this.textEl.val(""),this.textlineEl.html(""),function(){this.suggest.setItems(this.formulas)}.call(this),this.datepicker.hide()}},{key:"setOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top",n=this.textEl,r=this.areaEl,i=this.suggest,o=this.freeze,a=this.el;if(t){this.areaOffset=t;var l=t.left,s=t.top,c=t.width,u=t.height,f=t.l,h=t.t,d={left:0,top:0};o.w>f&&o.h>h||(o.w<f&&o.h<h?(d.left=o.w,d.top=o.h):o.w>f?d.top=o.h:o.h>h&&(d.left=o.w)),a.offset(d),r.offset({left:l-d.left-.8,top:s-d.top-.8}),n.offset({width:c-9+.8,height:u-3+.8});var p={left:0};p[e]=u,i.setOffset(p),i.hide()}}},{key:"setCell",value:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.el,i=this.datepicker,o=this.suggest;r.show(),this.cell=t;var a=t&&t.text||"";if(t&&(t.f?a=t.f:t.ufv&&(a=t.ufv)),this.setText(a,n),this.validator=e,e){var l=e.type;"date"===l&&(i.show(),/^\s*$/.test(a)||i.setValue(a)),"list"===l&&(o.setItems(e.values()),o.search(""))}}},{key:"setText",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.inputText=t,fe.call(this,t,t.length,e),ce.call(this)}}])&&le(e.prototype,n),r&&le(e,r),t}();function de(t){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pe(t,e){return!e||"object"!==de(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ve(t){return(ve=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ye(t,e){return(ye=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var be=function(t){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(n=pe(this,ve(e).call(this,"div","".concat(at,"-button ").concat(r)))).child(B("button.".concat(t))),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ye(t,e)}(e,o),e}();function ge(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function me(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function we(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ke(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Oe(t,e,n){return e&&ke(t.prototype,e),n&&ke(t,n),t}function Se(){return window.devicePixelRatio||1}function xe(){return Se()-.5}function Ee(t){return parseInt(t*Se(),10)}function Ce(t){var e=Ee(t);return e>0?e-.5:.5}var _e=function(){function t(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;we(this,t),this.x=e,this.y=n,this.width=r,this.height=i,this.padding=o,this.bgcolor="#ffffff",this.borderTop=null,this.borderRight=null,this.borderBottom=null,this.borderLeft=null,this.pbgcolor=null,this.pattern=null}return Oe(t,[{key:"setBorders",value:function(t){var e=t.top,n=t.bottom,r=t.left,i=t.right;e&&(this.borderTop=e),i&&(this.borderRight=i),n&&(this.borderBottom=n),r&&(this.borderLeft=r)}},{key:"setPattern",value:function(t){t&&(this.pattern=t)}},{key:"innerWidth",value:function(){return this.width-2*this.padding-2}},{key:"innerHeight",value:function(){return this.height-2*this.padding-2}},{key:"textx",value:function(t){var e=this.width,n=this.padding,r=this.x;return"left"===t?r+=n:"center"===t?r+=e/2:"right"===t&&(r+=e-n),r}},{key:"texty",value:function(t,e){var n=this.height,r=this.padding,i=this.y;return"top"===t?i+=r:"middle"===t?i+=n/2-e/2:"bottom"===t&&(i+=n-r-e),i}},{key:"topxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t+this.width,e]]}},{key:"rightxys",value:function(){var t=this.x,e=this.y,n=this.width;return[[t+n,e],[t+n,e+this.height]]}},{key:"bottomxys",value:function(){var t=this.x,e=this.y,n=this.width,r=this.height;return[[t,e+r],[t+n,e+r]]}},{key:"leftxys",value:function(){var t=this.x,e=this.y;return[[t,e],[t,e+this.height]]}}]),t}();function je(t,e,n,r,i,o,a){var l={x:0,y:0};"underline"===t?l.y="bottom"===i?0:"top"===i?-(o+2):-o/2:"strike"===t&&("bottom"===i?l.y=o/2:"top"===i&&(l.y=-(o/2+2))),"center"===r?l.x=a/2:"right"===r&&(l.x=a),this.line([e-l.x,n-l.y],[e-l.x+a,n-l.y])}function Te(t,e,n,r,i,o){for(var a=n;a<i;a+=o)t.moveTo(e,a),t.lineTo(r,a)}function Pe(t,e,n,r,i,o){for(var a=e;a<r;a+=o)t.moveTo(a,n),t.lineTo(a,i)}function Ae(t,e,n,r,i,o){for(var a=e,l=a+o;l<=r;l+=o)t.moveTo(l,i),t.lineTo(a,n),a+=o}function Re(t,e,n,r,i,o){for(var a=e,l=a+o;l<=r;l+=o)t.moveTo(a,i),t.lineTo(l,n),a+=o}function De(t,e,n,r,i,o){for(var a=n;a<i;a+=o)t.moveTo(e,a),t.lineTo(r,a)}var Ie=function(){function t(e,n,r){we(this,t),this.el=e,this.ctx=e.getContext("2d"),this.resize(n,r),this.ctx.scale(Se(),Se())}return Oe(t,[{key:"resize",value:function(t,e){this.el.style.width="".concat(t,"px"),this.el.style.height="".concat(e,"px"),this.el.width=Ee(t),this.el.height=Ee(e)}},{key:"clear",value:function(){var t=this.el,e=t.width,n=t.height;return this.ctx.clearRect(0,0,e,n),this}},{key:"attr",value:function(t){return Object.assign(this.ctx,t),this}},{key:"save",value:function(){return this.ctx.save(),this.ctx.beginPath(),this}},{key:"restore",value:function(){return this.ctx.restore(),this}},{key:"beginPath",value:function(){return this.ctx.beginPath(),this}},{key:"translate",value:function(t,e){return this.ctx.translate(Ee(t),Ee(e)),this}},{key:"scale",value:function(t,e){return this.ctx.scale(t,e),this}},{key:"clearRect",value:function(t,e,n,r){return this.ctx.clearRect(t,e,n,r),this}},{key:"fillRect",value:function(t,e,n,r){return this.ctx.fillRect(Ee(t)-.5,Ee(e)-.5,Ee(n),Ee(r)),this}},{key:"fillText",value:function(t,e,n){return this.ctx.fillText(t,Ee(e),Ee(n)),this}},{key:"text",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this.ctx,a=r.align,l=r.valign,s=r.font,c=r.color,u=r.strike,f=r.underline,h=e.textx(a);o.save(),o.beginPath(),this.attr({textAlign:a,textBaseline:l,font:"".concat(s.italic?"italic":""," ").concat(s.bold?"bold":""," ").concat(Ee(s.size),"px ").concat(s.name),fillStyle:c,strokeStyle:c});var d="".concat(t).split("\n"),p=e.exttxtwidth?e.exttxtwidth+e.innerWidth():e.innerWidth(),v=[];d.forEach(function(t){var e=o.measureText(t).width;if(i&&e>Ee(p)){for(var n={w:0,len:0,start:0},r=0;r<t.length;r+=1)n.w>=Ee(p)&&(v.push(t.substr(n.start,n.len)),n={w:0,len:0,start:r}),n.len+=1,n.w+=o.measureText(t[r]).width+1;n.len>0&&v.push(t.substr(n.start,n.len))}else v.push(t)});var y=(v.length-1)*(s.size+2),b=e.texty(l,y);return v.forEach(function(t){var e=o.measureText(t).width;n.fillText(t,h,b),u&&je.call(n,"strike",h,b,a,l,s.size,e),f&&je.call(n,"underline",h,b,a,l,s.size,e),b+=s.size+2}),o.restore(),this}},{key:"border",value:function(t,e){var n=this.ctx;return n.lineWidth=xe,n.strokeStyle=e,"medium"===t?n.lineWidth=Ee(2)-.5:"thick"===t?n.lineWidth=Ee(3):"dashed"===t?n.setLineDash([Ee(3),Ee(2)]):"dotted"===t?n.setLineDash([Ee(1),Ee(1)]):"double"===t&&n.setLineDash([Ee(2),0]),this}},{key:"line",value:function(){var t=this.ctx;if(arguments.length>1){t.beginPath();var e=arguments.length<=0?void 0:arguments[0],n=me(e,2),r=n[0],i=n[1];t.moveTo(Ce(r),Ce(i));for(var o=1;o<arguments.length;o+=1){var a=o<0||arguments.length<=o?void 0:arguments[o],l=me(a,2),s=l[0],c=l[1];t.lineTo(Ce(s),Ce(c))}t.stroke()}return this}},{key:"strokeBorders",value:function(t){var e=this.ctx;e.save();var n=t.borderTop,r=t.borderRight,i=t.borderBottom,o=t.borderLeft;n&&(this.border.apply(this,ge(n)),this.line.apply(this,ge(t.topxys()))),r&&(this.border.apply(this,ge(r)),this.line.apply(this,ge(t.rightxys()))),i&&(this.border.apply(this,ge(i)),this.line.apply(this,ge(t.bottomxys()))),o&&(this.border.apply(this,ge(o)),this.line.apply(this,ge(t.leftxys()))),e.restore()}},{key:"strokePattern",value:function(t){var e=this.ctx;e.save();var n=t.x,r=t.y,i=t.width,o=t.height,a=t.pattern;if(a){e.beginPath();var l=Ce(n),s=l+Ee(i),c=Ce(r),u=c+Ee(o);switch(a){case"None":case"Solid":break;case"HorizontalStripe":e.lineWidth=2,e.setLineDash([]),Te(e,l,c,s,u,4);break;case"ThinHorizontalStripe":e.lineWidth=1,e.setLineDash([]),Te(e,l,c,s,u,4);break;case"Gray75":e.lineWidth=2,e.setLineDash([2]),De(e,l,c,s,u,3);break;case"VerticalStripe":e.lineWidth=2,e.setLineDash([]),Pe(e,l,c,s,u,4);break;case"ThinVerticalStripe":e.lineWidth=1,e.setLineDash([]),Pe(e,l,c,s,u,4);break;case"Gray50":e.lineWidth=2,e.setLineDash([2]),De(e,l,c,s,u,3.5);break;case"ReverseDiagonalStripe":e.lineWidth=2,e.setLineDash([]),Ae(e,l,c,s,u,4);break;case"ThinReverseDiagonalStripe":e.lineWidth=1,e.setLineDash([]),Ae(e,l,c,s,u,4);break;case"Gray25":e.lineWidth=2,e.setLineDash([2]),De(e,l,c,s,u,4);break;case"DiagonalStripe":e.lineWidth=2,e.setLineDash([]),Re(e,l,c,s,u,4);break;case"ThinDiagonalStripe":e.lineWidth=1,e.setLineDash([]),Re(e,l,c,s,u,4);break;case"Gray12":e.lineWidth=2,e.setLineDash([2]),De(e,l,c,s,u,4.5);break;case"DiagonalCrosshatch":e.lineWidth=1.5,e.setLineDash([]),Ae(e,l,c,s,u,4),Re(e,l,c,s,u,4);break;case"ThinHorizontalCrosshatch":e.lineWidth=1,e.setLineDash([]),Te(e,l,c,s,u,4),Pe(e,l,c,s,u,4);break;case"Gray6":e.lineWidth=2,e.setLineDash([2]),De(e,l,c,s,u,5);break;case"ThickDiagonalCrosshatch":e.lineWidth=2,e.setLineDash([]),Ae(e,l,c,s,u,4),Re(e,l,c,s,u,4);break;case"ThinDiagonalCrosshatch":e.lineWidth=1,e.setLineDash([]),Ae(e,l,c,s,u,4),Re(e,l,c,s,u,4)}e.closePath(),e.stroke()}e.restore()}},{key:"dropdown",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-15,o=r+t.height-15;e.save(),e.beginPath(),e.moveTo(Ee(i),Ee(o)),e.lineTo(Ee(i+8),Ee(o)),e.lineTo(Ee(i+4),Ee(o+6)),e.closePath(),e.fillStyle="rgba(0, 0, 0, .45)",e.fill(),e.restore()}},{key:"error",value:function(t,e){var n=this.ctx,r=t.x,i=t.y,o=t.width,a=r+o-1;n.save(),n.beginPath(),e?(n.moveTo(Ee(a-o+8),Ee(i-1)),n.lineTo(Ee(a-o),Ee(i-1)),n.lineTo(Ee(a-o),Ee(i+8))):(n.moveTo(Ee(a-8),Ee(i-1)),n.lineTo(Ee(a),Ee(i-1)),n.lineTo(Ee(a),Ee(i+8))),n.closePath(),n.fillStyle="rgba(255, 0, 0, .65)",n.fill(),n.restore()}},{key:"frozen",value:function(t){var e=this.ctx,n=t.x,r=t.y,i=n+t.width-1;e.save(),e.beginPath(),e.moveTo(Ee(i-8),Ee(r-1)),e.lineTo(Ee(i),Ee(r-1)),e.lineTo(Ee(i),Ee(r+8)),e.closePath(),e.fillStyle="rgba(0, 255, 0, .85)",e.fill(),e.restore()}},{key:"rect",value:function(t,e){var n=this.ctx,r=t.x,i=t.y,o=t.width,a=t.height,l=t.bgcolor,s=t.pbgcolor,c=t.exttxtwidthR,u=t.exttxtwidthL;if(n.save(),n.beginPath(),n.fillStyle=void 0!==l?l:void 0!==s?s:"#ffffff",n.rect(Ce(r+1),Ce(i+1),Ee(o-2),Ee(a-2)),n.clip(),n.fill(),void 0!==c||void 0!==u){var f=void 0===c?0:c,h=void 0===u?0:u;n.restore(),n.save(),n.rect(Ce(r+1-h),Ce(i+1),Ee(o+f+h-2),Ee(a-2)),n.clip(),e(),n.restore()}else e(),n.restore()}}]),t}(),ze=[{key:"Arial",title:"Arial"},{key:"Arial Black",title:"Arial Black"},{key:"Comic Sans",title:"Comic Sans"},{key:"Comic Sans MS",title:"Comic Sans MS"},{key:"Courier New",title:"Courier New"},{key:"Georgia",title:"Georgia"},{key:"Impact",title:"Impact"},{key:"Lucida Console",title:"Lucida Console"},{key:"Lucida Sans",title:"Lucida Sans"},{key:"Palatino",title:"Palatino"},{key:"Tahoma",title:"Tahoma"},{key:"Times New Roman",title:"Times New Roman"},{key:"Trebuchet",title:"Trebuchet"},{key:"Verdana",title:"Verdana"},{key:"Lato",title:"Lato"},{key:"Helvetica",title:"Helvetica"},{key:"Source Sans Pro",title:"Source Sans Pro"}],Ne=[{pt:7.5,px:10},{pt:8,px:11},{pt:9,px:12},{pt:10,px:13},{pt:10.5,px:14},{pt:11,px:15},{pt:12,px:16},{pt:14,px:18.7},{pt:15,px:20},{pt:16,px:21.3},{pt:18,px:24},{pt:22,px:29.3},{pt:24,px:32},{pt:26,px:34.7},{pt:36,px:48},{pt:42,px:56}];function We(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Fe=function(t){for(var e=[],n=[],r=[],i=0,o="",a=1,l="",s=0;s<t.length;s+=1){var c=t.charAt(s);if(" "!==c){if(c>="a"&&c<="z")r.push(c.toUpperCase());else if(c>="0"&&c<="9"||c>="A"&&c<="Z"||"."===c)r.push(c);else if('"'===c){for(s+=1;'"'!==t.charAt(s);)r.push(t.charAt(s)),s+=1;n.push('"'.concat(r.join(""))),r=[]}else if("-"===c&&/[+\-*/,(]/.test(l))r.push(c);else{if("("!==c&&r.length>0&&n.push(r.join("")),")"===c){var u=e.pop();if(2===i)try{for(var d=We(f(n.pop()),2),p=d[0],v=d[1],y=We(f(n.pop()),2),b=y[0],g=y[1],m=0,w=b;w<=p;w+=1)for(var k=g;k<=v;k+=1)n.push(h(w,k)),m+=1;n.push([u,m])}catch(t){}else if(1===i||3===i)3===i&&n.push(o),n.push([u,a]),a=1;else for(;"("!==u&&(n.push(u),!(e.length<=0));)u=e.pop();i=0}else if("="===c||">"===c||"<"===c){var O=t.charAt(s+1);o=c,"="!==O&&"-"!==O||(o+=O,s+=1),i=3}else if(":"===c)i=2;else if(","===c)3===i&&n.push(o),i=1,a+=1;else if("("===c&&r.length>0)e.push(r.join(""));else{if(e.length>0&&("+"===c||"-"===c)){var S=e[e.length-1];if("("!==S&&n.push(e.pop()),"*"===S||"/"===S)for(;e.length>0&&"("!==(S=e[e.length-1]);)n.push(e.pop())}e.push(c)}r=[]}l=c}}for(r.length>0&&n.push(r.join(""));e.length>0;)n.push(e.pop());return n},Me=function(t,e){var n=We(t,1)[0],r=t;if('"'===n)return t.substring(1);var i=1;if("-"===n&&(r=t.substring(1),i=-1),r[0]>="0"&&r[0]<="9")return i*Number(r);var o=We(f(r),2);return i*e(o[0],o[1])},He=function(t,e,n,r){for(var i=[],o=0;o<t.length;o+=1){var a=t[o],l=a[0];if("+"===a){var s=i.pop();i.push(I("+",i.pop(),s))}else if("-"===a)if(1===i.length){var c=i.pop();i.push(I("*",c,-1))}else{var u=i.pop();i.push(I("-",i.pop(),u))}else if("*"===a)i.push(I("*",i.pop(),i.pop()));else if("/"===a){var f=i.pop();i.push(I("/",i.pop(),f))}else if("="===l||">"===l||"<"===l){var h=i.pop();Number.isNaN(h)||(h=Number(h));var d=i.pop();Number.isNaN(d)||(d=Number(d));var p=!1;"="===l?p=d===h:">"===a?p=d>h:">="===a?p=d>=h:"<"===a?p=d<h:"<="===a&&(p=d<=h),i.push(p)}else if(Array.isArray(a)){for(var v=We(a,2),y=v[0],b=v[1],g=[],m=0;m<b;m+=1)g.push(i.pop());i.push(e[y].render(g.reverse()))}else{if(r.includes(a))return 0;(l>="a"&&l<="z"||l>="A"&&l<="Z")&&r.push(a),i.push(Me(a,n)),r.pop()}}return i[0]},Le={render:function t(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if("="===e[0]){var o=Fe(e.substring(1));return o.length<=0?e:He(o,n,function(e,o){return t(r(e,o),n,r,i)},i)}return e}};function Ve(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function qe(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Be=[{key:"SUM",title:U("formula.sum"),render:function(t){return t.reduce(function(t,e){return I("+",t,e)},0)}},{key:"AVERAGE",title:U("formula.average"),render:function(t){return t.reduce(function(t,e){return Number(t)+Number(e)},0)/t.length}},{key:"MAX",title:U("formula.max"),render:function(t){return Math.max.apply(Math,qe(t.map(function(t){return Number(t)})))}},{key:"MIN",title:U("formula.min"),render:function(t){return Math.min.apply(Math,qe(t.map(function(t){return Number(t)})))}},{key:"IF",title:U("formula._if"),render:function(t){var e=Ve(t,3),n=e[0],r=e[1],i=e[2];return n?r:i}},{key:"AND",title:U("formula.and"),render:function(t){return t.every(function(t){return t})}},{key:"OR",title:U("formula.or"),render:function(t){return t.some(function(t){return t})}},{key:"CONCAT",title:U("formula.concat"),render:function(t){return t.join("")}}],Ue=Be,$e={};function Xe(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||Ze(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ye(t){return function(t){if(Array.isArray(t))return t}(t)||Ze(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ze(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}Be.forEach(function(t){$e[t.key]=t});var Ge=function(t){return t},Je=function(t){if(/^(-?\d*.?\d*)$/.test(t)){var e=Ye(Number(t).toFixed(2).toString().split("\\.")),n=e[0],r=e.slice(1);return[n.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")].concat(Xe(r))}return t},Ke=[{key:"normal",title:U("format.normal"),type:"string",render:Ge},{key:"text",title:U("format.text"),type:"string",render:Ge},{key:"number",title:U("format.number"),type:"number",label:"1,000.12",render:Je},{key:"percent",title:U("format.percent"),type:"number",label:"10.12%",render:function(t){return"".concat(t,"%")}},{key:"rmb",title:U("format.rmb"),type:"number",label:"￥10.00",render:function(t){return"￥".concat(Je(t))}},{key:"usd",title:U("format.usd"),type:"number",label:"$10.00",render:function(t){return"$".concat(Je(t))}},{key:"eur",title:U("format.eur"),type:"number",label:"€10.00",render:function(t){return"€".concat(Je(t))}},{key:"date",title:U("format.date"),type:"date",label:"26/09/2008",render:Ge},{key:"time",title:U("format.time"),type:"date",label:"15:59:00",render:Ge},{key:"datetime",title:U("format.datetime"),type:"date",label:"26/09/2008 15:59:00",render:Ge},{key:"duration",title:U("format.duration"),type:"date",label:"24:01:00",render:Ge}],Qe={};function tn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function en(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Ke.forEach(function(t){Qe[t.key]=t});var nn=3,rn={fillStyle:"#f4f5f8"},on={fillStyle:"#fff",lineWidth:xe,strokeStyle:"#e6e6e6"};function an(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t.cellRect(e,n),o=i.left,a=i.top,l=i.width,s=i.height;return new _e(o,a+r,l,s,nn)}function ln(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=e.sortedRowMap,a=e.rows,l=e.cols,s=e.viewRangeCache;if(!a.isHide(n)&&!l.isHide(r)){var c=n;o.has(n)&&(c=o.get(n));var u=e.getCell(c,r);if(null!==u){var f=!1;"editable"in u&&!1===u.editable&&(f=!0);var h=e.getCellStyleOrDefault(c,r),d=an(e,c,r,i);d.bgcolor=h.bgcolor,d.pbgcolor=h.pbgcolor,void 0!==h.border&&(d.setBorders(h.border),t.strokeBorders(d));var p=d;if(h.hasbgcolor&&(void 0!==h.border&&void 0!==h.border.borderRight||(p.width+=2),void 0!==h.border&&void 0!==h.border.borderBottom||(p.height+=2)),!h.textwrap&&u.text&&u.text.length>0){var v=0,y=0;if(void 0===h.align||"center"===h.align||"left"===h.align)for(var b=r+1;b<=s.eci;b++){var g=e.getCell(c,b);if(null!==g&&void 0!==g.text&&g.text.length>0)break;v+=l.getWidth(b)}if(h.align&&("center"===h.align||"right"===h.align))for(var m=r-1;m>=s.sci;m--){var w=e.getCell(c,m);if(null!==w&&void 0!==w.text&&w.text.length>0)break;y+=l.getWidth(m)}v>0&&(d.exttxtwidthR=v),y>0&&(d.exttxtwidthL=y)}t.rect(p,function(){var n="";n=e.settings.evalPaused||"server"===e.settings.updateMode?u.text||"":Le.render(u.text||"",$e,function(t,n){return e.getCellTextOrDefault(n,t)}),h.format&&"server"!==e.settings.updateMode&&(n=Qe[h.format].render(n));var i=Object.assign({},h.font);i.size=function(t){for(var e=0;e<Ne.length;e+=1){var n=Ne[e];if(n.pt===t)return n.px}return t}(i.size),t.text(n,d,{align:h.align,valign:h.valign,font:i,color:h.color,strike:h.strike,underline:h.underline},h.textwrap),e.validations.getError(c,r)&&t.error(d),f&&t.frozen(d),void 0!==h.pattern&&(d.setPattern(h.pattern),t.strokePattern(d))})}}}function sn(t,e,n,r){if(r.active()){var i=r.hrange();e.intersects(i)&&i.each(function(e,r){var i=an(t,e,r);n.dropdown(i)})}}function cn(t,e,n,r,i){var o=this.draw,a=this.data;o.save(),a.displayRight2Left?o.translate(-e,n).translate(r,i):o.translate(e,n).translate(r,i),a.comments.forEach(function(e){if(t.sri<=e.row&&t.eri>=e.row&&t.sci<=e.col&&t.eci>=e.col){var n=an(a,e.row,e.col);o.error(n,a.displayRight2Left)}}),o.restore()}function un(t,e,n,r,i){var o=this.draw,a=this.data;o.save(),a.displayRight2Left?o.translate(-e,n).translate(r,i):o.translate(e,n).translate(r,i);var l=a.exceptRowSet;o.save(),o.translate(0,-0),t.emptyFirst(function(t,e){ln(o,a,t,e)},function(t){return function(t){return!l.has(t)}(t)},function(t,e){return a.isEmpty(t,e)}),o.restore();var s=new Set;o.save(),o.translate(0,-0),a.eachMergesInView(t,function(t){var e=t.sri,n=t.sci,r=t.eri;if(l.has(e)){if(!s.has(e)){s.add(e);var i=a.rows.sumHeight(e,r+1);o.translate(0,-i)}}else ln(o,a,e,n)}),o.restore(),function(t){var e=this.data,n=this.draw;if(t){var r=e.autoFilter,i=e.TableAutoFilters;sn(e,t,n,r),i.forEach(function(r){sn(e,t,n,r)})}}.call(this,t),o.restore()}function fn(t,e,n,r){var i=this.draw;i.save(),i.attr({fillStyle:"rgba(75, 137, 255, 0.08)"}).fillRect(t,e,n,r),i.restore()}function hn(t,e,n,r,i,o){var a=this,l=this.draw,s=this.data,u=e.h,f=e.w,h=o+r,d=i+n,p=s.displayRight2Left?s.viewWidth()-n:0;l.save(),l.attr(rn),"all"!==t&&"left"!==t||l.fillRect(p,h,n,u),"all"!==t&&"top"!==t||(s.displayRight2Left?l.fillRect(0,0,f,r):l.fillRect(d,0,f,r));var v=s.selector.range,y=v.sri,b=v.sci,g=v.eri,m=v.eci;if(l.attr({textAlign:"center",textBaseline:"middle",font:"500 ".concat(Ee(12),"px Source Sans Pro"),fillStyle:"#585757",lineWidth:xe(),strokeStyle:"#e6e6e6"}),"all"===t||"left"===t){var w=p;s.rowEach(e.sri,e.eri,function(t,e,r){var i=h+e,o=t;l.line([w,i],[w+n,i]),y<=o&&o<g+1&&fn.call(a,w,i,n,r),l.fillText(o+1,w+n/2,i+r/2),t>0&&s.rows.isHide(t-1)&&(l.save(),l.attr({strokeStyle:"#c6c6c6"}),l.line([w+5,i+5],[w+n-5,i+5]),l.restore())}),l.line([w,u+h],[w+n,u+h]),l.line([w+n,h],[w+n,u+h])}"all"!==t&&"top"!==t||(s.colEach(e.sci,e.eci,function(t,e,n){var i=s.displayRight2Left?s.viewWidth()-(d+e+n):d+e,o=t;l.line([i,0],[i,r]),b<=o&&o<m+1&&fn.call(a,i,0,n,r),l.fillText(c(o),i+n/2,r/2),t>0&&s.cols.isHide(t-1)&&(l.save(),l.attr({strokeStyle:"#c6c6c6"}),l.line([i+5,5],[i+5,r-5]),l.restore())}),l.line([f+d,0],[f+d,r]),l.line([0,r],[f+d,r])),l.restore()}function dn(t,e,n,r,i){var o=t.sri,a=t.sci,l=t.eri,s=t.eci,c=t.w,u=t.h,f=t.clearStartx,h=void 0===f?0:f,d=t.lineStartx,p=void 0===d?0:d,v=this.draw,y=this.data,b=(y.settings,y.displayRight2Left),g=y.scroll;if(v.save(),b?v.attr(on).translate(-(e+r),n+i):v.attr(on).translate(e+r,n+i),v.clearRect(h,0,c,u),y.showGrid){if(b){var m=en(y.freeze,2),w=(m[0],m[1]);w>0&&a>=w&&(c+=g.x),y.rowEach(o,l,function(t,e,n){t!==o&&v.line([p,e],[p+c,e]),t===l&&v.line([p,e+n],[p+c,e+n])})}else y.rowEach(o,l,function(t,e,n){t!==o&&v.line([0,e],[c,e]),t===l&&v.line([0,e+n],[c,e+n])});if(b){var k=y.viewWidth();y.colEach(a,s,function(t,e,n){t!==s&&v.line([k-e-n,0],[k-e-n,u]),t===a&&v.line([k-e,0],[k-e,u])})}else y.colEach(a,s,function(t,e,n){t!==a&&v.line([e,0],[e,u]),t===s&&v.line([e+n,0],[e+n,u])});v.restore()}else v.restore()}var pn=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.draw=new Ie(e,n.viewWidth(),n.viewHeight()),this.data=n}var e,n,r;return e=t,(n=[{key:"resetData",value:function(t){this.data=t,this.render()}},{key:"render",value:function(){var t=this.data;if(!t.isupdating){t.rows;var e=t.cols.indexWidth,n=t.settings.row.height;this.draw.resize(t.viewWidth(),t.viewHeight()),this.clear();var r=t.viewRange(),i=t.freezeTotalWidth(),o=t.freezeTotalHeight(),a=t.scroll,l=a.x,s=a.y;dn.call(this,r,e,n,i,o),un.call(this,r,e,n,-l,-s),cn.call(this,r,e,n,-l,-s),hn.call(this,"all",r,e,n,i,o),function(t,e){var n=this.draw;n.save(),n.attr({fillStyle:"#f4f5f8"}).fillRect(0,0,t,e),n.restore()}.call(this,e,n);var c=en(t.freeze,2),u=c[0],f=c[1];if(u>0||f>0){if(u>0){var h=r.clone();h.sri=0,h.eri=u-1,h.h=o,dn.call(this,h,e,n,i,0),un.call(this,h,e,n,-l,0),cn.call(this,h,e,n,-l,0),hn.call(this,"top",h,e,n,i,0)}if(f>0){var d=r.clone();d.sci=0,d.eci=f-1,d.w=i,d.clearStartx=t.displayRight2Left?this.draw.ctx.canvas.width-i:0,d.lineStartx=t.displayRight2Left?t.viewWidth()-i:0,dn.call(this,d,e,n,0,o),hn.call(this,"left",d,e,n,0,o),un.call(this,d,e,n,0,-s),cn.call(this,d,e,n,0,-s)}var p=t.freezeViewRange();p.clearStartx=t.displayRight2Left?this.draw.ctx.canvas.width-i:0,p.lineStartx=t.displayRight2Left?t.viewWidth()-i:0,dn.call(this,p,e,n,0,0),hn.call(this,"all",p,e,n,0,0),un.call(this,p,e,n,0,0),cn.call(this,p,e,n,0,0),function(t,e,n,r){var i=this.draw,o=this.data,a=o.viewWidth(),l=a-t,s=o.viewHeight()-e;o.displayRight2Left?i.save().translate(-t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}):i.save().translate(t,e).attr({strokeStyle:"rgba(75, 137, 255, .6)"}),o.displayRight2Left?(i.line([0,r],[a,r]),i.line([a-n,0],[a-n,s])):(i.line([0,r],[l,r]),i.line([n,0],[n,s])),i.restore()}.call(this,e,n,i,o)}}}},{key:"clear",value:function(){this.draw.clear()}}])&&tn(e.prototype,n),r&&tn(e,r),t}();function vn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function yn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var bn=[["A3",11.69,16.54],["A4",8.27,11.69],["A5",5.83,8.27],["B4",9.84,13.9],["B5",6.93,9.84]],gn=["landscape","portrait"];function mn(t){return parseInt(96*t,10)}function wn(t){"cancel"===t?this.el.hide():this.toPrint()}var kn=function(){function t(e){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.paper={w:mn(bn[0][1]),h:mn(bn[0][2]),padding:50,orientation:gn[0],get width(){return"landscape"===this.orientation?this.h:this.w},get height(){return"landscape"===this.orientation?this.w:this.h}},this.data=e,this.el=a("div","".concat(at,"-print")).children(a("div","".concat(at,"-print-bar")).children(a("div","-title").child("Print settings"),a("div","-right").children(a("div","".concat(at,"-buttons")).children(new be("cancel").on("click",wn.bind(this,"cancel")),new be("next","primary").on("click",wn.bind(this,"next"))))),a("div","".concat(at,"-print-content")).children(this.contentEl=a("div","-content"),a("div","-sider").child(a("form","").children(a("fieldset","").children(a("label","").child("".concat(B("print.size"))),(n=a("select","")).children.apply(n,vn(bn.map(function(t,e){return a("option","").attr("value",e).child("".concat(t[0]," ( ").concat(t[1],"''x").concat(t[2],"'' )"))}))).on("change",function(t){var e=this.paper,n=t.target.value,r=bn[n];e.w=mn(r[1]),e.h=mn(r[2]),this.preview()}.bind(this))),a("fieldset","").children(a("label","").child("".concat(B("print.orientation"))),(r=a("select","")).children.apply(r,vn(gn.map(function(t,e){return a("option","").attr("value",e).child("".concat(B("print.orientations")[e]))}))).on("change",function(t){var e=this.paper,n=t.target.value,r=gn[n];e.orientation=r,this.preview()}.bind(this))))))).hide()}var e,n,r;return e=t,(n=[{key:"resetData",value:function(t){this.data=t}},{key:"preview",value:function(){var t=this,e=this.data,n=this.paper,r=n.width,i=n.height,o=n.padding,l=r-2*o,s=i-2*o,c=e.contentRange(),u=parseInt(c.h/s,10)+1,f=l/c.w,h=o,d=o;f>1&&(h+=(l-c.w)/2);var p=0,v=0;this.contentEl.html(""),this.canvases=[];for(var y={sri:0,sci:0,eri:0,eci:0},b=function(n){var o=0,l=0,u=a("div","".concat(at,"-canvas-card")),b=a("canvas","".concat(at,"-canvas"));t.canvases.push(b.el);var g=new Ie(b.el,r,i);for(g.save(),g.translate(h,d),f<1&&g.scale(f,f);p<=c.eri;p+=1){var m=e.rows.getHeight(p);if(!((o+=m)<s)){l=-(o-m);break}for(var w=0;w<=c.eci;w+=1)ln(g,e,p,w,v),y.eci=w}y.eri=p,g.restore(),g.save(),g.translate(h,d),f<1&&g.scale(f,f);var k=v;e.eachMergesInView(y,function(t){var n=t.sri,r=t.sci;ln(g,e,n,r,k)}),g.restore(),y.sri=y.eri,y.sci=y.eci,v+=l,t.contentEl.child(a("div","".concat(at,"-canvas-card-wraper")).child(u.child(b)))},g=0;g<u;g+=1)b()}},{key:"toPrint",value:function(){this.el.hide();var t=this.paper,e=a("iframe","").hide().el;window.document.body.appendChild(e);var n=e.contentWindow,r=n.document,i=document.createElement("style");i.innerHTML="\n      @page { size: ".concat(t.width,"px ").concat(t.height,"px; };\n      canvas {\n        page-break-before: auto;\n        page-break-after: always;\n        image-rendering: pixelated;\n      };\n    "),r.head.appendChild(i),this.canvases.forEach(function(t){var e=t.cloneNode(!1);e.getContext("2d").drawImage(t,0,0),r.body.appendChild(e)}),n.print()}}])&&yn(e.prototype,n),r&&yn(e,r),t}();function On(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Sn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var xn=[{key:"copy",title:U("contextmenu.copy"),label:"Ctrl+C"},{key:"cut",title:U("contextmenu.cut"),label:"Ctrl+X"},{key:"paste",title:U("contextmenu.paste"),label:"Ctrl+V"},{key:"paste-value",title:U("contextmenu.pasteValue"),label:"Ctrl+Shift+V"},{key:"paste-format",title:U("contextmenu.pasteFormat"),label:"Ctrl+Alt+V"},{key:"divider"},{key:"insert-row",title:U("contextmenu.insertRow")},{key:"insert-column",title:U("contextmenu.insertColumn")},{key:"divider"},{key:"delete-row",title:U("contextmenu.deleteRow")},{key:"delete-column",title:U("contextmenu.deleteColumn")},{key:"delete-cell-text",title:U("contextmenu.deleteCellText")},{key:"hide",title:U("contextmenu.hide")},{key:"divider"},{key:"validation",title:U("contextmenu.validation")},{key:"divider"},{key:"cell-editable",title:U("contextmenu.celleditable")},{key:"cell-non-editable",title:U("contextmenu.cellnoneditable")}];function En(){var t=this;return xn.map(function(e){return function(t){var e=this;return"divider"===t.key?a("div","".concat(at,"-item divider")):a("div","".concat(at,"-item")).on("click",function(){e.itemClick(t.key),e.hide()}).children(t.title(),a("div","label").child(t.label||""))}.call(t,e)})}var Cn=function(){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.menuItems=En.call(this),this.el=(n=a("div","".concat(at,"-contextmenu"))).children.apply(n,On(this.menuItems)).hide(),this.viewFn=e,this.itemClick=function(){},this.isHide=r,this.setMode("range")}var e,n,r;return e=t,(n=[{key:"setMode",value:function(t){var e=this.menuItems[12];"row-col"===t?e.show():e.hide()}},{key:"hide",value:function(){var t=this.el;t.hide(),Et(t)}},{key:"setPosition",value:function(t,e){if(!this.isHide){var n=this.el,r=n.show().offset(),i=r.width,o=r.height,a=this.viewFn(),l=t;a.width-t<=i&&(l-=i),n.css("left","".concat(l,"px"));var s=e;o+e>a.height&&(s-=o+e-a.height),n.css("top","".concat(s,"px")).css("max-height","".concat(a.height,"px")).css("bottom","auto"),Ct(n)}}}])&&Sn(e.prototype,n),r&&Sn(e,r),t}();function _n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var jn=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tip=B("toolbar.".concat(e.replace(/-[a-z]/g,function(t){return t[1].toUpperCase()}))),this.activeTip=null===n?null:B("toolbar.".concat(n.replace(/-[a-z]/g,function(t){return t[1].toUpperCase()}))),r&&(this.tip+=" (".concat(r,")")),this.tag=e,this.shortcut=r,this.value=i,this.el=this.element(),this.change=function(){}}var e,n,r;return e=t,(n=[{key:"element",value:function(){var t=this.tip,e=this.activeTip;return a("div","".concat(at,"-toolbar-btn")).on("mouseenter",function(n){!function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e.classList.contains("active")||null!==n){var r=e.getBoundingClientRect(),i=r.left,o=r.top,l=r.width,s=r.height,c=e.classList.contains("active")?n:t,u=a("div","".concat(at,"-tooltip")).html(c).show();document.body.appendChild(u.el);var f=u.box();u.css("left","".concat(i+l/2-f.width/2,"px")).css("top","".concat(o+s+2,"px")),St(e,"mouseleave",function(){document.body.contains(u.el)&&document.body.removeChild(u.el)}),St(e,"click",function(){document.body.contains(u.el)&&document.body.removeChild(u.el)})}}(t,n.target,e)}).attr("data-tooltip",t)}},{key:"setState",value:function(){}}])&&_n(e.prototype,n),r&&_n(e,r),t}();function Tn(t){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function An(t,e){return!e||"object"!==Tn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rn(t,e,n){return(Rn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Dn(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Dn(t){return(Dn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function In(t,e){return(In=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var zn=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),An(this,Dn(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&In(t,e)}(e,jn),n=e,(r=[{key:"dropdown",value:function(){}},{key:"getValue",value:function(t){return t}},{key:"element",value:function(){var t=this,n=this.tag;return this.dd=this.dropdown(),this.dd.change=function(e){return t.change(n,t.getValue(e))},Rn(Dn(e.prototype),"element",this).call(this).child(this.dd)}},{key:"setState",value:function(t){t&&(this.value=t,this.dd.setTitle(t))}}])&&Pn(n.prototype,r),i&&Pn(n,i),e}();function Nn(t){return(Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Fn(t,e){return!e||"object"!==Nn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mn(t){return(Mn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hn(t,e){return(Hn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ln=function(t){function e(t,n,r,i){var o,l;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(l=Fn(this,Mn(e).call(this,"div","".concat(at,"-dropdown ").concat(i)))).title=t,l.change=function(){},l.headerClick=function(){},"string"==typeof t?l.title=a("div","".concat(at,"-dropdown-title")).child(t):r&&l.title.addClass("arrow-left"),l.contentEl=a("div","".concat(at,"-dropdown-content")).css("width",n).hide();for(var s=arguments.length,c=new Array(s>4?s-4:0),u=4;u<s;u++)c[u-4]=arguments[u];return(o=l).setContentChildren.apply(o,c),l.headerEl=a("div","".concat(at,"-dropdown-header")),l.headerEl.on("click",function(){"block"!==l.contentEl.css("display")?l.show():l.hide()}).children(l.title,r?a("div","".concat(at,"-icon arrow-right")).child(a("div","".concat(at,"-icon-img arrow-down"))):""),l.children(l.headerEl,l.contentEl),l}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hn(t,e)}(e,o),n=e,(r=[{key:"setContentChildren",value:function(){var t;(this.contentEl.html(""),arguments.length>0)&&(t=this.contentEl).children.apply(t,arguments)}},{key:"setTitle",value:function(t){this.title.html(t),this.hide()}},{key:"show",value:function(){var t=this;this.contentEl.show(),this.parent().active(),Ct(this.parent(),function(){t.hide()})}},{key:"hide",value:function(){this.parent().active(!1),this.contentEl.hide(),Et(this.parent())}}])&&Wn(n.prototype,r),i&&Wn(n,i),e}();function Vn(t){return(Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qn(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Bn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Un(t,e){return!e||"object"!==Vn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $n(t){return($n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xn(t,e){return(Xn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Yn=function(t){function e(t,n){var r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=new ht("align-".concat(n)),l=t.map(function(t){return(e="align-".concat(t),a("div","".concat(at,"-item")).child(new ht(e))).on("click",function(){i.setTitle(t),i.change(t)});var e});return i=Un(this,(r=$n(e)).call.apply(r,[this,o,"auto",!0,"bottom-left"].concat(qn(l))))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xn(t,e)}(e,Ln),n=e,(r=[{key:"setTitle",value:function(t){this.title.setName("align-".concat(t)),this.hide()}}])&&Bn(n.prototype,r),i&&Bn(n,i),e}();function Zn(t){return(Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gn(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Jn(t,e){return!e||"object"!==Zn(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Kn(t){return(Kn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Qn(t,e){return(Qn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var tr=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Jn(this,Kn(e).call(this,"align",null,"",t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qn(t,e)}(e,zn),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new Yn(["left","center","right"],t)}}])&&Gn(n.prototype,r),i&&Gn(n,i),e}();function er(t){return(er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rr(t,e){return!e||"object"!==er(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ir(t){return(ir=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function or(t,e){return(or=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ar=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),rr(this,ir(e).call(this,"valign",null,"",t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&or(t,e)}(e,zn),n=e,(r=[{key:"dropdown",value:function(){var t=this.value;return new Yn(["top","middle","bottom"],t)}}])&&nr(n.prototype,r),i&&nr(n,i),e}();function lr(t){return(lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cr(t,e){return!e||"object"!==lr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ur(t,e,n){return(ur="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=fr(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function fr(t){return(fr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function hr(t,e){return(hr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var dr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),cr(this,fr(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hr(t,e)}(e,jn),n=e,(r=[{key:"element",value:function(){var t=this,n=this.tag;return ur(fr(e.prototype),"element",this).call(this).child(new ht(n)).on("click",function(){return t.click()})}},{key:"click",value:function(){this.change(this.tag,this.toggle())}},{key:"setState",value:function(t){this.el.active(t)}},{key:"toggle",value:function(){return this.el.toggle()}},{key:"active",value:function(){return this.el.hasClass("active")}}])&&sr(n.prototype,r),i&&sr(n,i),e}();function pr(t){return(pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yr(t,e){return!e||"object"!==pr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function br(t){return(br=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gr(t,e){return(gr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var mr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),yr(this,br(e).call(this,"autofilter"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gr(t,e)}(e,dr),n=e,(r=[{key:"setState",value:function(){}}])&&vr(n.prototype,r),i&&vr(n,i),e}();function wr(t){return(wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kr(t,e){return!e||"object"!==wr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Or(t){return(Or=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Sr(t,e){return(Sr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var xr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),kr(this,Or(e).call(this,"font-bold",null,"Ctrl+B"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sr(t,e)}(e,dr),e}();function Er(t){return(Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cr(t,e){return!e||"object"!==Er(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function _r(t){return(_r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function jr(t,e){return(jr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Tr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Cr(this,_r(e).call(this,"font-italic",null,"Ctrl+I"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jr(t,e)}(e,dr),e}();function Pr(t){return(Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ar(t,e){return!e||"object"!==Pr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Rr(t){return(Rr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Dr(t,e){return(Dr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ir=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ar(this,Rr(e).call(this,"strike"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Dr(t,e)}(e,dr),e}();function zr(t){return(zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nr(t,e){return!e||"object"!==zr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Wr(t){return(Wr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fr(t,e){return(Fr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Mr=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Nr(this,Wr(e).call(this,"underline",null,"Ctrl+U"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fr(t,e)}(e,dr),e}();function Hr(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Lr=["#ffffff","#000100","#e7e5e6","#445569","#5b9cd6","#ed7d31","#a5a5a5","#ffc001","#4371c6","#71ae47"],Vr=[["#f2f2f2","#7f7f7f","#d0cecf","#d5dce4","#deeaf6","#fce5d5","#ededed","#fff2cd","#d9e2f3","#e3efd9"],["#d8d8d8","#595959","#afabac","#adb8ca","#bdd7ee","#f7ccac","#dbdbdb","#ffe59a","#b3c6e7","#c5e0b3"],["#bfbfbf","#3f3f3f","#756f6f","#8596b0","#9cc2e6","#f4b184","#c9c9c9","#fed964","#8eaada","#a7d08c"],["#a5a5a5","#262626","#3a3839","#333f4f","#2e75b5","#c45a10","#7b7b7b","#bf8e01","#2f5596","#538136"],["#7f7f7f","#0c0c0c","#171516","#222a35","#1f4e7a","#843c0a","#525252","#7e6000","#203864","#365624"]],qr=["#c00000","#fe0000","#fdc101","#ffff01","#93d051","#00b04e","#01b0f1","#0170c1","#012060","#7030a0"];function Br(t){var e=this;return a("td","").child(a("div","".concat(at,"-color-palette-cell")).on("click.stop",function(){return e.change(t)}).css("background-color",t))}var Ur=function t(){var e,n,r,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=a("div","".concat(at,"-color-palette")),this.change=function(){};var o=a("table","").children((e=a("tbody","")).children.apply(e,[(n=a("tr","".concat(at,"-theme-color-placeholders"))).children.apply(n,Hr(Lr.map(function(t){return Br.call(i,t)})))].concat(Hr(Vr.map(function(t){var e;return(e=a("tr","".concat(at,"-theme-colors"))).children.apply(e,Hr(t.map(function(t){return Br.call(i,t)})))})),[(r=a("tr","".concat(at,"-standard-colors"))).children.apply(r,Hr(qr.map(function(t){return Br.call(i,t)})))])));this.el.child(o)};function $r(t){return($r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xr(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Yr(t,e){return!e||"object"!==$r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zr(t){return(Zr=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gr(t,e){return(Gr=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jr=function(t){function e(t,n){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=new ht(t).css("height","16px").css("border-bottom","3px solid ".concat(n)),o=new Ur;return o.change=function(t){r.setTitle(t),r.change(t)},r=Yr(this,Zr(e).call(this,i,"auto",!1,"bottom-left",o.el))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gr(t,e)}(e,Ln),n=e,(r=[{key:"setTitle",value:function(t){this.title.css("border-color",t),this.hide()}}])&&Xr(n.prototype,r),i&&Xr(n,i),e}();function Kr(t){return(Kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qr(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ti(t,e){return!e||"object"!==Kr(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ei(t){return(ei=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ni(t,e){return(ni=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ri=[["thin",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" style="user-select: none;"></line></svg>'],["medium",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="2" style="user-select: none;"><line x1="0" y1="1.0" x2="50" y2="1.0" stroke-width="2" stroke="black" style="user-select: none;"></line></svg>'],["thick",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="3" style="user-select: none;"><line x1="0" y1="1.5" x2="50" y2="1.5" stroke-width="3" stroke="black" style="user-select: none;"></line></svg>'],["dashed",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="2" style="user-select: none;"></line></svg>'],["dotted",'<svg xmlns="http://www.w3.org/2000/svg" width="50" height="1" style="user-select: none;"><line x1="0" y1="0.5" x2="50" y2="0.5" stroke-width="1" stroke="black" stroke-dasharray="1" style="user-select: none;"></line></svg>']],ii=function(t){function e(t){var n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=new ht("line-type"),o=0,l=ri.map(function(e,n){return a("div","".concat(at,"-item state ").concat(t===e[0]?"checked":"")).on("click",function(){l[o].toggle("checked"),l[n].toggle("checked"),o=n,r.hide(),r.change(e)}).child(a("div","".concat(at,"-line-type")).html(e[1]))});return r=ti(this,(n=ei(e)).call.apply(n,[this,i,"auto",!1,"bottom-left"].concat(Qr(l))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ni(t,e)}(e,Ln),e}();function oi(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ai(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function li(){var t;return a("table","").child((t=a("tbody","")).children.apply(t,arguments))}function si(t){var e=this;return a("td","").child(a("div","".concat(at,"-border-palette-cell")).child(new ht("border-".concat(t))).on("click",function(){e.mode=t;var n=e.mode,r=e.style,i=e.color;e.change({mode:n,style:r,color:i})}))}var ci=function t(){var e,n,r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.color="#000",this.style="thin",this.mode="all",this.change=function(){},this.ddColor=new Jr("line-color",this.color),this.ddColor.change=function(t){r.color=t},this.ddType=new ii(this.style),this.ddType.change=function(t){var e=ai(t,1)[0];r.style=e},this.el=a("div","".concat(at,"-border-palette"));var i=li(a("tr","").children(a("td","".concat(at,"-border-palette-left")).child(li((e=a("tr","")).children.apply(e,oi(["all","inside","horizontal","vertical","outside"].map(function(t){return si.call(r,t)}))),(n=a("tr","")).children.apply(n,oi(["left","top","right","bottom","none"].map(function(t){return si.call(r,t)}))))),a("td","".concat(at,"-border-palette-right")).children(a("div","".concat(at,"-toolbar-btn")).child(this.ddColor.el),a("div","".concat(at,"-toolbar-btn")).child(this.ddType.el))));this.el.child(i)};function ui(t){return(ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fi(t,e){return!e||"object"!==ui(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function hi(t){return(hi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function di(t,e){return(di=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var pi=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new ht("border-all"),r=new ci;return r.change=function(e){t.change(e),t.hide()},t=fi(this,hi(e).call(this,n,"auto",!1,"bottom-left",r.el))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&di(t,e)}(e,Ln),e}();function vi(t){return(vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function bi(t,e){return!e||"object"!==vi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function gi(t){return(gi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mi(t,e){return(mi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),bi(this,gi(e).call(this,"border"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mi(t,e)}(e,zn),n=e,(r=[{key:"dropdown",value:function(){return new pi}}])&&yi(n.prototype,r),i&&yi(n,i),e}();function ki(t){return(ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Si(t,e){return!e||"object"!==ki(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xi(t,e,n){return(xi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ei(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Ei(t){return(Ei=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ci(t,e){return(Ci=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _i=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Si(this,Ei(e).apply(this,arguments))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ci(t,e)}(e,jn),n=e,(r=[{key:"element",value:function(){var t=this;return xi(Ei(e.prototype),"element",this).call(this).child(new ht(this.tag)).on("click",function(){return t.change(t.tag)})}},{key:"setState",value:function(t){this.el.disabled(t)}}])&&Oi(n.prototype,r),i&&Oi(n,i),e}();function ji(t){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ti(t,e){return!e||"object"!==ji(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pi(t){return(Pi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ai(t,e){return(Ai=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ri=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ti(this,Pi(e).call(this,"clearformat"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ai(t,e)}(e,_i),e}();function Di(t){return(Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ii(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zi(t,e){return!e||"object"!==Di(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ni(t){return(Ni=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wi(t,e){return(Wi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Fi=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),zi(this,Ni(e).call(this,"paintformat"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Wi(t,e)}(e,dr),n=e,(r=[{key:"setState",value:function(){}}])&&Ii(n.prototype,r),i&&Ii(n,i),e}();function Mi(t){return(Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hi(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Li(t,e){return!e||"object"!==Mi(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Vi(t){return(Vi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function qi(t,e){return(qi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Bi=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Li(this,Vi(e).call(this,"color",null,void 0,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qi(t,e)}(e,zn),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Jr(t,e)}}])&&Hi(n.prototype,r),i&&Hi(n,i),e}();function Ui(t){return(Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xi(t,e){return!e||"object"!==Ui(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Yi(t){return(Yi=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zi(t,e){return(Zi=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Gi=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Xi(this,Yi(e).call(this,"bgcolor",null,void 0,t))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zi(t,e)}(e,zn),n=e,(r=[{key:"dropdown",value:function(){var t=this.tag,e=this.value;return new Jr(t,e)}}])&&$i(n.prototype,r),i&&$i(n,i),e}();function Ji(t){return(Ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ki(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Qi(t,e){return!e||"object"!==Ji(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function to(t){return(to=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function eo(t,e){return(eo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var no=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Ne.map(function(t){return a("div","".concat(at,"-item")).on("click",function(){n.setTitle("".concat(t.pt)),n.change(t)}).child("".concat(t.pt))});return n=Qi(this,(t=to(e)).call.apply(t,[this,"10","60px",!0,"bottom-left"].concat(Ki(r))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&eo(t,e)}(e,Ln),e}();function ro(t){return(ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function io(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oo(t,e){return!e||"object"!==ro(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ao(t){return(ao=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lo(t,e){return(lo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var so=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),oo(this,ao(e).call(this,"font-size"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&lo(t,e)}(e,zn),n=e,(r=[{key:"getValue",value:function(t){return t.pt}},{key:"dropdown",value:function(){return new no}}])&&io(n.prototype,r),i&&io(n,i),e}();function co(t){return(co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uo(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function fo(t,e){return!e||"object"!==co(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ho(t){return(ho=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function po(t,e){return(po=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var vo=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=ze.map(function(t){return a("div","".concat(at,"-item")).on("click",function(){n.setTitle(t.title),n.change(t)}).child(t.title)});return n=fo(this,(t=ho(e)).call.apply(t,[this,ze[0].title,"160px",!0,"bottom-left"].concat(uo(r))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&po(t,e)}(e,Ln),e}();function yo(t){return(yo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function go(t,e){return!e||"object"!==yo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function mo(t){return(mo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wo(t,e){return(wo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ko=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),go(this,mo(e).call(this,"font-name"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wo(t,e)}(e,zn),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new vo}}])&&bo(n.prototype,r),i&&bo(n,i),e}();function Oo(t){return(Oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function So(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function xo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Eo(t,e){return!e||"object"!==Oo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Co(t){return(Co=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _o(t,e){return(_o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var jo=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Ke.slice(0);return r.splice(2,0,{key:"divider"}),r.splice(8,0,{key:"divider"}),r=r.map(function(t){var e=a("div","".concat(at,"-item"));return"divider"===t.key?e.addClass("divider"):(e.child(t.title()).on("click",function(){n.setTitle(t.title()),n.change(t)}),t.label&&e.child(a("div","label").html(t.label))),e}),n=Eo(this,(t=Co(e)).call.apply(t,[this,"Normal","220px",!0,"bottom-left"].concat(So(r))))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_o(t,e)}(e,Ln),n=e,(r=[{key:"setTitle",value:function(t){for(var e=0;e<Ke.length;e+=1)Ke[e].key===t&&this.title.html(Ke[e].title());this.hide()}}])&&xo(n.prototype,r),i&&xo(n,i),e}();function To(t){return(To="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Po(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ao(t,e){return!e||"object"!==To(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ro(t){return(Ro=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Do(t,e){return(Do=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Io=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ao(this,Ro(e).call(this,"format"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Do(t,e)}(e,zn),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new jo}}])&&Po(n.prototype,r),i&&Po(n,i),e}();function zo(t){return(zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function No(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Wo(t,e){return!e||"object"!==zo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fo(t){return(Fo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Mo(t,e){return(Mo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ho=function(t){function e(){var t,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=Be.map(function(t){return a("div","".concat(at,"-item")).on("click",function(){n.hide(),n.change(t)}).child(t.key)});return n=Wo(this,(t=Fo(e)).call.apply(t,[this,new ht("formula"),"180px",!0,"bottom-left"].concat(No(r))))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mo(t,e)}(e,Ln),e}();function Lo(t){return(Lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qo(t,e){return!e||"object"!==Lo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bo(t){return(Bo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Uo(t,e){return(Uo=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var $o=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),qo(this,Bo(e).call(this,"formula"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Uo(t,e)}(e,zn),n=e,(r=[{key:"getValue",value:function(t){return t.key}},{key:"dropdown",value:function(){return new Ho}}])&&Vo(n.prototype,r),i&&Vo(n,i),e}();function Xo(t){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yo(t,e){return!e||"object"!==Xo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zo(t){return(Zo=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Go(t,e){return(Go=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Jo=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Yo(this,Zo(e).call(this,"freeze"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Go(t,e)}(e,dr),e}();function Ko(t){return(Ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qo(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ta(t,e){return!e||"object"!==Ko(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ea(t){return(ea=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function na(t,e){return(na=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ra=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ta(this,ea(e).call(this,"merge","unmerge"))}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&na(t,e)}(e,dr),n=e,(r=[{key:"setState",value:function(t,e){this.el.active(t).disabled(e)}}])&&Qo(n.prototype,r),i&&Qo(n,i),e}();function ia(t){return(ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oa(t,e){return!e||"object"!==ia(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function aa(t){return(aa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function la(t,e){return(la=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var sa=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),oa(this,aa(e).call(this,"print","Ctrl+P"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&la(t,e)}(e,_i),e}();function ca(t){return(ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ua(t,e){return!e||"object"!==ca(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fa(t){return(fa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ha(t,e){return(ha=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var da=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),ua(this,fa(e).call(this,"textwrap"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ha(t,e)}(e,dr),e}();function pa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function va(t){return(va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ya(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ba(t,e){return!e||"object"!==va(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ga(t){return(ga=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ma(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wa(t,e)}function wa(t,e){return(wa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ka=function(t){function e(){var t;ya(this,e);var n=new ht("ellipsis"),r=a("div","".concat(at,"-toolbar-more"));return(t=ba(this,ga(e).call(this,n,"auto",!1,"bottom-right",r))).moreBtns=r,t.contentEl.css("max-width","420px"),t}return ma(e,Ln),e}(),Oa=function(t){function e(){var t;return ya(this,e),(t=ba(this,ga(e).call(this,"more"))).el.hide(),t}var n,r,i;return ma(e,zn),n=e,(r=[{key:"dropdown",value:function(){return new ka}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide()}}])&&pa(n.prototype,r),i&&pa(n,i),e}();function Sa(t){return(Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xa(t,e){return!e||"object"!==Sa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ea(t){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ca(t,e){return(Ca=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _a=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),xa(this,Ea(e).call(this,"sort"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ca(t,e)}(e,_i),e}();function ja(t){return(ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ta(t,e){return!e||"object"!==ja(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pa(t){return(Pa=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Aa(t,e){return(Aa=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ra=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ta(this,Pa(e).call(this,"search"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Aa(t,e)}(e,_i),e}();function Da(t){return(Da="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ia(t,e){return!e||"object"!==Da(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function za(t){return(za=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Na(t,e){return(Na=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Wa=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ia(this,za(e).call(this,"commentEdit"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Na(t,e)}(e,_i),e}();function Fa(t){return(Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ma(t,e){return!e||"object"!==Fa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ha(t){return(Ha=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function La(t,e){return(La=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Va=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ma(this,Ha(e).call(this,"commentRemove"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&La(t,e)}(e,_i),e}();function qa(t){return(qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ba(t,e){return!e||"object"!==qa(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ua(t){return(Ua=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $a(t,e){return($a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xa=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Ba(this,Ua(e).call(this,"commentPrevious"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$a(t,e)}(e,_i),e}();function Ya(t){return(Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Za(t,e){return!e||"object"!==Ya(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ga(t){return(Ga=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ja(t,e){return(Ja=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ka=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Za(this,Ga(e).call(this,"commentNext"))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ja(t,e)}(e,_i),e}();function Qa(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tl(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function el(){return a("div","".concat(at,"-toolbar-divider"))}function nl(){var t,e,n=this.el,r=this.btns,i=this.moreEl,o=this.btns2,a=i.dd,l=a.moreBtns,s=a.contentEl,c=n.box(),u=160,f=12,h=[],d=[];o.forEach(function(t,e){var n=tl(t,2),r=n[0],i=n[1];u+=i,e===o.length-1||u<c.width?h.push(r):(f+=i,d.push(r))}),(t=r.html("")).children.apply(t,h),(e=l.html("")).children.apply(e,d),s.css("width","".concat(f,"px")),d.length>0?i.show():i.hide()}var rl=function(){function t(e,n,r,i){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=e,this.change=function(){},this.widthFn=n,this.isHide=r;var l=e.defaultStyle();this.items=[[new sa,this.paintformatEl=new Fi,this.clearformatEl=new Ri],el(),[this.formatEl=new Io],el(),[this.fontEl=new ko,this.fontSizeEl=new so],el(),[this.boldEl=new xr,this.italicEl=new Tr,this.underlineEl=new Mr,this.strikeEl=new Ir,this.textColorEl=new Bi(l.color)],el(),[this.fillColorEl=new Gi(l.bgcolor),this.borderEl=new wi,this.mergeEl=new ra],el(),[this.alignEl=new tr(l.align),this.valignEl=new ar(l.valign),this.textwrapEl=new da],el(),[this.freezeEl=new Jo,this.autofilterEl=new mr,this.formulaEl=new $o,this.sortEl=new _a,this.searchEl=new Ra],el(),[this.commentEditEl=new Wa,this.commentRemoveEl=new Va,this.commentPreviousEl=new Xa,this.commentNextEl=new Ka],el(),[this.moreEl=new Oa]],r&&i&&(this.items=[[this.moreEl=new Oa,this.sortEl=new _a,this.searchEl=new Ra]]),this.el=a("div","".concat(at,"-toolbar")),this.btns=a("div","".concat(at,"-toolbar-btns")),this.items.forEach(function(t){Array.isArray(t)?t.forEach(function(t){o.btns.child(t.el),t.change=function(){o.change.apply(o,arguments)}}):o.btns.child(t.el)}),this.el.child(this.btns),r&&!i?this.el.hide():(this.reset(),setTimeout(function(){(function(){var t=this;this.btns2=[],this.items.forEach(function(e){if(Array.isArray(e))e.forEach(function(e){var n=e.el,r=n.box(),i=n.computedStyle(),o=i.marginLeft,a=i.marginRight;t.btns2.push([n,r.width+parseInt(o,10)+parseInt(a,10)])});else{var n=e.box(),r=e.computedStyle(),i=r.marginLeft,o=r.marginRight;t.btns2.push([e,n.width+parseInt(i,10)+parseInt(o,10)])}})}).call(o),nl.call(o)},0),St(window,"resize",function(){nl.call(o)}))}var e,n,r;return e=t,(n=[{key:"paintformatActive",value:function(){return this.paintformatEl.active()}},{key:"paintformatToggle",value:function(){this.paintformatEl.toggle()}},{key:"trigger",value:function(t){this["".concat(t,"El")].click()}},{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){if(!this.isHide){var t=this.data,e=t.getSelectedCellStyle();this.mergeEl.setState(t.canUnmerge(),!1),this.autofilterEl.setState(!t.canAutofilter());var n=e.font,r=e.format;this.formatEl.setState(r),this.fontEl.setState(n.name),this.fontSizeEl.setState(n.size),this.boldEl.setState(n.bold),this.italicEl.setState(n.italic),this.underlineEl.setState(e.underline),this.strikeEl.setState(e.strike),this.textColorEl.setState(e.color),this.fillColorEl.setState(e.bgcolor),this.alignEl.setState(e.align),this.valignEl.setState(e.valign),this.textwrapEl.setState(e.textwrap),this.freezeEl.setState(t.freezeIsActive())}}}])&&Qa(e.prototype,n),r&&Qa(e,r),t}();function il(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ol(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var al=function(){function t(e,n){var r,i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"600px",l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.moving=!1,this.drag=s,this.title=e,this.el=a("div","".concat(at,"-modal")).css("width",o).css("position","absolute").children(a("div","".concat(at,"-modal-header")).children(new ht("close").on("click.stop",function(){return i.hide()}),this.title),(r=a("div","".concat(at,"-modal-content"))).children.apply(r,il(n))).hide(),this.showDimmer=l,this.drag&&this.el.on("mousedown.stop",function(t){return i.mousedownHandler(t)})}var e,n,r;return e=t,(n=[{key:"show",value:function(){var t=this;if(!this.moving){this.showDimmer&&(this.dimmer=a("div","".concat(at,"-dimmer active")),document.body.appendChild(this.dimmer.el));var e=this.el.show().box(),n=e.width,r=e.height,i=document.documentElement,o=i.clientHeight,l=i.clientWidth;this.el.offset({left:(l-n)/2,top:(o-r)/3}),window.xkeydownEsc=function(e){27===e.keyCode&&t.hide()},St(window,"keydown",window.xkeydownEsc)}}},{key:"hide",value:function(){this.el.hide(),this.showDimmer&&document.body.removeChild(this.dimmer.el),xt(window,"keydown",window.xkeydownEsc),delete window.xkeydownEsc}},{key:"mousedownHandler",value:function(t){var e=this,n=t;_t(window,function(t){if(e.moving=!0,null!==n){var r=e.el.offset(void 0);e.el.offset({left:r.left+t.movementX,top:r.top+t.movementY}),n=t}},function(){n=null,e.moving=!1})}}])&&ol(e.prototype,n),r&&ol(e,r),t}();function ll(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var sl=function(){function t(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vchange=function(){},this.el=a("div","".concat(at,"-form-input")),this.input=a("input","").css("width",e).on("input",function(t){return r.vchange(t)}).attr("placeholder",n).attr("maxlength",i),this.el.child(this.input)}var e,n,r;return e=t,(n=[{key:"focus",value:function(){var t=this;setTimeout(function(){t.input.el.focus()},10)}},{key:"hint",value:function(t){this.input.attr("placeholder",t)}},{key:"val",value:function(t){return this.input.val(t)}}])&&ll(e.prototype,n),r&&ll(e,r),t}();function cl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var ul=function(){function t(e,n,r){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.key=e,this.getTitle=o,this.vchange=function(){},this.el=a("div","".concat(at,"-form-select")),this.suggest=new Qt(n.map(function(t){return{key:t,title:i.getTitle(t)}}),function(t){i.itemClick(t.key),l(t.key),i.vchange(t.key)},r,this.el),this.el.children(this.itemEl=a("div","input-text").html(this.getTitle(e)),this.suggest.el).on("click",function(){return i.show()})}var e,n,r;return e=t,(n=[{key:"show",value:function(){this.suggest.search("")}},{key:"itemClick",value:function(t){this.key=t,this.itemEl.html(this.getTitle(t))}},{key:"val",value:function(t){return void 0!==t?(this.key=t,this.itemEl.html(this.getTitle(t)),this):this.key}}])&&cl(e.prototype,n),r&&cl(e,r),t}();function fl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var hl={number:/(^\d+$)|(^\d+(\.\d{0,4})?$)/,date:/^\d{4}-\d{1,2}-\d{1,2}$/},dl=function(){function t(e,n,r,i){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.label="",this.rule=n,r&&(this.label=a("label","label").css("width","".concat(i,"px")).html(r)),this.tip=a("div","tip").child("tip").hide(),this.input=e,this.input.vchange=function(){return o.validate()},this.el=a("div","".concat(at,"-form-field")).children(this.label,e.el,this.tip)}var e,n,r;return e=t,(n=[{key:"isShow",value:function(){return"none"!==this.el.css("display")}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){return this.el.hide(),this}},{key:"val",value:function(t){return this.input.val(t)}},{key:"hint",value:function(t){this.input.hint(t)}},{key:"validate",value:function(){var t=this.input,e=this.rule,n=this.tip,r=this.el,i=t.val();if(e.required&&/^\s*$/.test(i))return n.html(B("validation.required")),r.addClass("error"),!1;if((e.type||e.pattern)&&!(e.pattern||hl[e.type]).test(i))return n.html(B("validation.notMatch")),r.addClass("error"),!1;return r.removeClass("error"),!0}}])&&fl(e.prototype,n),r&&fl(e,r),t}();function pl(t){return(pl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function yl(t,e){return!e||"object"!==pl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function bl(t){return(bl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gl(t,e){return(gl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ml=100,wl=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new dl(new ul("cell",["cell"],"100%",function(t){return B("dataValidation.modeType.".concat(t))}),{required:!0},"".concat(B("dataValidation.range"),":"),ml),r=new dl(new sl("120px","E3 or E3:F12"),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/}),i=new dl(new ul("list",["list","number","date","phone","email"],"100%",function(t){return B("dataValidation.type.".concat(t))},function(e){return t.criteriaSelected(e)}),{required:!0},"".concat(B("dataValidation.criteria"),":"),ml),o=new dl(new ul("be",["be","nbe","eq","neq","lt","lte","gt","gte"],"160px",function(t){return B("dataValidation.operator.".concat(t))},function(e){return t.criteriaOperatorSelected(e)}),{required:!0}).hide(),l=new dl(new sl("70px","10"),{required:!0}).hide(),s=new dl(new sl("70px","100"),{required:!0,type:"number"}).hide(),c=new dl(new sl("120px","a,b,c"),{required:!0}),u=new dl(new sl("70px","10"),{required:!0,type:"number"}).hide();return(t=yl(this,bl(e).call(this,B("contextmenu.validation"),[a("div","".concat(at,"-form-fields")).children(n.el,r.el),a("div","".concat(at,"-form-fields")).children(i.el,o.el,l.el,s.el,u.el,c.el),a("div","".concat(at,"-buttons")).children(new be("cancel").on("click",function(){return t.btnClick("cancel")}),new be("remove").on("click",function(){return t.btnClick("remove")}),new be("save","primary").on("click",function(){return t.btnClick("save")}))]))).mf=n,t.rf=r,t.cf=i,t.of=o,t.minvf=l,t.maxvf=s,t.vf=u,t.svf=c,t.change=function(){},t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gl(t,e)}(e,al),n=e,(r=[{key:"showVf",value:function(t){var e="date"===t?"2018-11-12":"10",n=this.vf;n.input.hint(e),n.show()}},{key:"criteriaSelected",value:function(t){var e=this.of,n=this.minvf,r=this.maxvf,i=this.vf,o=this.svf;"date"===t||"number"===t?(e.show(),n.rule.type=t,r.rule.type=t,"date"===t?(n.hint("2018-11-12"),r.hint("2019-11-12")):(n.hint("10"),r.hint("100")),n.show(),r.show(),i.hide(),o.hide()):("list"===t?o.show():o.hide(),i.hide(),e.hide(),n.hide(),r.hide())}},{key:"criteriaOperatorSelected",value:function(t){if(t){var e=this.minvf,n=this.maxvf,r=this.vf;if("be"===t||"nbe"===t)e.show(),n.show(),r.hide();else{var i=this.cf.val();r.rule.type=i,"date"===i?r.hint("2018-11-12"):r.hint("10"),r.show(),e.hide(),n.hide()}}}},{key:"btnClick",value:function(t){if("cancel"===t)this.hide();else if("remove"===t)this.change("remove"),this.hide();else if("save"===t){for(var e=["mf","rf","cf","of","svf","vf","minvf","maxvf"],n=0;n<e.length;n+=1){var r=this[e[n]];if(r.isShow()&&!r.validate())return}var i=this.mf.val(),o=this.rf.val(),a=this.cf.val(),l="phone"===a||"email"===a?"":this.of.val(),s=this.svf.val();"number"!==a&&"date"!==a||(s="be"===l||"nbe"===l?[this.minvf.val(),this.maxvf.val()]:this.vf.val()),this.change("save",i,o,{type:a,operator:l,required:!1,value:s}),this.hide()}}},{key:"setValue",value:function(t){if(t){var e=this.mf,n=this.rf,r=this.cf,i=this.of,o=this.svf,a=this.vf,l=this.minvf,s=this.maxvf,c=t.mode,u=t.ref,f=t.validator||{type:"list"},h=f.type,d=f.operator,p=f.value;e.val(c||"cell"),n.val(u),r.val(h),i.val(d),Array.isArray(p)?(l.val(p[0]),s.val(p[1])):(o.val(p||""),a.val(p||"")),this.criteriaSelected(h),this.criteriaOperatorSelected(d)}this.show()}}])&&vl(n.prototype,r),i&&vl(n,i),e}();function kl(t){return(kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ol(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Sl(t,e){return!e||"object"!==kl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function xl(t){return(xl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function El(t,e){return(El=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Cl=100,_l=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new dl(new sl("120px",""),{required:!0,pattern:/^([A-Z]{1,2}[1-9]\d*)(:[A-Z]{1,2}[1-9]\d*)?$/},"".concat(B("dataSort.ci"),":"),Cl),r=new dl(new ul("desc",["asc","desc"],"100%",function(t){return B("dataSort.order.".concat(t))},function(){}),{required:!0},"".concat(B("dataSort.criteria"),":"),Cl);return(t=Sl(this,xl(e).call(this,B("contextmenu.sort"),[a("div","".concat(at,"-form-fields")).children(n.el),a("div","".concat(at,"-form-fields")).children(r.el),a("div","".concat(at,"-buttons")).children(new be("cancel").on("click",function(){return t.btnClick("cancel")}),new be("ok","primary").on("click",function(){return t.btnClick("ok")}))]))).cf=n,t.of=r,t.ci=null,t.values=[],t.change=function(){},t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&El(t,e)}(e,al),n=e,(r=[{key:"btnClick",value:function(t){if("ok"===t){if(!this.cf.validate())return;var e=this.ci,n=this.values,r=this.of.val();this.change("ok",e,r,n)}this.hide()}},{key:"setValue",value:function(t){if(t){var e=this.cf,n=this.of,r=t.ref,i=t.sort,o=t.ci,a=t.m,l=(i||{order:"asc"}).order;e.val(r),n.val(l),this.ci=o,this.values=a}this.show()}}])&&Ol(n.prototype,r),i&&Ol(n,i),e}();function jl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Tl(t){return a("div","".concat(at,"-item ").concat(t))}function Pl(t){var e=this;return Tl("state").child(B("sort.".concat(t))).on("click.stop",function(){return e.itemClick(t)})}function Al(){var t=this.filterhEl,e=this.filterValues,n=this.values;t.html("".concat(e.length," / ").concat(n.length)),t.checked(e.length===n.length)}var Rl=function(){function t(){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.filterbEl=a("div","".concat(at,"-body")),this.filterhEl=a("div","".concat(at,"-header state")).on("click.stop",function(){return e.filterClick(0,"all")}),this.el=a("div","".concat(at,"-sort-filter")).children(this.sortAscEl=Pl.call(this,"asc"),this.sortDescEl=Pl.call(this,"desc"),Tl("divider"),a("div","".concat(at,"-filter")).children(this.filterhEl,this.filterbEl),a("div","".concat(at,"-buttons")).children(new be("cancel").on("click",function(){return e.btnClick("cancel")}),new be("ok","primary").on("click",function(){return e.btnClick("ok")}))).hide(),this.ci=null,this.sortDesc=null,this.values=null,this.filterValues=[]}var e,n,r;return e=t,(n=[{key:"btnClick",value:function(t){if("ok"===t){var e=this.ci,n=this.sort,r=this.filterValues;this.ok&&this.ok(e,n,"in",r)}this.hide()}},{key:"itemClick",value:function(t){this.sort=t;var e=this.sortAscEl,n=this.sortDescEl;e.checked("asc"===t),n.checked("desc"===t)}},{key:"filterClick",value:function(t,e){var n=this.filterbEl,r=this.filterValues,i=this.values,o=n.children();"all"===e?o.length===r.length?(this.filterValues=[],o.forEach(function(t){return a(t).checked(!1)})):(this.filterValues=Array.from(i),o.forEach(function(t){return a(t).checked(!0)})):a(o[t]).toggle("checked")?r.push(e):r.splice(r.findIndex(function(t){return t===e}),1);Al.call(this)}},{key:"set",value:function(t,e,n,r){this.ci=t;var i=this.sortAscEl,o=this.sortDescEl;null!==r?(this.sort=r.order,i.checked(r.asc()),o.checked(r.desc())):(this.sortDesc=null,i.checked(!1),o.checked(!1)),this.values=Object.keys(e),this.filterValues=n?Array.from(n.value):Object.keys(e),function(t){var e=this,n=this.filterbEl,r=this.filterValues;n.html(""),Object.keys(t).forEach(function(i,o){var l=t[i],s=r.includes(i)?"checked":"";n.child(a("div","".concat(at,"-item state ").concat(s)).on("click.stop",function(){return e.filterClick(o,i)}).children(""===i?B("filter.empty"):i,a("div","label").html("(".concat(l,")"))))})}.call(this,e,n),Al.call(this)}},{key:"setOffset",value:function(t){var e=this;this.el.offset(t).show();var n=1;Ct(this.el,function(){n<=0&&(e.hide(),n=5),n-=1})}},{key:"setOffsetAdjustView",value:function(t,e,n){var r=this;this.el.show();var i=this.el.offset(),o=i.width,a=i.height;t.top+a>n&&(t.top=n-a),t.left+o>e&&(t.left=e-o),this.el.offset(t);var l=1;Ct(this.el,function(){l<=0&&(r.hide(),l=5),l-=1})}},{key:"show",value:function(){this.el.show()}},{key:"hide",value:function(){this.el.hide(),Et(this.el)}}])&&jl(e.prototype,n),r&&jl(e,r),t}();function Dl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Il=function(){function t(){var e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=!1,(n="onEdit")in(e=this)?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,this.el=a("div","".concat(at,"-comment-tip")).hide()}var e,n,r;return e=t,(n=[{key:"hide",value:function(){this.el.hide()}},{key:"setPosition",value:function(t,e,n){if(!0!==this.onEdit){var r=this.el,i=n?e.left-e.width-1:e.left+e.width,o=e.top-e.height/2;r.css("left","".concat(i,"px")),r.css("top","".concat(o,"px")),r.html(t).show(),n&&r.css("left","".concat(i-r.el.offsetWidth,"px"))}}}])&&Dl(e.prototype,n),r&&Dl(e,r),t}();function zl(t){return(zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nl(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Wl(t,e){return!e||"object"!==zl(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Fl(t,e,n){return(Fl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ml(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Ml(t){return(Ml=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Hl(t,e){return(Hl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ll=100,Vl=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=new dl(new sl("120px",""),{required:!0},"".concat(B("dataSearch.label"),":"),Ll);return(t=Wl(this,Ml(e).call(this,B("toolbar.search"),[a("div","".concat(at,"-form-fields")).child(n.el),a("div","".concat(at,"-buttons")).children(new be("previous").on("click",function(){return t.btnClick("previous")}),new be("next").on("click",function(){return t.btnClick("next")}),new be("close","primary").on("click",function(){return t.btnClick("close")}))],"500px",!1,!0))).formField=n,t.change=function(){},t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hl(t,e)}(e,al),n=e,(r=[{key:"btnClick",value:function(t){if("close"!==t){if(!this.formField.validate())return;var e=this.formField.val().toUpperCase().trim();switch(t){case"previous":this.change("previous",e);break;case"next":this.change("next",e)}}else this.hide()}},{key:"show",value:function(){Fl(Ml(e.prototype),"show",this).call(this),this.formField.input.focus()}}])&&Nl(n.prototype,r),i&&Nl(n,i),e}();function ql(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var Bl=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.data=e,this.mode=n,this.inputChange=function(){},this.enter=function(){},this.el=a("div","".concat(at,"-formula-bar")),this.barLabel=a("div","".concat(at,"-bar-label")),this.formulaInput=a("input","".concat(at,"-formula-input")).on("input",function(t){r.inputChange(t.target.value)}).on("keydown",function(t){13===(t.keyCode||t.which)&&(r.formulaInput.el.blur(),r.enter(t))}),"read"===this.mode&&this.formulaInput.attr("disabled","disabled"),this.el.children(this.barLabel,this.formulaInput),this.reset()}var e,n,r;return e=t,(n=[{key:"resetData",value:function(t){this.data=t,this.reset()}},{key:"reset",value:function(){var t=this.data,e=t.selector,n=c(e.ci)+""+(e.ri+1),r=t.getSelectedCell(),i="";r&&(r.text&&(i=r.text),r.ufv&&(i=r.ufv),r.f&&(i=r.f)),this.barLabel.html(n),this.formulaInput.val(i)}}])&&ql(e.prototype,n),r&&ql(e,r),t}();function Ul(t){return(Ul="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Xl(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Yl(t,e,n){return(Yl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zl(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function Zl(t){return(Zl=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Gl(t,e){return(Gl=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Jl(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Kl=function(t){function e(){var t,n,r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,t=!(r=Zl(e).call(this))||"object"!==Ul(r)&&"function"!=typeof r?Xl(n):r,Jl(Xl(t),"col",void 0),Jl(Xl(t),"row",void 0),t.el.attr("contentEditable","true"),t.el.attr("placeholder","".concat(B("toolbar.commentDefault"))),t.el.attr("id","commentEdit"),t}var n,r,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gl(t,e)}(e,Il),n=e,(r=[{key:"saveAndHide",value:function(t){var e=this;if(void 0!==this.col&&void 0!==this.row){if(""!==this.el.html()){for(var n=-1,r=0;r<t.data.comments.length;r++)if(t.data.comments[r].col===this.col&&t.data.comments[r].row===this.row){n=r;break}-1===n?t.data.comments.push({col:this.col,row:this.row,author:"Aspose",note:this.el.html()}):t.data.comments[n].note=this.el.html()}t.data.comments=t.data.comments.filter(function(t){return!e.checkEmptyContent(t.note)}),this.hide(),t.commentTip.onEdit=!1,this.col=void 0,this.row=void 0}}},{key:"checkEmptyContent",value:function(t){var e=document.createElement("div");return e.innerHTML=t,""===e.innerText}},{key:"setPosition",value:function(t,n,r){Yl(Zl(e.prototype),"setPosition",this).call(this,t,n,r),this.el.focus()}}])&&$l(n.prototype,r),i&&$l(n,i),e}();function Ql(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ts(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function es(t,e){var n,r=this;return function(){for(var i=r,o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];var s=a;n||(n=setTimeout(function(){n=null,t.apply(i,s)},e))}}function ns(t,e,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(-1!==e||-1!==n){var o=this.table,a=this.selector,l=this.toolbar,s=this.formulaBar,c=this.data;if(this.contextMenu.setMode(-1===e||-1===n?"row-col":"range"),c.canSelected(e,n)){var u=c.getCell(e,n);t?(a.setEnd(e,n,i),this.trigger("cells-selected",u,a.range)):(a.set(e,n,r),this.trigger("cell-selected",u,e,n)),l.reset(),s.reset(),o.render()}}}function rs(t,e){var n=this.selector,r=this.data,i=r.rows,o=r.cols,a=ts(n.indexes,2),l=a[0],s=a[1],c=n.range,u=c.eri,f=c.eci;if(t){var h=ts(n.moveIndexes,2);l=h[0],s=h[1]}"left"===e?s>0&&(s-=1):"right"===e?(f!==s&&(s=f),s<o.len-1&&(s+=1)):"up"===e?l>0&&(l-=1):"down"===e?(u!==l&&(l=u),l<i.len-1&&(l+=1)):"row-first"===e?s=0:"row-last"===e?s=o.len-1:"col-first"===e?l=0:"col-last"===e&&(l=i.len-1),t&&(n.moveIndexes=[l,s]),ns.call(this,t,l,s),function(){var t=this.data,e=this.verticalScrollbar,n=this.horizontalScrollbar,r=t.getSelectedRect(),i=r.l,o=r.t,a=r.left,l=r.top,s=r.width,c=r.height,u=this.getTableOffset();if(Math.abs(a)+s>u.width)n.move({left:i+s-u.width});else{var f=t.freezeTotalWidth();a<f&&n.move({left:i-1-f})}if(Math.abs(l)+c>u.height)e.move({top:o+c-u.height-1});else{var h=t.freezeTotalHeight();l<h&&e.move({top:o-1-h})}}.call(this)}function is(){var t=this.data,e=this.verticalScrollbar,n=this.getTableOffset().height,r=t.exceptRowTotalHeight(0,-1);e.set(n,t.rows.totalHeight()-r)}function os(){var t=this.data,e=this.horizontalScrollbar,n=this.getTableOffset().width;t&&e.set(n,t.cols.totalWidth()),t.displayRight2Left?e.el.attr("dir","rtl"):e.el.removeAttr("dir")}function as(){var t=this.tableEl,e=this.overlayerEl,n=this.overlayerCEl,r=this.table,i=this.toolbar,o=this.formulaBar,a=this.selector,l=this.el,s=this.getTableOffset(),c=this.getRect();t.attr(c),e.offset(c),n.offset(s),l.css("width","".concat(c.width,"px")),is.call(this),os.call(this),function(){var t=this.selector,e=this.data,n=this.editor,r=ts(e.freeze,2),i=r[0],o=r[1];if(i>0||o>0){var a=e.freezeTotalWidth(),l=e.freezeTotalHeight();n.setFreezeLengths(a,l)}t.resetAreaOffset()}.call(this),r.render(),i.reset(),o.reset(),a.reset()}function ls(){var t=this.data,e=this.selector;t.clearClipboard(),e.hideClipboard()}function ss(){var t=this.data,e=this.selector;t.copy(),e.showClipboard()}function cs(){var t=this.data,e=this.selector;t.cut(),e.showClipboard()}function us(t,e){var n=this.data;if("read"!==n.settings.mode&&!n.getLocked())if(n.paste(t,function(t){return dt("Tip",t)}))as.call(this);else if(e&&null==n.clipboard.range){var r=e.clipboardData.getData("text/plain");r.length>0&&(this.data.pasteFromText(r),as.call(this))}}function fs(t,e){this.data.unhideRowsOrCols(t,e),as.call(this)}function hs(t){var e=this,n=this.selector,r=this.data,i=this.table,o=this.sortFilter,a=t.offsetX,l=t.offsetY,s=t.target.className==="".concat(at,"-selector-corner"),c=r.getCellRectByXY(a,l),u=c.left,f=c.top,h=c.width,d=c.height,p=r.viewHeight(),v=r.viewWidth(),y=c.ri,b=c.ci;if(!(y<-1||b<-1)){var g=r.autoFilter,m=r.TableAutoFilters;if(g.includes(y,b)&&u+h-20<a&&f+d-20<l){var w=g.items(b,function(t,e){return r.rows.getCell(t,e)});return o.set(b,w,g.getFilter(b),g.getSort(b)),o.setOffsetAdjustView({left:u,top:f+d+2},v,p),void(r.currentAutoFilter=g)}for(var k=0,O=m.length;k<O;k++){var S=m[k];if(S.includes(y,b)&&u+h-20<a&&f+d-20<l){var x=S.items(b,function(t,e){return r.rows.getCell(t,e)});return o.set(b,x,S.getFilter(b),S.getSort(b)),o.setOffsetAdjustView({left:u,top:f+d+2},v,p),void(r.currentAutoFilter=S)}}t.shiftKey||(s?n.showAutofill(y,b):ns.call(this,!1,y,b),_t(window,function(t){var i=r.getCellRectByXY(t.offsetX,t.offsetY);y=i.ri,b=i.ci,s?n.showAutofill(y,b):1!==t.buttons||t.shiftKey||ns.call(e,!0,y,b,!0,!0)},function(){r.getLocked()||(s&&n.arange&&"read"!==r.settings.mode&&r.autofill(n.arange,"all",function(t){return dt("Tip",t)})&&i.render(),n.hideAutofill(),function(){var t=this.toolbar;t.paintformatActive()&&(us.call(this,"format"),ls.call(this),t.paintformatToggle())}.call(e))})),s||1!==t.buttons||t.shiftKey&&ns.call(this,!0,y,b)}}function ds(){var t=this.editor,e=this.data.getSelectedRect(),n=this.getTableOffset(),r="top";e.top>n.height/2&&(r="bottom"),t.setOffset(e,r)}function ps(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.editor,n=this.data;"read"!==n.settings.mode&&(n.getLocked()||(ds.call(this),e.setCell(n.getSelectedCell(),n.getSelectedValidator(),t),ls.call(this)))}function vs(){var t=this.formulaBar,e=this.data;t.resetData(e)}function ys(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"finished",n=this.data,r=this.table;if("read"!==n.settings.mode&&!n.getLocked()){n.setSelectedCellText(t,e);var i=n.selector,o=i.ri,a=i.ci;if("finished"===e){if("server"===n.settings.updateMode)return;r.render()}else this.trigger("cell-edited",t,o,a)}}function bs(t){var e=this.data;"insert-row"===t?e.insert("row"):"delete-row"===t?e.delete("row"):"insert-column"===t?e.insert("column"):"delete-column"===t?e.delete("column"):"delete-cell"===t?e.deleteCell():"delete-cell-format"===t?e.deleteCell("format"):"delete-cell-text"===t?e.deleteCell("text"):"cell-printable"===t?e.setSelectedCellAttr("printable",!0):"cell-non-printable"===t?e.setSelectedCellAttr("printable",!1):"cell-editable"===t?e.setSelectedCellAttr("editable",!0):"cell-non-editable"===t&&e.setSelectedCellAttr("editable",!1),ls.call(this),as.call(this)}function gs(t,e){var n=this.data,r=this.modalSort,i=this.modalSearch,o=this.commentEditable;this.overlayerCEl;if("undo"===t)this.undo();else if("redo"===t)this.redo();else if("print"===t)this.print.preview(),this.print.toPrint();else if("paintformat"===t)!0===e?ss.call(this):ls.call(this);else if("clearformat"===t)bs.call(this,"delete-cell-format");else if("link"===t);else if("chart"===t);else if("autofilter"===t)(function(){this.data.autofilter(),as.call(this)}).call(this);else if("freeze"===t)if(e){var a=n.selector,l=a.ri,s=a.ci;this.freeze(l,s)}else this.freeze(0,0);else if("sort"===t)r.setValue(n.getSelectedSort());else if("search"===t)i.show();else if("commentEdit"===t){var c=n.selector,u=c.ri,f=c.ci,h="";if(void 0!==n.comments)for(var d=0;d<n.comments.length;d++){var p=n.comments[d];p.row===u&&p.col===f&&(h=p.note)}var v=n.cellRectWithOutTransfer(u,f);o.col=f,o.row=u,o.setPosition(h,v),this.commentTip.onEdit=!0}else if("commentRemove"===t){var y=n.selector,b=y.ri,g=y.ci;if(void 0!==n.comments)for(var m=0;m<n.comments.length;m++)n.comments[m].col===g&&n.comments[m].row===b&&n.comments.splice(m,1)}else"commentPrevious"===t?ms(this,n,"previous"):"commentNext"===t?ms(this,n,"next"):(n.setSelectedCellAttr(t,e),"formula"!==t||n.selector.multiple()||ps.call(this),as.call(this))}function ms(t,e,n){var r=t.selector,i=t.commentEditable,o=e.selector,a=o.ri,l=o.ci,s=a,c=l,u="";if(void 0!==e.comments){e.comments.sort(function(t,e){return t.row>e.row||t.row===e.row&&t.col>e.col?1:-1});for(var f=0;f<e.comments.length;f++){var h=e.comments[f];if("previous"===n)(h.row<a||h.row===a&&h.col<l)&&(s=h.row,c=h.col,u=h.note);else if("next"===n&&(h.row>a||h.row===a&&h.col>l)){s=h.row,c=h.col,u=h.note;break}}}if(r.set(s,c),""!==u){var d=e.cellRectWithOutTransfer(s,c);i.col=c,i.row=s,i.onEdit=!1,i.setPosition(u,d)}}function ws(t,e,n,r){this.data.setAutoFilter(t,e,n,r),as.call(this),this.data.updateConditionImageVisible()}function ks(){var t,e,n,r,i,o,l=this,s=this.selector,c=this.overlayerEl,u=this.rowResizer,f=this.colResizer,h=this.verticalScrollbar,d=this.horizontalScrollbar,p=this.editor,v=this.contextMenu,y=this.commentTip,b=this.commentEditable,g=this.toolbar,m=this.formulaBar,w=this.modalValidation,k=this.modalSort,O=this.modalSearch,S=this.sortFilter,x=this.el;c.on("mousemove",function(t){(function(t){if(0===t.buttons&&t.target.className!=="".concat(at,"-resizer-hover")){var e=t.offsetX,n=t.offsetY,r=this.rowResizer,i=this.colResizer,o=this.tableEl,a=this.data,l=a.rows,s=a.cols,c=a.displayRight2Left,u=a.settings.row.height;if(e>s.indexWidth&&n>u)return r.hide(),void i.hide();var f=o.box(),h=a.getCellRectByXY(t.offsetX,t.offsetY);h.ri>=0&&-1===h.ci?(h.width=s.indexWidth,r.show(h,{width:f.width}),l.isHide(h.ri-1)?r.showUnhide(h.ri):r.hideUnhide()):r.hide(),-1===h.ri&&h.ci>=0?(h.height=u,h.top=0,i.show(h,{height:f.height},c),s.isHide(h.ci-1)?i.showUnhide(h.ci):i.hideUnhide()):i.hide()}}).call(l,t)}).on("mousedown",function(t){p.clear(),v.hide(),y.hide(),b.saveAndHide(l),2===t.buttons?(l.data.xyInSelectedRect(t.offsetX,t.offsetY)?v.setPosition(t.offsetX,t.offsetY):(hs.call(l,t),v.setPosition(t.offsetX,t.offsetY)),t.stopPropagation()):2===t.detail?ps.call(l):hs.call(l,t)}).on("mousewheel.stop",function(t){(function(t){var e=this.verticalScrollbar,n=this.horizontalScrollbar,r=this.data,i=e.scroll().top,o=n.scroll().left,a=r.rows,l=r.cols,s=t.deltaY,c=t.deltaX,u=function(t,e){var n=t,r=0;do{r=e(n),n+=1}while(r<=0);return r},f=function(t){if(t>0){var n=r.scroll.ri+1;if(n<a.len){var o=u(n,function(t){return a.getHeight(t)});e.move({top:i+o-1})}}else{var l=r.scroll.ri-1;if(l>=0){var s=u(l,function(t){return a.getHeight(t)});e.move({top:0===l?0:i-s})}}},h=Math.abs(s),d=Math.abs(c),p=Math.max(h,d);/Firefox/i.test(window.navigator.userAgent)&&es(f(t.detail),50),p===d&&es(function(t){if(t>0){var e=r.scroll.ci+1;if(e<l.len){var i=u(e,function(t){return l.getWidth(t)});n.move({left:o+i-1})}}else{var a=r.scroll.ci-1;if(a>=0){var s=u(a,function(t){return l.getWidth(t)});n.move({left:0===a?0:o-s})}}}(c),50),p===h&&es(f(s),50)}).call(l,t)}).on("mouseout",function(t){var e=t.offsetX;t.offsetY<=0&&f.hide(),e<=0&&u.hide()}),b.el.on("input",function(t){if(1===l.commentEditable.el.el.childNodes.length&&"#text"===l.commentEditable.el.el.childNodes[0].nodeName){var e=a("font");e.attr("style","FONT-FAMILY: 宋体;FONT-SIZE: 9pt;COLOR: #000000;TEXT-ALIGN: left;"),e.child(document.createTextNode(l.commentEditable.el.el.textContent)),l.commentEditable.el.el.replaceChild(e.el,l.commentEditable.el.el.firstChild),t.target.focus();var n=window.getSelection();n.selectAllChildren(t.target),n.collapseToEnd()}}),s.inputChange=function(t){ys.call(l,t,"input"),ps.call(l),vs.call(l)},m.inputChange=function(t){ys.call(l,t,"input"),ps.call(l,!1)},m.enter=function(t){p.clear(),t.preventDefault()},St(x.el,"mousemove",function(t){y.hide();var e=t.offsetX,n=t.offsetY,r=l.data,i=r.comments,o=r.getCellRectByXY(e,n);o.ri>=0&&o.ci>=0&&i.forEach(function(t){o.ri===t.row&&o.ci===t.col&&y.setPosition(t.note,o,r.displayRight2Left)})}),t=c.el,n=(e={move:function(t,e){(function(t,e){var n=this.verticalScrollbar,r=this.horizontalScrollbar,i=n.scroll().top,o=r.scroll().left;"left"===t||"right"===t?r.move({left:o-e}):"up"!==t&&"down"!==t||n.move({top:i-e})}).call(l,t,e)}}).move,r=e.end,i=0,o=0,St(t,"touchstart",function(t){var e=t.touches[0],n=e.pageX,r=e.pageY;i=n,o=r}),St(t,"touchmove",function(t){if(n){var e=t.changedTouches[0],r=e.pageX,a=e.pageY,l=r-i,s=a-o;(Math.abs(l)>10||Math.abs(s)>10)&&(jt(l,s,t,n),i=r,o=a),t.preventDefault()}}),St(t,"touchend",function(t){if(r){var e=t.changedTouches[0],n=e.pageX,a=e.pageY;jt(n-i,a-o,t,r)}}),g.change=function(t,e){return gs.call(l,t,e)},S.ok=function(t,e,n,r){return ws.call(l,t,e,n,r)},u.finishedFn=function(t,e){(function(t,e){var n=t.ri,r=this.table,i=this.selector;this.data.rows.setHeight(n,e),r.render(),i.resetAreaOffset(),is.call(this),ds.call(this)}).call(l,t,e)},f.finishedFn=function(t,e){(function(t,e){var n=t.ci,r=this.table,i=this.selector;this.data.cols.setWidth(n,e),r.render(),i.resetAreaOffset(),os.call(this),ds.call(this)}).call(l,t,e)},u.unhideFn=function(t){fs.call(l,"row",t)},f.unhideFn=function(t){fs.call(l,"col",t)},h.moveFn=function(t,e){(function(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrolly(t,function(){i.resetBRLAreaOffset(),ds.call(e),r.render(),n.scrollImagesShapes()})}).call(l,t,e)},d.moveFn=function(t,e){(function(t){var e=this,n=this.data,r=this.table,i=this.selector;n.scrollx(t,function(){i.resetBRTAreaOffset(),ds.call(e),r.render(),n.scrollImagesShapes()})}).call(l,t,e)},p.change=function(t,e){ys.call(l,e,t),vs.call(l)},w.change=function(t){if("save"===t){for(var e,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=l.data).addValidation.apply(e,r)}else l.data.removeValidation()},k.change=function(t,e,n,r){"ok"===t&&(function(){this.data.autoSort(),as.call(this)}.call(l),ws.call(l,e,n,"all",r))},O.change=function(t,e){if("close"!==t){var n=l.data,r=n.search,i=n.rows,o=r.keywords,a=r.current,c=[];if(o===e)c=r.result;else{var u=i.len>0?i._:{};for(var f in u){var h=u[f].cells;for(var d in h){if(-1!==h[d].text.toUpperCase().indexOf(e)){var p={ri:f,ci:d};c.push(p)}}}r.keywords=e,r.result=c}if(0===c.length)return void alert("We couldn't find what you were looking for.");var v=ts(s.indexes,2),y=v[0],b=v[1];for(var g in c){var m=Number(g)+1,w=c.length-1;if(Number(y)===Number(c[g].ri)&&Number(b)===Number(c[g].ci)){a=m;break}if(Number(y)<Number(c[0].ri)){a=0;break}if(Number(y)>=Number(c[g].ri)&&Number(y)<Number(c[m].ri)){a=m;break}if(Number(y)>Number(c[w].ri)){a=w+1;break}}switch(t){case"previous":a>1&&a--;break;case"next":a<c.length&&a++}var k=a>0?a:1;r.current=k,s.set(c[k-1].ri,c[k-1].ci),function(){var t=this.data,e=this.verticalScrollbar,n=this.horizontalScrollbar,r=t.getSelectedRectBySearch(),i=r.l,o=r.t;n.move({left:i-1}),e.move({top:o-1})}.call(l)}},v.itemClick=function(t){"validation"===t?w.setValue(l.data.getSelectedValidation()):"sort"===t?k.setValue(l.data.getSelectedSort()):"copy"===t?ss.call(l):"cut"===t?cs.call(l):"paste"===t?us.call(l,"all"):"paste-value"===t?us.call(l,"text"):"paste-format"===t?us.call(l,"format"):"hide"===t?function(){this.data.hideRowsOrCols(),as.call(this)}.call(l):bs.call(l,t)},St(window,"resize",function(){l.reload()}),St(window,"click",function(t){l.focusing=c.contains(t.target)}),St(window,"paste",function(t){l.focusing&&(us.call(l,"all",t),t.preventDefault())}),St(window,"keydown",function(t){if(l.focusing){var e=t.keyCode||t.which,n=t.key,r=t.ctrlKey,i=t.shiftKey,o=t.metaKey;if(r||o)switch(e){case 90:l.undo(),t.preventDefault();break;case 89:l.redo(),t.preventDefault();break;case 67:ss.call(l),t.preventDefault();break;case 88:cs.call(l),t.preventDefault();break;case 85:g.trigger("underline"),t.preventDefault();break;case 86:break;case 37:rs.call(l,i,"row-first"),t.preventDefault();break;case 38:rs.call(l,i,"col-first"),t.preventDefault();break;case 39:rs.call(l,i,"row-last"),t.preventDefault();break;case 40:rs.call(l,i,"col-last"),t.preventDefault();break;case 32:ns.call(l,!1,-1,l.data.selector.ci,!1),t.preventDefault();break;case 66:g.trigger("bold");break;case 73:g.trigger("italic")}else{switch(e){case 32:i&&ns.call(l,!1,l.data.selector.ri,-1,!1);break;case 27:v.hide(),y.hide(),ls.call(l);break;case 37:rs.call(l,i,"left"),t.preventDefault();break;case 38:rs.call(l,i,"up"),t.preventDefault();break;case 39:rs.call(l,i,"right"),t.preventDefault();break;case 40:rs.call(l,i,"down"),t.preventDefault();break;case 9:p.clear(),rs.call(l,!1,i?"left":"right"),t.preventDefault();break;case 13:p.clear(),rs.call(l,!1,i?"up":"down"),t.preventDefault();break;case 8:bs.call(l,"delete-cell-text"),t.preventDefault()}"Delete"===n?(bs.call(l,"delete-cell-text"),t.preventDefault()):e>=65&&e<=90||e>=48&&e<=57||e>=96&&e<=105||"="===t.key?(ys.call(l,t.key,"input"),ps.call(l),vs.call(l)):113===e&&ps.call(l)}}})}var Os=function(){function t(e,n){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventMap=new Map;var i=n.settings,o=i.view,l=i.showToolbar,s=i.showContextmenu,c=i.mode,u=i.showPartToolbar;this.el=a("div","".concat(at,"-sheet")),this.toolbar=new rl(n,o.width,!l,u),this.formulaBar=new Bl(n,c),this.print=new kn(n),e.children(this.toolbar.el,this.formulaBar.el,this.el,this.print.el),this.data=n,this.tableEl=a("canvas","".concat(at,"-table"));var f=n.settings.row.height;this.rowResizer=new Pt(!1,f),this.colResizer=new Pt(!0,n.cols.minWidth),this.verticalScrollbar=new Rt(!0),this.horizontalScrollbar=new Rt(!1),this.editor=new he(Ue,function(){return r.getTableOffset()},f,this),this.modalValidation=new wl,this.modalSort=new _l,this.modalSearch=new Vl,this.contextMenu=new Cn(function(){return r.getRect()},!s),this.commentTip=new Il,this.commentEditable=new Kl,this.selector=new Zt(n),this.overlayerCEl=a("div","".concat(at,"-overlayer-content")).children(this.editor.el,this.selector.el),this.overlayerEl=a("div","".concat(at,"-overlayer")).child(this.overlayerCEl),this.sortFilter=new Rl,this.el.children(this.tableEl,this.overlayerEl.el,this.rowResizer.el,this.colResizer.el,this.verticalScrollbar.el,this.horizontalScrollbar.el,this.contextMenu.el,this.commentTip.el,this.commentEditable.el,this.modalValidation.el,this.modalSort.el,this.modalSearch.el,this.sortFilter.el),this.table=new pn(this.tableEl.el,n),ks.call(this),as.call(this),ns.call(this,!1,0,0)}var e,n,r;return e=t,(n=[{key:"on",value:function(t,e){return this.eventMap.set(t,e),this}},{key:"trigger",value:function(t){var e=this.eventMap;if(e.has(t)){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=e.get(t)).call.apply(n,[this].concat(i))}}},{key:"resetData",value:function(t){this.editor.clear();var e=this.data.displayRight2Left!==t.displayRight2Left;if(this.data=t,is.call(this),os.call(this),e){var n=this.getTableOffset();this.overlayerCEl.offset(n)}this.toolbar.resetData(t),this.formulaBar.resetData(t),this.print.resetData(t),this.selector.resetData(t),this.table.resetData(t),this.data.reloadImagesShapes()}},{key:"loadData",value:function(t){return this.data.setData(t),as.call(this),this}},{key:"freeze",value:function(t,e){return this.data.setFreeze(t,e),as.call(this),this}},{key:"undo",value:function(){this.data.undo(),as.call(this)}},{key:"redo",value:function(){this.data.redo(),as.call(this)}},{key:"reload",value:function(){return as.call(this),this}},{key:"getRect",value:function(){var t=this.data;return{width:t.viewWidth(),height:t.viewHeight()}}},{key:"getTableOffset",value:function(){var t=this.data,e=t.rows,n=t.cols,r=t.displayRight2Left,i=this.data.settings.row.height,o=this.getRect(),a=o.width,l=o.height;return{width:a-n.indexWidth,height:l-e.height,left:r?0:n.indexWidth,top:i}}}])&&Ql(e.prototype,n),r&&Ql(e,r),t}();function Ss(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function xs(t){return(xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Es(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Cs(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function js(t,e,n){return e&&_s(t.prototype,e),n&&_s(t,n),t}function Ts(t,e){return!e||"object"!==xs(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ps(t){return(Ps=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function As(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Rs(t,e)}function Rs(t,e){return(Rs=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ds=function(t){function e(t){var n;Cs(this,e);var r=new ht("ellipsis");return(n=Ts(this,Ps(e).call(this,r,"auto",!1,"top-left"))).contentClick=t,n}return As(e,Ln),js(e,[{key:"reset",value:function(t){var e=this,n=t.map(function(t,n){return a("div","".concat(at,"-item")).css("width","150px").css("font-weight","normal").on("click",function(){e.contentClick(n),e.hide()}).child(t)});this.setContentChildren.apply(this,Es(n))}},{key:"setTitle",value:function(){}}]),e}(),Is=function(t){function e(t){var n;Cs(this,e);var r=new ht("pagination");return(n=Ts(this,Ps(e).call(this,r,"100px",!1,"top-left"))).contentEl.css("max-height","298px"),n.contentEl.css("overflow-y","auto"),n.contentClick=t,n}return As(e,Ln),js(e,[{key:"reset",value:function(t){var e=this,n=t.map(function(t,n){return a("div","".concat(at,"-item")).css("width","auto").css("font-weight","normal").on("click",function(){e.contentClick(n),e.hide()}).child(t)});this.setContentChildren.apply(this,Es(n))}}]),e}(),zs=[{key:"delete",title:U("contextmenu.deleteSheet")}];function Ns(){var t=this;return zs.map(function(e){return function(t){var e=this;return a("div","".concat(at,"-item")).child(t.title()).on("click",function(){e.itemClick(t.key),e.hide()})}.call(t,e)})}var Ws=function(){function t(){var e;Cs(this,t),this.el=(e=a("div","".concat(at,"-contextmenu")).css("width","160px")).children.apply(e,Es(Ns.call(this))).hide(),this.itemClick=function(){}}return js(t,[{key:"hide",value:function(){var t=this.el;t.hide(),Et(t)}},{key:"setOffset",value:function(t){var e=this.el;e.offset(t),e.show(),Ct(e)}}]),t}(),Fs=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},s=arguments.length>5?arguments[5]:void 0;Cs(this,t),this.settings=s,this.addFunc=n,this.swapFunc=r,this.updateFunc=o,this.scrollFunc=l,this.dataNames=[],this.activeEl=null,this.deleteEl=null,this.items=[],this.moreEl=new Ds(function(t){e.clickSwap2(e.items[t])}),this.paginationEl=new Is(function(t){e.scrollFunc(t)}),this.contextMenu=new Ws,this.contextMenu.itemClick=i,this.el=a("div","".concat(at,"-bottombar")).children(this.contextMenu.el,this.menuEl=this.setMenuEl())}return js(t,[{key:"setMenuEl",value:function(){var t=this;return"edit"===this.settings.mode?a("ul","".concat(at,"-menu")).child(a("li","").children(new ht("add").on("click",function(){t.dataNames.length<10?t.addFunc():dt("Warning","It is less than or equal to 10")}),a("span","").child(this.moreEl))):a("ul","".concat(at,"-menu")).child(a("li","").children(a("span","").child(this.moreEl)))}},{key:"addItem",value:function(t,e,n,r){this.dataNames.push(t);var i=a("li",e?"active":"").child(t);void 0!==n&&(i.el.style.color=r,i.el.style.backgroundColor=n),this.setItemEvent(i),e&&this.clickSwap(i),this.items.push(i),this.menuEl.child(i),this.moreEl.reset(this.dataNames)}},{key:"addPagination",value:function(t){for(var e=[],n=1;n<=t;n++){var r=n+"";e.push(r)}this.paginationEl.reset(e)}},{key:"setItemEvent",value:function(t){var e=this;"edit"===this.settings.mode?t.on("click",function(){e.clickSwap2(t)}).on("contextmenu",function(n){var r=n.target,i=r.offsetLeft,o=r.offsetHeight;e.contextMenu.setOffset({left:i,bottom:o+1}),e.deleteEl=t}).on("dblclick",function(){if(!(t.el.children.length>0)){var n=t.html(),r=new sl("auto","",31);r.val(n),r.input.on("blur",function(t){var i=t.target.value,o=e.dataNames.findIndex(function(t){return t===n});e.renameItem(o,i,r)}),t.html("").child(r.el),r.focus()}}):t.on("click",function(){e.clickSwap2(t)})}},{key:"renameItem",value:function(t,e,n){this.dataNames[t]!==e&&0!==e.length?e.length>31?dt("Error","The max length of the sheet name is 31",function(){n.focus()}):this.dataNames.indexOf(e)>=0?dt("Error","Same worksheet name already exist",function(){n.focus()}):(this.dataNames.splice(t,1,e),this.moreEl.reset(this.dataNames),this.items[t].html("").child(e),this.updateFunc(t,e)):n.focus()}},{key:"clear",value:function(){var t=this;this.items.forEach(function(e){t.menuEl.removeChild(e.el)}),this.items=[],this.dataNames=[],this.moreEl.reset(this.dataNames)}},{key:"hide",value:function(){var t=this.el;t.hide(),Et(t)}},{key:"deleteItem",value:function(){var t=this.activeEl,e=this.deleteEl;if(this.items.length>1){var n=this.items.findIndex(function(t){return t===e});if(this.items.splice(n,1),this.dataNames.splice(n,1),this.menuEl.removeChild(e.el),this.moreEl.reset(this.dataNames),t===e){var r=Ss(this.items,1)[0];return this.activeEl=r,this.activeEl.toggle(),[n,0]}return[n,-1]}return[-1]}},{key:"clickSwap2",value:function(t){var e=this.items.findIndex(function(e){return e===t});this.clickSwap(t),this.activeEl.toggle(),this.swapFunc(e)}},{key:"clickSwap",value:function(t){null!==this.activeEl&&this.activeEl.toggle(),this.activeEl=t}},{key:"setDirection",value:function(t){t?this.el.attr("dir","rtl"):this.el.removeAttr("dir")}}]),t}();n(1);function Ms(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=t[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Hs(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ls(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vs(t){var e=[],n=0;this.run=function(t){var r=this;this.startHandler(t,function(){n--,t.timestm,t.isfinish,e.length>0&&r.run(e.shift())})},this.startHandler=function(r,i){var o=this;r.isfinish?e.length>0&&this.run(e.shift()):0!=n?setTimeout(function(){return o.startHandler(r,i)},300):(n++,r.timestm,r.isfinish,t(r,i))},this.append=function(t){e.push(t),e.length,t.timestm,1===e.length&&this.run(t)},this.isFinish=function(){return 0===e.length&&0===n}}n.d(e,"spreadsheet",function(){return $s});var qs=function t(e,n,r,i){Ls(this,t),this.item=e,this.url=n,this.callback=r,this.callbackerror=i,this.isfinish=!1,this.timestm="["+(new Date).getTime()+"] "};function Bs(t,e){var n=$.ajax({url:t.url,type:"post",dataType:"json",data:t.item});t.timestm,t.isfinish,n.done(function(n){t.timestm,t.callback&&(t.callback(n),t.isfinish=!0),e()}),n.fail(function(n,r,i){t.timestm,t.callbackerror&&(t.callbackerror(n,r,i),t.isfinish=!0),e()})}var Us=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Ls(this,t);var i=e;this.options=r,this.sheetIndex=0,this.datas=[],this.uniqueid="",this.imageDiv=null,this.imageUrl=null,this.basicZorder=0,this.buffer=new Vs(Bs),"string"==typeof e&&(i=document.querySelector(e)),this.bottombar=new Fs(function(){if(n.uniqueid.endsWith(".csv"))dt("Warning","CSV file does not support more than one worksheet");else if(n.uniqueid.endsWith(".tsv"))dt("Warning","TSV file does not support more than one worksheet");else{var t=n.addSheet();t.showGrid=!0,n.sheet.resetData(t)}},function(t){var e=n.datas[t];e.scroll={ci:0,ri:0,riact:0,x:0,y:0,yact:0},n.sheet.resetData(e),n.bottombar.setDirection(e.displayRight2Left),n.resetPagination(e),n.sheet.verticalScrollbar.move({top:0})},function(){n.deleteSheet()},function(t,e){n.renameSheet(t,e)},function(t){var e=t*n.data.settings.row.len,r=n.data.rows.sumHeight(0,e);n.sheet.verticalScrollbar.move({top:r-1})},this.options),this.isloading=!0,this.data=this.addSheet(),this.isloading=!1,this.resetPagination(this.data);var o=a("div","".concat(at)).on("contextmenu",function(t){return t.preventDefault()});i.appendChild(o.el),this.sheet=new Os(o,this.data),o.child(this.bottombar.el)}var e,n,r;return e=t,r=[{key:"locale",value:function(t,e){X(t,e)}}],(n=[{key:"setImageInfo",value:function(t,e,n){return this.imageDiv=t,this.imageUrl=e,this.basicZorder=n,this}},{key:"setDisplayRight2Left",value:function(t){var e=this.sheet,n=this.bottombar,r=e.data;if(r.displayRight2Left!==t){r.displayRight2Left=t;var i=e.getTableOffset();e.overlayerCEl.offset(i),e.resetData(r),n.setDirection(t)}}},{key:"getUpdateDatas",value:function(){for(var t=[],e=0,n=this.datas.length;e<n;e++){var r=this.datas[e].getDataForSave();null!=r&&t.push(r)}return t}},{key:"addSheet",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=t||"sheet".concat(this.sheetIndex),a=new Ot(o,this.options);return a.change=function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.sheet).trigger.apply(t,["change"].concat(r))},a.updateCellsData=function(t){var n=e.sheet.data,r=n.updateCellError,i=n.updateMyCells,o=e.uniqueid,a=e.imageUrl;t.Error?(t.cell&&(i.call(e.sheet.data,[t.cell]),e.reRender()),t.cells&&(i.call(e.sheet.data,t.cells),e.reRender()),r(t.Error)):"update"===t.op&&(t.data.forEach(function(t,n,r){for(var i=0,l=new Array;i<e.datas.length;i++)if(e.datas[i].name===t.name){e.datas[i].updateMyCells(t.cells),e.datas[i].updateShapes(t.shapes,l);break}e.sheet.data.updateShapeSrcToRefresh(o,a,t.pickey,l)}),e.reRender())},a.updateServerError=function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.sheet).trigger.apply(t,["updateServerError"].concat(r))},a.updateCellError=function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.sheet).trigger.apply(t,["updateCellError"].concat(r))},a.updateCellServer=function(t){var n=e.sheet.data,r=n.settings,i=n.updateServerError,o=n.updateCellsData,a=e.uniqueid,l=(e.showMask,e.closeMask,e.buffer);if("server"===r.updateMode){var s={p:JSON.stringify(t),uid:a,folderName:r.folderName,fileName:r.fileName};l.append(new qs(s,r.updateUrl,function(t){o(t)},function(t,e,n){i(t,e,n)}))}},a.loadImages=function(){var t=e.sheet.data,n=t.images,r=t.displayRight2Left,i=t.cols,o=r?e.sheet.data.viewWidth()-i.indexWidth:0,a=(e.uniqueid,e.imageDiv),l=(e.imageUrl,e.basicZorder);null!=n&&n.forEach(function(t){var e=r?o-t.left-t.width:t.left;null==t.src?a.append('<img onload="this.removeAttribute(\'class\')" id="p_'+t.id+"_"+t.tick+'" class="resize-image"  alt="" style="position: absolute;top:'+t.top+"px;left:"+e+"px; z-index:"+(l+t.zorder)+";width: "+t.width+"px;height:"+t.height+'px">'):a.append('<img onload="this.removeAttribute(\'class\')" id="p_'+t.id+"_"+t.tick+'" src="'+t.src+'" class="resize-image"  alt="" style="position: absolute;top:'+t.top+"px;left:"+e+"px; z-index:"+(l+t.zorder)+";width: "+t.width+"px;height:"+t.height+'px">')})},a.loadShapes=function(){var t=e.sheet.data,n=t.shapes,r=t.displayRight2Left,i=t.cols,o=r?e.sheet.data.viewWidth()-i.indexWidth:0,a=(e.uniqueid,e.imageDiv),l=(e.imageUrl,e.basicZorder);null!=n&&n.forEach(function(t){var e=r?o-t.left-t.width:t.left;null==t.src?a.append('<img onload="this.removeAttribute(\'class\')" id="s_'+t.id+"_"+t.tick+'" class="resize-image"  alt="" style="position: absolute;top:'+t.top+"px;left:"+e+"px; z-index:"+(l+t.zorder)+";width: "+t.width+"px;height:"+t.height+'px">'):a.append('<img onload="this.removeAttribute(\'class\')" id="s_'+t.id+"_"+t.tick+'" src="'+t.src+'" class="resize-image"  alt="" style="position: absolute;top:'+t.top+"px;left:"+e+"px; z-index:"+(l+t.zorder)+";width: "+t.width+"px;height:"+t.height+'px">')})},a.fillImageSrc=function(){var t=e.sheet.data,n=t.images,r=t.shapes,i=t.sheetid,o=t.isImageOk,a=e.uniqueid,l=(e.imageDiv,e.imageUrl);e.basicZorder;if(void 0===o&&void 0!==i&&(null!=r&&r.length>0||null!=n&&n.length>0)){var s=e;$.get(l+"?uid="+a+"&id="+i+"_batch.zip",function(t){var e=new Array;null!=n&&n.forEach(function(t){if(null==t.src){var n={};n.id="p_"+t.id+"_"+t.tick,n.name=t.id+"."+t.tick,n.it=t,e.push(n)}}),null!=r&&r.forEach(function(t){if(null==t.src){var n={};n.id="s_"+t.id+"_"+t.tick,n.name=t.id+"."+t.tick,n.it=t,e.push(n)}}),s.sheet.data.fillImageOnebyOne(t,e),s.sheet.data.isImageOk=!0})}},a.fillImageOnebyOne=function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState){var t=n.response,r=new Uint8Array(t);JSZip.loadAsync(r).then(function(t){e.forEach(function(e,n,r){t.file(e.name).async("blob").then(function(t){var n=URL.createObjectURL(t);$("#"+e.id).attr("src",n),e.it.src=n})})})}},n.open("GET",t,!0),n.responseType="arraybuffer",n.send()},a.loadConditionImage=function(){var t=e.sheet.data.conditionimg,n=e.imageDiv,r=e.basicZorder;t&&t.forEach(function(t){if(t.data){var e=a.createConditionImage(t,r);t.data=void 0,t.image=e,n.append(e)}else n.append(t.image)})},a.reloadImagesShapes=function(){var t=e.imageDiv;null!=t&&(t.empty(),a.loadImages(),a.loadShapes(),a.loadConditionImage(),a.fillImageSrc())},a.scrollImagesShapes=function(){var t=e.imageDiv,n=e.sheet.data,r=n.scroll,i=n.displayRight2Left;null!=t&&(t.css("left",i?r.x:-r.x),t.css("top",-r.y))},this.datas.push(a),this.bottombar.addItem(o,n,r,i),this.sheetIndex+=1,this.isloading||this.sheet.data.addSheetOpr(o),a}},{key:"resetPagination",value:function(t){var e=t.rows.len,n=t.settings.row.len,r=e%n==0?e/n:Math.ceil(e/n);this.bottombar.addPagination(r)}},{key:"deleteSheet",value:function(){var t=Ms(this.bottombar.deleteItem(),2),e=t[0],n=t[1];if(e>=0){var r=this.datas[e].name;this.sheet.data.delSheetOpr(r),this.datas.splice(e,1),n>=0&&this.sheet.resetData(this.datas[n])}}},{key:"renameSheet",value:function(t,e){var n=this.datas[t].name;this.datas[t].name=e,this.sheet.data.renameSheetOpr(n,e)}},{key:"loadData",value:function(t){this.isloading=!0;var e=Array.isArray(t)?t:[t];if(this.bottombar.clear(),this.datas=[],e.length>0)for(var n=0;n<e.length;n+=1){var r=e[n],i=this.addSheet(r.name,0===n,r.tabcolor,r.fontcolor);if(void 0!==r.merges)for(var o=0,a=r.merges.length;o<a;o++){var l=r.merges[o].split(":"),s=Ms(f(l[0]),2),c=s[0],u=s[1],h=Ms(f(l[1]),2),d=h[0],p=h[1];r.rows[u]&&r.rows[u].cells[c]&&(r.rows[u].cells[c].merge=[p-u,d-c])}i.setData(r)}return this.isloading=!1,this}},{key:"getData",value:function(){return this.datas.map(function(t){return t.getData()})}},{key:"cellText",value:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.datas[r].setCellText(t,e,n,"finished"),this}},{key:"setActiveCell",value:function(t,e){return this.sheet.selector.set(t,e),this}},{key:"setActiveSheet",value:function(t){return this.bottombar.clickSwap2(this.bottombar.items[t]),this}},{key:"setActiveSheetByName",value:function(t){for(var e=0;e<this.bottombar.dataNames.length;e++)if(this.bottombar.dataNames[e]===t){this.bottombar.clickSwap2(this.bottombar.items[e]);break}return this}},{key:"cell",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCell(t,e)}},{key:"cellStyle",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.datas[n].getCellStyle(t,e)}},{key:"reRender",value:function(){return this.sheet.table.render(),this}},{key:"on",value:function(t,e){return this.sheet.on(t,e),this}},{key:"validate",value:function(){return this.data.validations.errors.size<=0}},{key:"change",value:function(t){return this.sheet.on("change",t),this}},{key:"updateServerError",value:function(t){return this.sheet.on("updateServerError",t),this}},{key:"updateCellError",value:function(t){return this.sheet.on("updateCellError",t),this}},{key:"showMask",value:function(){var t=document.createElement("div");t.id="aspose_mask_bg",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.width="100%",t.style.height="100%",t.style.backgroundColor="#777",t.style.opacity=.6,t.style.zIndex=10001,document.body.appendChild(t);var e=document.createElement("div");e.style.position="absolute",e.style.top="33%",e.style.left="40%",e.style.backgroundColor="white",e.style.border="#336699 1px solid",e.style.textAlign="center",e.style.fontSize="medium",e.style.padding="1.5em 4em 1.5em 4em",e.innerText="updating , please wait...",t.appendChild(e)}},{key:"closeMask",value:function(){var t=document.getElementById("aspose_mask_bg");null!=t&&t.parentNode.removeChild(t)}}])&&Hs(e.prototype,n),r&&Hs(e,r),t}(),$s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Us(t,e)};window&&(window.x_spreadsheet=$s,window.x_spreadsheet.locale=function(t,e){return X(t,e)});e.default=Us}]);